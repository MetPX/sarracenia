<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>FlowCallback Reference &mdash; Sarracenia 3.00.54rc2 documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=19f00094" />

  
    <link rel="shortcut icon" href="../_static/sarra_horror_culture_favicon.png"/>
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../_static/jquery.js?v=5d32c60e"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="../_static/documentation_options.js?v=ae03d225"></script>
        <script src="../_static/doctools.js?v=9a2dae69"></script>
        <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Code Reference" href="code.html" />
    <link rel="prev" title="SR_post" href="sr_post.7.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            Sarracenia
              <img src="../_static/sarra_horror_culture_w200.png" class="logo" alt="Logo"/>
          </a>
              <div class="version">
                3.00.54rc2
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../Explanation/Overview.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Tutorials/index.html">Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../How2Guides/index.html">HOWTOS</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Explanation/index.html">Explanation</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Reference</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="sr3_options.7.html">SR3 OPTIONS</a></li>
<li class="toctree-l2"><a class="reference internal" href="sr3_credentials.7.html">SR3 CREDENTIALS</a></li>
<li class="toctree-l2"><a class="reference internal" href="sr3.1.html">SR3</a></li>
<li class="toctree-l2"><a class="reference internal" href="sr3_post.1.html">sr3_post CLI poster</a></li>
<li class="toctree-l2"><a class="reference internal" href="sr3_cpump.1.html">Sr3_cpump C Manual Page</a></li>
<li class="toctree-l2"><a class="reference internal" href="sr_post.7.html">Posting Message Format Man page</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">FlowCallback Reference</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#module-sarracenia.flowcb">sarracenia.flowcb</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#sarracenia.flowcb.FlowCB"><code class="docutils literal notranslate"><span class="pre">FlowCB</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#sarracenia.flowcb.load_library"><code class="docutils literal notranslate"><span class="pre">load_library()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-sarracenia.flowcb.accept">sarracenia.flowcb.accept</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-sarracenia.flowcb.accept.delete">sarracenia.flowcb.accept.delete</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#sarracenia.flowcb.accept.delete.Delete"><code class="docutils literal notranslate"><span class="pre">Delete</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-sarracenia.flowcb.download">sarracenia.flowcb.download</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-sarracenia.flowcb.accept.downloadbaseurl">sarracenia.flowcb.accept.downloadbaseurl</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#sarracenia.flowcb.accept.downloadbaseurl.DownloadBaseUrl"><code class="docutils literal notranslate"><span class="pre">DownloadBaseUrl</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-sarracenia.flowcb.accept.hourtree">sarracenia.flowcb.accept.hourtree</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#sarracenia.flowcb.accept.hourtree.HourTree"><code class="docutils literal notranslate"><span class="pre">HourTree</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-sarracenia.flowcb.accept.httptohttps">sarracenia.flowcb.accept.httptohttps</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#sarracenia.flowcb.accept.httptohttps.HttpToHttps"><code class="docutils literal notranslate"><span class="pre">HttpToHttps</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-sarracenia.flowcb.accept.longflow">sarracenia.flowcb.accept.longflow</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#sarracenia.flowcb.accept.longflow.LongFlow"><code class="docutils literal notranslate"><span class="pre">LongFlow</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-sarracenia.flowcb.accept.posthourtree">sarracenia.flowcb.accept.posthourtree</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#sarracenia.flowcb.accept.posthourtree.Posthourtree"><code class="docutils literal notranslate"><span class="pre">Posthourtree</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-sarracenia.flowcb.accept.postoverride">sarracenia.flowcb.accept.postoverride</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#sarracenia.flowcb.accept.postoverride.PostOverride"><code class="docutils literal notranslate"><span class="pre">PostOverride</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-sarracenia.flowcb.accept.printlag">sarracenia.flowcb.accept.printlag</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#sarracenia.flowcb.accept.printlag.PrintLag"><code class="docutils literal notranslate"><span class="pre">PrintLag</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-sarracenia.flowcb.accept.rename4jicc">sarracenia.flowcb.accept.rename4jicc</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#sarracenia.flowcb.accept.rename4jicc.Rename4Jicc"><code class="docutils literal notranslate"><span class="pre">Rename4Jicc</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-sarracenia.flowcb.accept.renamedmf">sarracenia.flowcb.accept.renamedmf</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#sarracenia.flowcb.accept.renamedmf.RenameDMF"><code class="docutils literal notranslate"><span class="pre">RenameDMF</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-sarracenia.flowcb.accept.renamewhatfn">sarracenia.flowcb.accept.renamewhatfn</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#sarracenia.flowcb.accept.renamewhatfn.RenameWhatFn"><code class="docutils literal notranslate"><span class="pre">RenameWhatFn</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-sarracenia.flowcb.accept.save">sarracenia.flowcb.accept.save</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#sarracenia.flowcb.accept.save.Save"><code class="docutils literal notranslate"><span class="pre">Save</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-sarracenia.flowcb.accept.speedo">sarracenia.flowcb.accept.speedo</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#sarracenia.flowcb.accept.speedo.Speedo"><code class="docutils literal notranslate"><span class="pre">Speedo</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-sarracenia.flowcb.accept.sundewpxroute">sarracenia.flowcb.accept.sundewpxroute</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#sarracenia.flowcb.accept.sundewpxroute.SundewPxRoute"><code class="docutils literal notranslate"><span class="pre">SundewPxRoute</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-sarracenia.flowcb.accept.testretry">sarracenia.flowcb.accept.testretry</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#sarracenia.flowcb.accept.testretry.TestRetry"><code class="docutils literal notranslate"><span class="pre">TestRetry</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-sarracenia.flowcb.accept.toclusters">sarracenia.flowcb.accept.toclusters</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#sarracenia.flowcb.accept.toclusters.ToClusters"><code class="docutils literal notranslate"><span class="pre">ToClusters</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#sarracenia-flowcb-accept-tohttp">sarracenia.flowcb.accept.tohttp</a></li>
<li class="toctree-l3"><a class="reference internal" href="#sarracenia-flowcb-accept-tolocal">sarracenia.flowcb.accept.tolocal</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-sarracenia.flowcb.accept.tolocalfile">sarracenia.flowcb.accept.tolocalfile</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#sarracenia.flowcb.accept.tolocalfile.ToLocalFile"><code class="docutils literal notranslate"><span class="pre">ToLocalFile</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-sarracenia.flowcb.accept.wmotypesuffix">sarracenia.flowcb.accept.wmotypesuffix</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#sarracenia.flowcb.accept.wmotypesuffix.WmoTypeSuffix"><code class="docutils literal notranslate"><span class="pre">WmoTypeSuffix</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-sarracenia.flowcb.clamav">sarracenia.flowcb.clamav</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#sarracenia.flowcb.clamav.Clamav"><code class="docutils literal notranslate"><span class="pre">Clamav</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-sarracenia.flowcb.destfn.sample">sarracenia.flowcb.destfn.sample</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#sarracenia.flowcb.destfn.sample.Sample"><code class="docutils literal notranslate"><span class="pre">Sample</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-sarracenia.flowcb.filter">sarracenia.flowcb.filter</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-sarracenia.flowcb.filter.deleteflowfiles">sarracenia.flowcb.filter.deleteflowfiles</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#sarracenia.flowcb.filter.deleteflowfiles.DeleteFlowFiles"><code class="docutils literal notranslate"><span class="pre">DeleteFlowFiles</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-sarracenia.flowcb.filter.fdelay">sarracenia.flowcb.filter.fdelay</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#sarracenia.flowcb.filter.fdelay.Fdelay"><code class="docutils literal notranslate"><span class="pre">Fdelay</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-sarracenia.flowcb.filter.pclean_f90">sarracenia.flowcb.filter.pclean_f90</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#sarracenia.flowcb.filter.pclean_f90.PClean_F90"><code class="docutils literal notranslate"><span class="pre">PClean_F90</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-sarracenia.flowcb.filter.pclean_f92">sarracenia.flowcb.filter.pclean_f92</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#sarracenia.flowcb.filter.pclean_f92.PClean_F92"><code class="docutils literal notranslate"><span class="pre">PClean_F92</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-sarracenia.flowcb.filter.wmo2msc">sarracenia.flowcb.filter.wmo2msc</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#sarracenia.flowcb.filter.wmo2msc.Wmo2msc"><code class="docutils literal notranslate"><span class="pre">Wmo2msc</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-sarracenia.flowcb.gather">sarracenia.flowcb.gather</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#sarracenia.flowcb.gather.logger"><code class="docutils literal notranslate"><span class="pre">logger</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-sarracenia.flowcb.gather.file">sarracenia.flowcb.gather.file</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#sarracenia.flowcb.gather.file.File"><code class="docutils literal notranslate"><span class="pre">File</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#sarracenia.flowcb.gather.file.SimpleEventHandler"><code class="docutils literal notranslate"><span class="pre">SimpleEventHandler</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-sarracenia.flowcb.gather.message">sarracenia.flowcb.gather.message</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#sarracenia.flowcb.gather.message.Message"><code class="docutils literal notranslate"><span class="pre">Message</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-sarracenia.flowcb.housekeeping">sarracenia.flowcb.housekeeping</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-sarracenia.flowcb.housekeeping.resources">sarracenia.flowcb.housekeeping.resources</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#sarracenia.flowcb.housekeeping.resources.Resources"><code class="docutils literal notranslate"><span class="pre">Resources</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-sarracenia.flowcb.log">sarracenia.flowcb.log</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#sarracenia.flowcb.log.Log"><code class="docutils literal notranslate"><span class="pre">Log</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-sarracenia.flowcb.mdelaylatest">sarracenia.flowcb.mdelaylatest</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#sarracenia.flowcb.mdelaylatest.MDelayLatest"><code class="docutils literal notranslate"><span class="pre">MDelayLatest</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-sarracenia.flowcb.nodupe">sarracenia.flowcb.nodupe</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#sarracenia.flowcb.nodupe.NoDupe"><code class="docutils literal notranslate"><span class="pre">NoDupe</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-sarracenia.flowcb.nodupe.data">sarracenia.flowcb.nodupe.data</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#sarracenia.flowcb.nodupe.data.Data"><code class="docutils literal notranslate"><span class="pre">Data</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-sarracenia.flowcb.nodupe.name">sarracenia.flowcb.nodupe.name</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#sarracenia.flowcb.nodupe.name.Name"><code class="docutils literal notranslate"><span class="pre">Name</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-sarracenia.flowcb.retry">sarracenia.flowcb.retry</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#sarracenia.flowcb.retry.Retry"><code class="docutils literal notranslate"><span class="pre">Retry</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-sarracenia.flowcb.pclean">sarracenia.flowcb.pclean</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#sarracenia.flowcb.pclean.PClean"><code class="docutils literal notranslate"><span class="pre">PClean</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-sarracenia.flowcb.sample">sarracenia.flowcb.sample</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#sarracenia.flowcb.sample.Sample"><code class="docutils literal notranslate"><span class="pre">Sample</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-sarracenia.flowcb.scheduled">sarracenia.flowcb.scheduled</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#sarracenia.flowcb.scheduled.Scheduled"><code class="docutils literal notranslate"><span class="pre">Scheduled</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#sarracenia-flowcb-script">sarracenia.flowcb.script</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-sarracenia.flowcb.shiftdir2baseurl">sarracenia.flowcb.shiftdir2baseurl</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#sarracenia.flowcb.shiftdir2baseurl.ShiftDir2baseUrl"><code class="docutils literal notranslate"><span class="pre">ShiftDir2baseUrl</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-sarracenia.flowcb.poll">sarracenia.flowcb.poll</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#sarracenia.flowcb.poll.Poll"><code class="docutils literal notranslate"><span class="pre">Poll</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-sarracenia.flowcb.poll.airnow">sarracenia.flowcb.poll.airnow</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#sarracenia.flowcb.poll.airnow.Airnow"><code class="docutils literal notranslate"><span class="pre">Airnow</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-sarracenia.flowcb.poll.mail">sarracenia.flowcb.poll.mail</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#sarracenia.flowcb.poll.mail.Mail"><code class="docutils literal notranslate"><span class="pre">Mail</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-sarracenia.flowcb.poll.nasa_mls_nrt">sarracenia.flowcb.poll.nasa_mls_nrt</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#sarracenia.flowcb.poll.nasa_mls_nrt.Nasa_mls_nrt"><code class="docutils literal notranslate"><span class="pre">Nasa_mls_nrt</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#sarracenia-flowcb-poll-nexrad">sarracenia.flowcb.poll.nexrad</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-sarracenia.flowcb.poll.noaa_hydrometric">sarracenia.flowcb.poll.noaa_hydrometric</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#sarracenia.flowcb.poll.noaa_hydrometric.Noaa_hydrometric"><code class="docutils literal notranslate"><span class="pre">Noaa_hydrometric</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#sarracenia-flowcb-poll-usgs">sarracenia.flowcb.poll.usgs</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-sarracenia.flowcb.post">sarracenia.flowcb.post</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-sarracenia.flowcb.send.email">sarracenia.flowcb.send.email</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#sarracenia.flowcb.send.email.Email"><code class="docutils literal notranslate"><span class="pre">Email</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-sarracenia.flowcb.post.message">sarracenia.flowcb.post.message</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#sarracenia.flowcb.post.message.Message"><code class="docutils literal notranslate"><span class="pre">Message</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-sarracenia.flowcb.send">sarracenia.flowcb.send</a></li>
<li class="toctree-l3"><a class="reference internal" href="#sarracenia-flowcb-wistree">sarracenia.flowcb.wistree</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-sarracenia.flowcb.work">sarracenia.flowcb.work</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-sarracenia.flowcb.work.age">sarracenia.flowcb.work.age</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#sarracenia.flowcb.work.age.Age"><code class="docutils literal notranslate"><span class="pre">Age</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-sarracenia.flowcb.work.rxpipe">sarracenia.flowcb.work.rxpipe</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#sarracenia.flowcb.work.rxpipe.Rxpipe"><code class="docutils literal notranslate"><span class="pre">Rxpipe</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-sarracenia.flowcb.v2wrapper">sarracenia.flowcb.v2wrapper</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#sarracenia.flowcb.v2wrapper.V2Wrapper"><code class="docutils literal notranslate"><span class="pre">V2Wrapper</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#sarracenia.flowcb.v2wrapper.sumstrFromMessage"><code class="docutils literal notranslate"><span class="pre">sumstrFromMessage()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="code.html">Code Reference</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../Contribution/index.html">Contributing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api-documentation.html">API Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fr/index.html">En français</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Sarracenia</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="index.html">Reference</a></li>
      <li class="breadcrumb-item active">FlowCallback Reference</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/Reference/flowcb.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="flowcallback-reference">
<span id="flowcb-reference"></span><h1><a class="toc-backref" href="#id1" role="doc-backlink">FlowCallback Reference</a><a class="headerlink" href="#flowcallback-reference" title="Link to this heading"></a></h1>
<p>Documentation of the Flow callback plugins included
with sr3.</p>
<nav class="contents" id="contents">
<p class="topic-title">Contents</p>
<ul class="simple">
<li><p><a class="reference internal" href="#flowcallback-reference" id="id1">FlowCallback Reference</a></p>
<ul>
<li><p><a class="reference internal" href="#module-sarracenia.flowcb" id="id2">sarracenia.flowcb</a></p></li>
<li><p><a class="reference internal" href="#module-sarracenia.flowcb.accept" id="id3">sarracenia.flowcb.accept</a></p></li>
<li><p><a class="reference internal" href="#module-sarracenia.flowcb.accept.delete" id="id4">sarracenia.flowcb.accept.delete</a></p></li>
<li><p><a class="reference internal" href="#module-sarracenia.flowcb.download" id="id5">sarracenia.flowcb.download</a></p></li>
<li><p><a class="reference internal" href="#module-sarracenia.flowcb.accept.downloadbaseurl" id="id6">sarracenia.flowcb.accept.downloadbaseurl</a></p></li>
<li><p><a class="reference internal" href="#module-sarracenia.flowcb.accept.hourtree" id="id7">sarracenia.flowcb.accept.hourtree</a></p></li>
<li><p><a class="reference internal" href="#module-sarracenia.flowcb.accept.httptohttps" id="id8">sarracenia.flowcb.accept.httptohttps</a></p></li>
<li><p><a class="reference internal" href="#module-sarracenia.flowcb.accept.longflow" id="id9">sarracenia.flowcb.accept.longflow</a></p></li>
<li><p><a class="reference internal" href="#module-sarracenia.flowcb.accept.posthourtree" id="id10">sarracenia.flowcb.accept.posthourtree</a></p></li>
<li><p><a class="reference internal" href="#module-sarracenia.flowcb.accept.postoverride" id="id11">sarracenia.flowcb.accept.postoverride</a></p></li>
<li><p><a class="reference internal" href="#module-sarracenia.flowcb.accept.printlag" id="id12">sarracenia.flowcb.accept.printlag</a></p></li>
<li><p><a class="reference internal" href="#module-sarracenia.flowcb.accept.rename4jicc" id="id13">sarracenia.flowcb.accept.rename4jicc</a></p></li>
<li><p><a class="reference internal" href="#module-sarracenia.flowcb.accept.renamedmf" id="id14">sarracenia.flowcb.accept.renamedmf</a></p></li>
<li><p><a class="reference internal" href="#module-sarracenia.flowcb.accept.renamewhatfn" id="id15">sarracenia.flowcb.accept.renamewhatfn</a></p></li>
<li><p><a class="reference internal" href="#module-sarracenia.flowcb.accept.save" id="id16">sarracenia.flowcb.accept.save</a></p></li>
<li><p><a class="reference internal" href="#module-sarracenia.flowcb.accept.speedo" id="id17">sarracenia.flowcb.accept.speedo</a></p></li>
<li><p><a class="reference internal" href="#module-sarracenia.flowcb.accept.sundewpxroute" id="id18">sarracenia.flowcb.accept.sundewpxroute</a></p></li>
<li><p><a class="reference internal" href="#module-sarracenia.flowcb.accept.testretry" id="id19">sarracenia.flowcb.accept.testretry</a></p></li>
<li><p><a class="reference internal" href="#module-sarracenia.flowcb.accept.toclusters" id="id20">sarracenia.flowcb.accept.toclusters</a></p></li>
<li><p><a class="reference internal" href="#sarracenia-flowcb-accept-tohttp" id="id21">sarracenia.flowcb.accept.tohttp</a></p></li>
<li><p><a class="reference internal" href="#sarracenia-flowcb-accept-tolocal" id="id22">sarracenia.flowcb.accept.tolocal</a></p></li>
<li><p><a class="reference internal" href="#module-sarracenia.flowcb.accept.tolocalfile" id="id23">sarracenia.flowcb.accept.tolocalfile</a></p></li>
<li><p><a class="reference internal" href="#module-sarracenia.flowcb.accept.wmotypesuffix" id="id24">sarracenia.flowcb.accept.wmotypesuffix</a></p></li>
<li><p><a class="reference internal" href="#module-sarracenia.flowcb.clamav" id="id25">sarracenia.flowcb.clamav</a></p></li>
<li><p><a class="reference internal" href="#module-sarracenia.flowcb.destfn.sample" id="id26">sarracenia.flowcb.destfn.sample</a></p></li>
<li><p><a class="reference internal" href="#module-sarracenia.flowcb.filter" id="id27">sarracenia.flowcb.filter</a></p></li>
<li><p><a class="reference internal" href="#module-sarracenia.flowcb.filter.deleteflowfiles" id="id28">sarracenia.flowcb.filter.deleteflowfiles</a></p></li>
<li><p><a class="reference internal" href="#module-sarracenia.flowcb.filter.fdelay" id="id29">sarracenia.flowcb.filter.fdelay</a></p></li>
<li><p><a class="reference internal" href="#module-sarracenia.flowcb.filter.pclean_f90" id="id30">sarracenia.flowcb.filter.pclean_f90</a></p></li>
<li><p><a class="reference internal" href="#module-sarracenia.flowcb.filter.pclean_f92" id="id31">sarracenia.flowcb.filter.pclean_f92</a></p></li>
<li><p><a class="reference internal" href="#module-sarracenia.flowcb.filter.wmo2msc" id="id32">sarracenia.flowcb.filter.wmo2msc</a></p></li>
<li><p><a class="reference internal" href="#module-sarracenia.flowcb.gather" id="id33">sarracenia.flowcb.gather</a></p></li>
<li><p><a class="reference internal" href="#module-sarracenia.flowcb.gather.file" id="id34">sarracenia.flowcb.gather.file</a></p></li>
<li><p><a class="reference internal" href="#module-sarracenia.flowcb.gather.message" id="id35">sarracenia.flowcb.gather.message</a></p></li>
<li><p><a class="reference internal" href="#module-sarracenia.flowcb.housekeeping" id="id36">sarracenia.flowcb.housekeeping</a></p></li>
<li><p><a class="reference internal" href="#module-sarracenia.flowcb.housekeeping.resources" id="id37">sarracenia.flowcb.housekeeping.resources</a></p></li>
<li><p><a class="reference internal" href="#module-sarracenia.flowcb.log" id="id38">sarracenia.flowcb.log</a></p></li>
<li><p><a class="reference internal" href="#module-sarracenia.flowcb.mdelaylatest" id="id39">sarracenia.flowcb.mdelaylatest</a></p></li>
<li><p><a class="reference internal" href="#module-sarracenia.flowcb.nodupe" id="id40">sarracenia.flowcb.nodupe</a></p></li>
<li><p><a class="reference internal" href="#module-sarracenia.flowcb.nodupe.data" id="id41">sarracenia.flowcb.nodupe.data</a></p></li>
<li><p><a class="reference internal" href="#module-sarracenia.flowcb.nodupe.name" id="id42">sarracenia.flowcb.nodupe.name</a></p></li>
<li><p><a class="reference internal" href="#module-sarracenia.flowcb.retry" id="id43">sarracenia.flowcb.retry</a></p></li>
<li><p><a class="reference internal" href="#module-sarracenia.flowcb.pclean" id="id44">sarracenia.flowcb.pclean</a></p></li>
<li><p><a class="reference internal" href="#module-sarracenia.flowcb.sample" id="id45">sarracenia.flowcb.sample</a></p></li>
<li><p><a class="reference internal" href="#module-sarracenia.flowcb.scheduled" id="id46">sarracenia.flowcb.scheduled</a></p></li>
<li><p><a class="reference internal" href="#sarracenia-flowcb-script" id="id47">sarracenia.flowcb.script</a></p></li>
<li><p><a class="reference internal" href="#module-sarracenia.flowcb.shiftdir2baseurl" id="id48">sarracenia.flowcb.shiftdir2baseurl</a></p></li>
<li><p><a class="reference internal" href="#module-sarracenia.flowcb.poll" id="id49">sarracenia.flowcb.poll</a></p></li>
<li><p><a class="reference internal" href="#module-sarracenia.flowcb.poll.airnow" id="id50">sarracenia.flowcb.poll.airnow</a></p></li>
<li><p><a class="reference internal" href="#module-sarracenia.flowcb.poll.mail" id="id51">sarracenia.flowcb.poll.mail</a></p></li>
<li><p><a class="reference internal" href="#module-sarracenia.flowcb.poll.nasa_mls_nrt" id="id52">sarracenia.flowcb.poll.nasa_mls_nrt</a></p></li>
<li><p><a class="reference internal" href="#sarracenia-flowcb-poll-nexrad" id="id53">sarracenia.flowcb.poll.nexrad</a></p></li>
<li><p><a class="reference internal" href="#module-sarracenia.flowcb.poll.noaa_hydrometric" id="id54">sarracenia.flowcb.poll.noaa_hydrometric</a></p></li>
<li><p><a class="reference internal" href="#sarracenia-flowcb-poll-usgs" id="id55">sarracenia.flowcb.poll.usgs</a></p></li>
<li><p><a class="reference internal" href="#module-sarracenia.flowcb.post" id="id56">sarracenia.flowcb.post</a></p></li>
<li><p><a class="reference internal" href="#module-sarracenia.flowcb.send.email" id="id57">sarracenia.flowcb.send.email</a></p></li>
<li><p><a class="reference internal" href="#module-sarracenia.flowcb.post.message" id="id58">sarracenia.flowcb.post.message</a></p></li>
<li><p><a class="reference internal" href="#module-sarracenia.flowcb.send" id="id59">sarracenia.flowcb.send</a></p></li>
<li><p><a class="reference internal" href="#sarracenia-flowcb-wistree" id="id60">sarracenia.flowcb.wistree</a></p></li>
<li><p><a class="reference internal" href="#module-sarracenia.flowcb.work" id="id61">sarracenia.flowcb.work</a></p></li>
<li><p><a class="reference internal" href="#module-sarracenia.flowcb.work.age" id="id62">sarracenia.flowcb.work.age</a></p></li>
<li><p><a class="reference internal" href="#module-sarracenia.flowcb.work.rxpipe" id="id63">sarracenia.flowcb.work.rxpipe</a></p></li>
<li><p><a class="reference internal" href="#module-sarracenia.flowcb.v2wrapper" id="id64">sarracenia.flowcb.v2wrapper</a></p></li>
</ul>
</li>
</ul>
</nav>
<section id="module-sarracenia.flowcb">
<span id="sarracenia-flowcb"></span><h2><a class="toc-backref" href="#id2" role="doc-backlink">sarracenia.flowcb</a><a class="headerlink" href="#module-sarracenia.flowcb" title="Link to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="sarracenia.flowcb.FlowCB">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sarracenia.flowcb.</span></span><span class="sig-name descname"><span class="pre">FlowCB</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">options</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">class_logger</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sarracenia/flowcb.html#FlowCB"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sarracenia.flowcb.FlowCB" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Flow Callback is the main class for implementing plugin customization to flows.</p>
<p>sample activation in a configuration file:</p>
<p>flowCallback sarracenia.flowcb.name.Name</p>
<p>will instantiate an object of that type whose appropriately name methods
will be called at the right time.</p>
<p>__init__ accepts options as an argument.</p>
<p>options is a sarracenia.config.Config object, used to override default behaviour</p>
<p>a setting is declared in a configuration file like so:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">set</span> <span class="n">sarracenia</span><span class="o">.</span><span class="n">flowcb</span><span class="o">.</span><span class="n">filter</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">Log</span><span class="o">.</span><span class="n">level</span> <span class="n">debug</span>
</pre></div>
</div>
<p>(the prefix for the setting matches the type hierarchy in flowCallback)
the plugin should get the setting:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">options</span><span class="o">.</span><span class="n">level</span> <span class="o">=</span> <span class="s1">&#39;debug&#39;</span>
</pre></div>
</div>
<p>worklist given to on_plugins…</p>
<ul class="simple">
<li><p>worklist.incoming –&gt; new messages to continue processing</p></li>
<li><p>worklist.ok       –&gt; successfully processed</p></li>
<li><p>worklist.rejected –&gt; messages to not be further processed.</p></li>
<li><p>worklist.failed   –&gt; messages for which processing failed. Failed messages will be retried.</p></li>
<li><p>worklist.directories_ok –&gt; list of directories created during processing.</p></li>
</ul>
<p>Initially, all messages are placed in incoming.
if a plugin entry_point decides:</p>
<ul class="simple">
<li><p>a message is not relevant, it is moved to the rejected worklist.</p></li>
<li><p>all processing has been done, it moves it to the ok worklist</p></li>
<li><p>an operation failed and it should be retried later, append it to the failed
worklist</p></li>
</ul>
<p>Do not remove any message from all lists, only move messages between them.
it is necessary to put rejected messages in the appropriate worklist
so they can be acknowledged as received. Messages can only removed after ack.</p>
<p>def __init__(self,options) -&gt; None:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Task</span><span class="p">:</span> <span class="n">initialization</span> <span class="n">of</span> <span class="n">the</span> <span class="n">flowCallback</span> <span class="n">at</span> <span class="n">instantiation</span> <span class="n">time</span><span class="o">.</span>

<span class="n">usually</span> <span class="n">contains</span><span class="p">:</span>

<span class="bp">self</span><span class="o">.</span><span class="n">o</span> <span class="o">=</span> <span class="n">options</span>
</pre></div>
</div>
<p>def ack(self,messagelist) -&gt; None:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Task</span><span class="p">:</span> <span class="n">acknowledge</span> <span class="n">messages</span> <span class="kn">from</span> <span class="nn">a</span> <span class="n">gather</span> <span class="n">source</span><span class="o">.</span>
</pre></div>
</div>
<p>def gather(self, messageCountMax) -&gt; (gather_more, messages)</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Task</span><span class="p">:</span> <span class="n">gather</span> <span class="n">messages</span> <span class="kn">from</span> <span class="nn">a</span> <span class="n">source</span><span class="o">...</span> <span class="k">return</span> <span class="n">a</span> <span class="nb">tuple</span><span class="p">:</span>

      <span class="o">*</span> <span class="n">gather_more</span> <span class="o">...</span> <span class="nb">bool</span> <span class="n">whether</span> <span class="n">to</span> <span class="k">continue</span> <span class="n">gathering</span>
      <span class="o">*</span> <span class="n">messages</span> <span class="o">...</span> <span class="nb">list</span> <span class="n">of</span> <span class="n">messages</span>

      <span class="ow">or</span> <span class="n">just</span> <span class="k">return</span> <span class="n">a</span> <span class="nb">list</span> <span class="n">of</span> <span class="n">messages</span><span class="o">.</span>

      <span class="n">In</span> <span class="n">a</span> <span class="n">poll</span><span class="p">,</span> <span class="n">gather</span> <span class="ow">is</span> <span class="n">always</span> <span class="n">called</span><span class="p">,</span> <span class="n">regardless</span> <span class="n">of</span> <span class="n">vip</span> <span class="n">posession</span><span class="o">.</span>

      <span class="n">In</span> <span class="nb">all</span> <span class="n">other</span> <span class="n">components</span><span class="p">,</span> <span class="n">gather</span> <span class="ow">is</span> <span class="n">only</span> <span class="n">called</span> <span class="n">when</span> <span class="ow">in</span> <span class="n">posession</span>
      <span class="n">of</span> <span class="n">the</span> <span class="n">vip</span><span class="o">.</span>

<span class="k">return</span> <span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span>
 <span class="n">OR</span>
<span class="k">return</span> <span class="nb">list</span>
</pre></div>
</div>
<p>def after_accept(self,worklist) -&gt; None:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Task</span><span class="p">:</span> <span class="n">just</span> <span class="n">after</span> <span class="n">messages</span> <span class="n">go</span> <span class="n">through</span> <span class="n">accept</span><span class="o">/</span><span class="n">reject</span> <span class="n">masks</span><span class="p">,</span>
      <span class="n">operate</span> <span class="n">on</span> <span class="n">worklist</span><span class="o">.</span><span class="n">incoming</span> <span class="n">to</span> <span class="n">help</span> <span class="n">decide</span> <span class="n">which</span> <span class="n">messages</span> <span class="n">to</span> <span class="n">process</span> <span class="n">further</span><span class="o">.</span>
      <span class="ow">and</span> <span class="n">move</span> <span class="n">messages</span> <span class="n">to</span> <span class="n">worklist</span><span class="o">.</span><span class="n">rejected</span> <span class="n">to</span> <span class="n">prevent</span> <span class="n">further</span> <span class="n">processing</span><span class="o">.</span>
      <span class="n">do</span> <span class="ow">not</span> <span class="n">delete</span> <span class="nb">any</span> <span class="n">messages</span><span class="p">,</span> <span class="n">only</span> <span class="n">move</span> <span class="n">between</span> <span class="n">worklists</span><span class="o">.</span>
</pre></div>
</div>
<p>def after_work(self,worklist) -&gt; None:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Task</span><span class="p">:</span> <span class="n">operate</span> <span class="n">on</span> <span class="n">worklist</span><span class="o">.</span><span class="n">ok</span> <span class="p">(</span><span class="n">files</span> <span class="n">which</span> <span class="n">have</span> <span class="n">arrived</span><span class="o">.</span><span class="p">)</span>

<span class="n">All</span> <span class="n">messages</span> <span class="n">on</span> <span class="n">the</span> <span class="n">worklist</span><span class="o">.</span><span class="n">ok</span> <span class="nb">list</span> <span class="n">have</span> <span class="n">been</span> <span class="n">acknowledged</span><span class="p">,</span> <span class="n">so</span> <span class="n">to</span> <span class="n">suppress</span> <span class="n">posting</span>
<span class="n">of</span> <span class="n">them</span><span class="p">,</span> <span class="ow">or</span> <span class="n">futher</span> <span class="n">processing</span><span class="p">,</span> <span class="n">the</span> <span class="n">messages</span> <span class="n">must</span> <span class="n">be</span> <span class="n">removed</span> <span class="kn">from</span> <span class="nn">worklist.ok.</span>

<span class="n">worklist</span><span class="o">.</span><span class="n">failed</span> <span class="n">processing</span> <span class="n">should</span> <span class="n">occur</span> <span class="ow">in</span> <span class="n">here</span> <span class="k">as</span> <span class="n">it</span> <span class="n">will</span> <span class="n">be</span> <span class="n">zeroed</span> <span class="n">out</span> <span class="n">after</span> <span class="n">this</span> <span class="n">step</span><span class="o">.</span>
<span class="n">The</span> <span class="n">flowcb</span><span class="o">/</span><span class="n">retry</span><span class="o">.</span><span class="n">py</span> <span class="n">plugin</span><span class="p">,</span> <span class="k">for</span> <span class="n">example</span><span class="p">,</span> <span class="n">processes</span> <span class="n">failed</span> <span class="n">messages</span><span class="o">.</span>
</pre></div>
</div>
<p>def destfn(self,msg) -&gt; str:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Destination</span> <span class="n">File</span> <span class="n">Name</span> <span class="p">(</span><span class="n">DESTFNSCRIPT</span><span class="p">)</span>  <span class="n">routines</span><span class="o">.</span>

<span class="n">Task</span><span class="p">:</span> <span class="n">look</span> <span class="n">at</span> <span class="n">the</span> <span class="n">fields</span> <span class="ow">in</span> <span class="n">the</span> <span class="n">message</span><span class="p">,</span> <span class="ow">and</span> <span class="n">perhaps</span> <span class="n">settings</span> <span class="ow">and</span>
      <span class="k">return</span> <span class="n">a</span> <span class="n">new</span> <span class="n">file</span> <span class="n">name</span> <span class="k">for</span> <span class="n">the</span> <span class="n">target</span> <span class="n">of</span> <span class="n">the</span> <span class="n">send</span> <span class="ow">or</span> <span class="n">download</span><span class="o">.</span>

<span class="n">kind</span> <span class="n">of</span> <span class="n">a</span> <span class="n">last</span> <span class="n">resort</span> <span class="n">function</span><span class="p">,</span> <span class="n">exists</span> <span class="n">mostly</span> <span class="k">for</span> <span class="n">sundew</span> <span class="n">compatibility</span><span class="o">.</span>
<span class="n">can</span> <span class="n">be</span> <span class="n">used</span> <span class="k">for</span> <span class="n">selective</span> <span class="n">renaming</span> <span class="n">using</span> <span class="n">accept</span> <span class="n">clauses</span><span class="o">.</span>
</pre></div>
</div>
<p>def download(self,msg) -&gt; bool:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Task</span><span class="p">:</span> <span class="n">looking</span> <span class="n">at</span> <span class="n">msg</span><span class="p">[</span><span class="s1">&#39;new_dir&#39;</span><span class="p">],</span> <span class="n">msg</span><span class="p">[</span><span class="s1">&#39;new_file&#39;</span><span class="p">],</span> <span class="n">msg</span><span class="p">[</span><span class="s1">&#39;new_inflight_file&#39;</span><span class="p">]</span>
      <span class="ow">and</span> <span class="n">the</span> <span class="bp">self</span><span class="o">.</span><span class="n">o</span> <span class="n">options</span> <span class="n">perform</span> <span class="n">a</span> <span class="n">download</span> <span class="n">of</span> <span class="n">a</span> <span class="n">single</span> <span class="n">file</span><span class="o">.</span>
      <span class="k">return</span> <span class="kc">True</span> <span class="n">on</span> <span class="n">a</span> <span class="n">successful</span> <span class="n">transfer</span><span class="p">,</span> <span class="kc">False</span> <span class="n">otherwise</span><span class="o">.</span>

      <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">o</span><span class="o">.</span><span class="n">dry_run</span> <span class="ow">is</span> <span class="nb">set</span><span class="p">,</span> <span class="n">simulate</span> <span class="n">the</span> <span class="n">output</span> <span class="n">of</span> <span class="n">a</span> <span class="n">download</span> <span class="n">without</span>
      <span class="n">performing</span> <span class="n">it</span><span class="o">.</span>

<span class="n">This</span> <span class="n">replaces</span> <span class="n">built</span><span class="o">-</span><span class="ow">in</span> <span class="n">download</span> <span class="n">functionality</span><span class="p">,</span> <span class="n">providing</span> <span class="n">an</span> <span class="n">override</span><span class="o">.</span>
<span class="k">for</span> <span class="n">individual</span> <span class="n">file</span> <span class="n">transfers</span><span class="o">.</span> <span class="n">ideally</span> <span class="n">you</span> <span class="nb">set</span> <span class="n">checksums</span> <span class="k">as</span> <span class="n">you</span> <span class="n">download</span><span class="o">.</span>
</pre></div>
</div>
<p>def metricsReport(self) -&gt; dict:</p>
<blockquote>
<div><p>Return a dictionary of metrics. Example: number of messages remaining in retry queues.</p>
</div></blockquote>
<dl class="simple">
<dt>def on_cleanup(self) -&gt; None::</dt><dd><p>allow plugins to perform additional work after broker resources are eliminated.
local state files are still present when this runs.</p>
</dd>
<dt>def on_declare(self) -&gt; None::</dt><dd><p>local state files are still already present when this runs.
allow plugins to perform additional work besides broker resource setup.</p>
</dd>
</dl>
<p>def on_housekeeping(self) -&gt; None:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">do</span> <span class="n">periodic</span> <span class="n">processing</span><span class="o">.</span>
</pre></div>
</div>
<p>def on_start(self) -&gt; None:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">After</span> <span class="n">the</span> <span class="n">connection</span> <span class="ow">is</span> <span class="n">established</span> <span class="k">with</span> <span class="n">the</span> <span class="n">broker</span> <span class="ow">and</span> <span class="n">things</span> <span class="n">are</span> <span class="n">instantiated</span><span class="p">,</span> <span class="n">but</span>
<span class="n">before</span> <span class="nb">any</span> <span class="n">message</span> <span class="n">transfer</span> <span class="n">occurs</span><span class="o">.</span>
</pre></div>
</div>
<p>def on_stop(self) -&gt; None:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">what</span> <span class="n">it</span> <span class="n">says</span> <span class="n">on</span> <span class="n">the</span> <span class="n">tin</span><span class="o">...</span> <span class="n">clean</span> <span class="n">up</span> <span class="n">processing</span> <span class="n">when</span> <span class="n">stopping</span><span class="o">.</span>
</pre></div>
</div>
<p>def poll(self) -&gt; list:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Task</span><span class="p">:</span> <span class="n">gather</span> <span class="n">messages</span> <span class="kn">from</span> <span class="nn">a</span> <span class="n">destination</span><span class="o">...</span> <span class="k">return</span> <span class="n">a</span> <span class="nb">list</span> <span class="n">of</span> <span class="n">messages</span><span class="o">.</span>
      <span class="n">works</span> <span class="n">like</span> <span class="n">a</span> <span class="n">gather</span><span class="p">,</span> <span class="n">but</span><span class="o">...</span>

      <span class="n">When</span> <span class="n">specified</span><span class="p">,</span> <span class="n">poll</span> <span class="n">replaces</span> <span class="n">the</span> <span class="n">built</span><span class="o">-</span><span class="ow">in</span> <span class="n">poll</span> <span class="n">of</span> <span class="n">the</span> <span class="n">poll</span> <span class="n">component</span><span class="o">.</span>
      <span class="n">it</span> <span class="n">runs</span> <span class="n">only</span> <span class="n">when</span> <span class="n">the</span> <span class="n">machine</span> <span class="n">running</span> <span class="n">the</span> <span class="n">poll</span> <span class="n">has</span> <span class="n">the</span> <span class="n">vip</span><span class="o">.</span>
      <span class="ow">in</span> <span class="n">components</span> <span class="n">other</span> <span class="n">than</span> <span class="n">poll</span><span class="p">,</span> <span class="n">poll</span> <span class="ow">is</span> <span class="n">never</span> <span class="n">called</span><span class="o">.</span>
<span class="k">return</span> <span class="p">[]</span>
</pre></div>
</div>
<p>def post(self,worklist) -&gt; None:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Task</span><span class="p">:</span> <span class="n">operate</span> <span class="n">on</span> <span class="n">worklist</span><span class="o">.</span><span class="n">ok</span><span class="p">,</span> <span class="ow">and</span> <span class="n">worklist</span><span class="o">.</span><span class="n">failed</span><span class="o">.</span> <span class="n">modifies</span> <span class="n">them</span> <span class="n">appropriately</span><span class="o">.</span>
      <span class="n">message</span> <span class="n">acknowledgement</span> <span class="n">has</span> <span class="n">already</span> <span class="n">occurred</span> <span class="n">before</span> <span class="n">they</span> <span class="n">are</span> <span class="n">called</span><span class="o">.</span>

<span class="n">to</span> <span class="n">indicate</span> <span class="n">failure</span> <span class="n">to</span> <span class="n">process</span> <span class="n">a</span> <span class="n">message</span><span class="p">,</span> <span class="n">append</span> <span class="n">to</span> <span class="n">worklist</span><span class="o">.</span><span class="n">failed</span><span class="o">.</span>
<span class="n">worklist</span><span class="o">.</span><span class="n">failed</span> <span class="n">processing</span> <span class="n">should</span> <span class="n">occur</span> <span class="ow">in</span> <span class="n">here</span> <span class="k">as</span> <span class="n">it</span> <span class="n">will</span> <span class="n">be</span> <span class="n">zeroed</span> <span class="n">out</span> <span class="n">after</span> <span class="n">this</span> <span class="n">step</span><span class="o">.</span>
</pre></div>
</div>
<p>def send(self,msg) -&gt; bool:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Task</span><span class="p">:</span> <span class="n">looking</span> <span class="n">at</span> <span class="n">msg</span><span class="p">[</span><span class="s1">&#39;new_dir&#39;</span><span class="p">],</span> <span class="n">msg</span><span class="p">[</span><span class="s1">&#39;new_file&#39;</span><span class="p">],</span> <span class="ow">and</span> <span class="n">the</span> <span class="bp">self</span><span class="o">.</span><span class="n">o</span> <span class="n">options</span> <span class="n">perform</span> <span class="n">a</span> <span class="n">transfer</span>
      <span class="n">of</span> <span class="n">a</span> <span class="n">single</span> <span class="n">file</span><span class="o">.</span>
      <span class="k">return</span> <span class="kc">True</span> <span class="n">on</span> <span class="n">a</span> <span class="n">successful</span> <span class="n">transfer</span><span class="p">,</span> <span class="kc">False</span> <span class="n">otherwise</span><span class="o">.</span>

      <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">o</span><span class="o">.</span><span class="n">dry_run</span> <span class="ow">is</span> <span class="nb">set</span><span class="p">,</span> <span class="n">simulate</span> <span class="n">the</span> <span class="n">output</span> <span class="n">of</span> <span class="n">a</span> <span class="n">send</span> <span class="n">without</span>
      <span class="n">performing</span> <span class="n">it</span><span class="o">.</span>

<span class="n">This</span> <span class="n">replaces</span> <span class="n">built</span><span class="o">-</span><span class="ow">in</span> <span class="n">send</span> <span class="n">functionality</span> <span class="k">for</span> <span class="n">individual</span> <span class="n">files</span><span class="o">.</span>
</pre></div>
</div>
<dl class="simple">
<dt>def please_stop(self):</dt><dd><p>Pre-warn a flowcb that a stop has been requested, allowing processing to wrap up
before the full stop happens.</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="sarracenia.flowcb.FlowCB.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">options</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">class_logger</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sarracenia/flowcb.html#FlowCB.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sarracenia.flowcb.FlowCB.__init__" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="sarracenia.flowcb.FlowCB.__weakref__">
<span class="sig-name descname"><span class="pre">__weakref__</span></span><a class="headerlink" href="#sarracenia.flowcb.FlowCB.__weakref__" title="Link to this definition"></a></dt>
<dd><p>list of weak references to the object (if defined)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sarracenia.flowcb.FlowCB.please_stop">
<span class="sig-name descname"><span class="pre">please_stop</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sarracenia/flowcb.html#FlowCB.please_stop"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sarracenia.flowcb.FlowCB.please_stop" title="Link to this definition"></a></dt>
<dd><p>flow callbacks should not time.sleep for long periods, but only nap and check
between naps if a stop has been requested.</p>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sarracenia.flowcb.load_library">
<span class="sig-prename descclassname"><span class="pre">sarracenia.flowcb.</span></span><span class="sig-name descname"><span class="pre">load_library</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">factory_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">options</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sarracenia/flowcb.html#load_library"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sarracenia.flowcb.load_library" title="Link to this definition"></a></dt>
<dd><p>Loading the entry points for a python module. It searches
the normal python module path using the importlib module.</p>
<p>the factory_path is a combined file specification with a dot separator
with a special last entry being the name of the class within the file.</p>
<p>factory_path  a.b.c.C</p>
<p>means import the module named a.b.c and instantiate an object of type
C. In that class-C object, look for the known callback entry points.</p>
<p>or C might be guessed by the last class in the path not following
python convention by not starting with a capital letter, in which case,
it will just guess.</p>
<p>re
note that the ~/.config/sr3/plugins will also be in the python library
path, so modules placed there will be found, in addition to those in the
package itself in the <em>sarracenia/flowcb</em>  directory</p>
<dl class="simple">
<dt>callback foo  -&gt; foo.Foo</dt><dd><p>sarracenia.flowcb.foo.Foo</p>
</dd>
<dt>callback foo.bar -&gt; foo.bar.Bar</dt><dd><p>sarracenia.flowcb.foo.bar.Bar
foo.bar
sarracenia.flowcb.foo.bar</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-sarracenia.flowcb.accept">
<span id="sarracenia-flowcb-accept"></span><h2><a class="toc-backref" href="#id3" role="doc-backlink">sarracenia.flowcb.accept</a><a class="headerlink" href="#module-sarracenia.flowcb.accept" title="Link to this heading"></a></h2>
<p>sarracenia.flowcb.accept modules are ones where the main focus is on the after_accept entry point.
This entry point is called after reject &amp; accept rules have been called, and typically after
duplicate suppression has also been applied.</p>
<p>They can be used to further refine which files should be downloaded, by moving messages from the
worklist.incoming to worklist.rejected.</p>
</section>
<section id="module-sarracenia.flowcb.accept.delete">
<span id="sarracenia-flowcb-accept-delete"></span><h2><a class="toc-backref" href="#id4" role="doc-backlink">sarracenia.flowcb.accept.delete</a><a class="headerlink" href="#module-sarracenia.flowcb.accept.delete" title="Link to this heading"></a></h2>
<dl class="simple">
<dt>Plugin delete.py:</dt><dd><p>the default after_accept handler for log.
prints a simple notice. # FIXME is this doc accurate? seems it is also modifying a message.</p>
</dd>
<dt>Usage:</dt><dd><p>flowcb sarracenia.flowcb.accept.delete.Delete</p>
</dd>
</dl>
<dl class="py class">
<dt class="sig sig-object py" id="sarracenia.flowcb.accept.delete.Delete">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sarracenia.flowcb.accept.delete.</span></span><span class="sig-name descname"><span class="pre">Delete</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">options</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sarracenia/flowcb/accept/delete.html#Delete"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sarracenia.flowcb.accept.delete.Delete" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#sarracenia.flowcb.FlowCB" title="sarracenia.flowcb.FlowCB"><code class="xref py py-class docutils literal notranslate"><span class="pre">FlowCB</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="sarracenia.flowcb.accept.delete.Delete.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">options</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sarracenia/flowcb/accept/delete.html#Delete.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sarracenia.flowcb.accept.delete.Delete.__init__" title="Link to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

</section>
<section id="module-sarracenia.flowcb.download">
<span id="sarracenia-flowcb-download"></span><h2><a class="toc-backref" href="#id5" role="doc-backlink">sarracenia.flowcb.download</a><a class="headerlink" href="#module-sarracenia.flowcb.download" title="Link to this heading"></a></h2>
<p>Place holder customized flow callback classes whose focus is the download() entry point.</p>
<p>download(self,msg):</p>
<blockquote>
<div><dl class="simple">
<dt>Task: looking at msg[‘new_dir’], msg[‘new_path’], msg[‘new_inflight_path’]</dt><dd><p>and the self.o options perform a download of a single file.
return True on a successful transfer, False otherwise.</p>
</dd>
</dl>
<p>if self.o.dry_run is set, simulate the output of a download without
performing it.</p>
<p>downlaod is called by the sarra and subscribe components, and can be used
to override the built-in methods for downloading a file.</p>
<p>It does the download based on the fields in the message provided:</p>
<p>retreival path: msg[‘baseUrl’] + ‘/’ + msg[‘relPath’]</p>
<p>taking care of the inflight setting, the inflight/temporary file:
is defined for use by the download routing: msg[‘new_inflight_path’]</p>
<p>Final local location to store is defined by:</p>
<blockquote>
<div><p>msg[‘new_path’] == msg[‘new_dir’] + ‘/’ + msg[‘new_file’]</p>
</div></blockquote>
<p>This replaces built-in download functionality, providing an override.
for individual file transfers. ideally you set checksums as you download.</p>
<p>looking at self.o.identity_method to establish download checksum algorithm.
might have to allow for cod… say it is checksum_method:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">checksum</span> <span class="o">=</span> <span class="n">sarracenia</span><span class="o">.</span><span class="n">identity</span><span class="o">.</span><span class="n">Identity</span><span class="o">.</span><span class="n">factory</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">o</span><span class="o">.</span><span class="n">checksum_method</span><span class="p">)</span>
<span class="k">while</span> <span class="n">downloading</span><span class="p">:</span>
    <span class="n">checksum</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">chunk</span><span class="p">)</span>
</pre></div>
</div>
<p>where chunk is the bytes read. It saves a file read to calculate the checksum
during the download.</p>
<p>if the checksum does not match what is in the received message, then
it is imperative, to avoid looping, to apply the actual checksum of the
data to the message:</p>
<blockquote>
<div><p>msg[‘identity’] =  { ‘method’: checksum_method, ‘value’: checksum.get_sumstr() }</p>
</div></blockquote>
<p>return Boolean success indicator.  if False, download  will be attempted again and/or
appended to retry queue.</p>
</div></blockquote>
</section>
<section id="module-sarracenia.flowcb.accept.downloadbaseurl">
<span id="sarracenia-flowcb-accept-downloadbaseurl"></span><h2><a class="toc-backref" href="#id6" role="doc-backlink">sarracenia.flowcb.accept.downloadbaseurl</a><a class="headerlink" href="#module-sarracenia.flowcb.accept.downloadbaseurl" title="Link to this heading"></a></h2>
<dl class="simple">
<dt>Plugin downloadbaseurl.py:</dt><dd><p>Downloads files sourced from the baseUrl of the poster, and saves them in the
directory specified in the config. Created to use with the poll_nexrad.py
plugin to download files uploaded in the NEXRAD US Weather Radar public dataset.
Compatible with Python 3.5+.</p>
</dd>
</dl>
<p class="rubric">Example</p>
<dl class="simple">
<dt>A sample do_download option for subscribe.</dt><dd><p>Downloads the file located at message[‘baseUrl’] and saves it</p>
</dd>
<dt>Usage:</dt><dd><p>flowcb sarracenia.flowcb.accept.downloadbaseurl.DownloadBaseUrl</p>
</dd>
</dl>
<dl class="py class">
<dt class="sig sig-object py" id="sarracenia.flowcb.accept.downloadbaseurl.DownloadBaseUrl">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sarracenia.flowcb.accept.downloadbaseurl.</span></span><span class="sig-name descname"><span class="pre">DownloadBaseUrl</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">options</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sarracenia/flowcb/accept/downloadbaseurl.html#DownloadBaseUrl"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sarracenia.flowcb.accept.downloadbaseurl.DownloadBaseUrl" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#sarracenia.flowcb.FlowCB" title="sarracenia.flowcb.FlowCB"><code class="xref py py-class docutils literal notranslate"><span class="pre">FlowCB</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="sarracenia.flowcb.accept.downloadbaseurl.DownloadBaseUrl.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">options</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sarracenia/flowcb/accept/downloadbaseurl.html#DownloadBaseUrl.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sarracenia.flowcb.accept.downloadbaseurl.DownloadBaseUrl.__init__" title="Link to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

</section>
<section id="module-sarracenia.flowcb.accept.hourtree">
<span id="sarracenia-flowcb-accept-hourtree"></span><h2><a class="toc-backref" href="#id7" role="doc-backlink">sarracenia.flowcb.accept.hourtree</a><a class="headerlink" href="#module-sarracenia.flowcb.accept.hourtree" title="Link to this heading"></a></h2>
<dl class="simple">
<dt>Plugin hourtree.py:</dt><dd><p>When receiving a file, insert an hourly directory into the local delivery path hierarchy.</p>
</dd>
</dl>
<p class="rubric">Example</p>
<p>input A/B/c.gif  –&gt; output A/B/&lt;hour&gt;/c.gif</p>
<dl class="simple">
<dt>Usage:</dt><dd><p>flowcb sarracenia.flowcb.accept.hourtree.HourTree</p>
</dd>
</dl>
<dl class="py class">
<dt class="sig sig-object py" id="sarracenia.flowcb.accept.hourtree.HourTree">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sarracenia.flowcb.accept.hourtree.</span></span><span class="sig-name descname"><span class="pre">HourTree</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">options</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sarracenia/flowcb/accept/hourtree.html#HourTree"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sarracenia.flowcb.accept.hourtree.HourTree" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#sarracenia.flowcb.FlowCB" title="sarracenia.flowcb.FlowCB"><code class="xref py py-class docutils literal notranslate"><span class="pre">FlowCB</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="sarracenia.flowcb.accept.hourtree.HourTree.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">options</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sarracenia/flowcb/accept/hourtree.html#HourTree.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sarracenia.flowcb.accept.hourtree.HourTree.__init__" title="Link to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

</section>
<section id="module-sarracenia.flowcb.accept.httptohttps">
<span id="sarracenia-flowcb-accept-httptohttps"></span><h2><a class="toc-backref" href="#id8" role="doc-backlink">sarracenia.flowcb.accept.httptohttps</a><a class="headerlink" href="#module-sarracenia.flowcb.accept.httptohttps" title="Link to this heading"></a></h2>
<dl>
<dt>Plugin httptohttps.py:</dt><dd><p>This plugin simply turns messages with baseUrl <a class="reference external" href="http://">http://</a>…  into   <a class="reference external" href="https://">https://</a>…</p>
<p>The process would need to be restarted. From now on, all http messages that would be
consumed, would be turned into an https message. The remaining of the process will
treat the message as if posted that way. That plugin is an easy way to turn transaction
between dd.weather.gc.ca and the user into secured https transfers.</p>
</dd>
<dt>Usage:</dt><dd><p>flowcb sarracenia.flowcb.accept.httptohttps.HttpToHttps</p>
</dd>
</dl>
<dl class="py class">
<dt class="sig sig-object py" id="sarracenia.flowcb.accept.httptohttps.HttpToHttps">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sarracenia.flowcb.accept.httptohttps.</span></span><span class="sig-name descname"><span class="pre">HttpToHttps</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">options</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sarracenia/flowcb/accept/httptohttps.html#HttpToHttps"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sarracenia.flowcb.accept.httptohttps.HttpToHttps" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#sarracenia.flowcb.FlowCB" title="sarracenia.flowcb.FlowCB"><code class="xref py py-class docutils literal notranslate"><span class="pre">FlowCB</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="sarracenia.flowcb.accept.httptohttps.HttpToHttps.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">options</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sarracenia/flowcb/accept/httptohttps.html#HttpToHttps.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sarracenia.flowcb.accept.httptohttps.HttpToHttps.__init__" title="Link to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

</section>
<section id="module-sarracenia.flowcb.accept.longflow">
<span id="sarracenia-flowcb-accept-longflow"></span><h2><a class="toc-backref" href="#id9" role="doc-backlink">sarracenia.flowcb.accept.longflow</a><a class="headerlink" href="#module-sarracenia.flowcb.accept.longflow" title="Link to this heading"></a></h2>
<dl class="simple">
<dt>Plugin longflow.py:</dt><dd><p>This plugin is strictly for self-test purposes.
Creates a header ‘toolong’ that is longer than 255 characters, and so gets truncated.
Each header in a message that is too long should generate a warning message in the sarra log.
flow_test checks for the ‘truncated’ error message.
Put some utf characters in there to make it interesting… (truncation complex.)</p>
</dd>
<dt>Usage:</dt><dd><p>flowcb sarracenia.flowcb.accept.longflow.LongFlow</p>
</dd>
</dl>
<dl class="py class">
<dt class="sig sig-object py" id="sarracenia.flowcb.accept.longflow.LongFlow">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sarracenia.flowcb.accept.longflow.</span></span><span class="sig-name descname"><span class="pre">LongFlow</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">options</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sarracenia/flowcb/accept/longflow.html#LongFlow"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sarracenia.flowcb.accept.longflow.LongFlow" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#sarracenia.flowcb.FlowCB" title="sarracenia.flowcb.FlowCB"><code class="xref py py-class docutils literal notranslate"><span class="pre">FlowCB</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="sarracenia.flowcb.accept.longflow.LongFlow.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">options</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sarracenia/flowcb/accept/longflow.html#LongFlow.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sarracenia.flowcb.accept.longflow.LongFlow.__init__" title="Link to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

</section>
<section id="module-sarracenia.flowcb.accept.posthourtree">
<span id="sarracenia-flowcb-accept-posthourtree"></span><h2><a class="toc-backref" href="#id10" role="doc-backlink">sarracenia.flowcb.accept.posthourtree</a><a class="headerlink" href="#module-sarracenia.flowcb.accept.posthourtree" title="Link to this heading"></a></h2>
<dl class="simple">
<dt>Plugin posthourtree.py:</dt><dd><p>When posting a file, insert an hourly directory into the delivery path hierarchy.</p>
</dd>
</dl>
<p class="rubric">Example</p>
<p>input A/B/c.gif  –&gt; output A/B/&lt;hour&gt;/c.gif</p>
<dl class="simple">
<dt>Usage:</dt><dd><p>callback accept.posthourtree</p>
</dd>
</dl>
<dl class="py class">
<dt class="sig sig-object py" id="sarracenia.flowcb.accept.posthourtree.Posthourtree">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sarracenia.flowcb.accept.posthourtree.</span></span><span class="sig-name descname"><span class="pre">Posthourtree</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">options</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sarracenia/flowcb/accept/posthourtree.html#Posthourtree"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sarracenia.flowcb.accept.posthourtree.Posthourtree" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#sarracenia.flowcb.FlowCB" title="sarracenia.flowcb.FlowCB"><code class="xref py py-class docutils literal notranslate"><span class="pre">FlowCB</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="sarracenia.flowcb.accept.posthourtree.Posthourtree.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">options</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sarracenia/flowcb/accept/posthourtree.html#Posthourtree.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sarracenia.flowcb.accept.posthourtree.Posthourtree.__init__" title="Link to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

</section>
<section id="module-sarracenia.flowcb.accept.postoverride">
<span id="sarracenia-flowcb-accept-postoverride"></span><h2><a class="toc-backref" href="#id11" role="doc-backlink">sarracenia.flowcb.accept.postoverride</a><a class="headerlink" href="#module-sarracenia.flowcb.accept.postoverride" title="Link to this heading"></a></h2>
<dl class="simple">
<dt>Plugin postoverride.py:</dt><dd><p>Override message header for products that are posted. This can be useful or necessary
when re-distributing beyond the original intended destinations.</p>
</dd>
</dl>
<p class="rubric">Example</p>
<p>for example company A delivers to their own DMZ server. ACME is a client of them,
and so subscribes to the ADMZ server, but the to_cluster=ADMZ, when ACME downloads, they
need to override the destination to specify the distribution within ACME.
* postOverride to_clusters ACME
* postOverrideDel from_cluster</p>
<dl class="simple">
<dt>Usage:</dt><dd><p>flowcb sarracenia.flowcb.accept.postoverride.PostOverride
postOverride x y
postOverrideDel z</p>
</dd>
</dl>
<dl class="py class">
<dt class="sig sig-object py" id="sarracenia.flowcb.accept.postoverride.PostOverride">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sarracenia.flowcb.accept.postoverride.</span></span><span class="sig-name descname"><span class="pre">PostOverride</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">options</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sarracenia/flowcb/accept/postoverride.html#PostOverride"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sarracenia.flowcb.accept.postoverride.PostOverride" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#sarracenia.flowcb.FlowCB" title="sarracenia.flowcb.FlowCB"><code class="xref py py-class docutils literal notranslate"><span class="pre">FlowCB</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="sarracenia.flowcb.accept.postoverride.PostOverride.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">options</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sarracenia/flowcb/accept/postoverride.html#PostOverride.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sarracenia.flowcb.accept.postoverride.PostOverride.__init__" title="Link to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

</section>
<section id="module-sarracenia.flowcb.accept.printlag">
<span id="sarracenia-flowcb-accept-printlag"></span><h2><a class="toc-backref" href="#id12" role="doc-backlink">sarracenia.flowcb.accept.printlag</a><a class="headerlink" href="#module-sarracenia.flowcb.accept.printlag" title="Link to this heading"></a></h2>
<dl>
<dt>Plugin printlag.py:</dt><dd><p>This is an after_accept plugin.
print a message indicating how old messages received are.
this should be used as an on_part script. For each part received it will print a line
in the local log that looks like this:</p>
<p>2015-12-23 22:54:30,328 [INFO] posted: 20151224035429.115 (lag: 1.21364 seconds ago) to deliver: /home/peter/test/dd/bulletins/alphanumeric/20151224/SA/EGGY/03/SAUK32_EGGY_240350__EGAA_64042,</p>
<p>the number printed after “lag:” the time between the moment the message was originally posted on the server,
and the time the script was called, which is very near the end of writing the file to local disk.</p>
<p>This can be used to gauge whether the number of instances or internet link are sufficient
to transfer the data selected.  if the lag keeps increasing, then something must be done.</p>
</dd>
<dt>Usage:</dt><dd><p>flowcb sarracenia.flowcb.accept.printlag.PrintLag</p>
</dd>
</dl>
<dl class="py class">
<dt class="sig sig-object py" id="sarracenia.flowcb.accept.printlag.PrintLag">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sarracenia.flowcb.accept.printlag.</span></span><span class="sig-name descname"><span class="pre">PrintLag</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">options</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sarracenia/flowcb/accept/printlag.html#PrintLag"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sarracenia.flowcb.accept.printlag.PrintLag" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#sarracenia.flowcb.FlowCB" title="sarracenia.flowcb.FlowCB"><code class="xref py py-class docutils literal notranslate"><span class="pre">FlowCB</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="sarracenia.flowcb.accept.printlag.PrintLag.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">options</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sarracenia/flowcb/accept/printlag.html#PrintLag.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sarracenia.flowcb.accept.printlag.PrintLag.__init__" title="Link to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

</section>
<section id="module-sarracenia.flowcb.accept.rename4jicc">
<span id="sarracenia-flowcb-accept-rename4jicc"></span><h2><a class="toc-backref" href="#id13" role="doc-backlink">sarracenia.flowcb.accept.rename4jicc</a><a class="headerlink" href="#module-sarracenia.flowcb.accept.rename4jicc" title="Link to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="sarracenia.flowcb.accept.rename4jicc.Rename4Jicc">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sarracenia.flowcb.accept.rename4jicc.</span></span><span class="sig-name descname"><span class="pre">Rename4Jicc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">options</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sarracenia/flowcb/accept/rename4jicc.html#Rename4Jicc"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sarracenia.flowcb.accept.rename4jicc.Rename4Jicc" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#sarracenia.flowcb.FlowCB" title="sarracenia.flowcb.FlowCB"><code class="xref py py-class docutils literal notranslate"><span class="pre">FlowCB</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="sarracenia.flowcb.accept.rename4jicc.Rename4Jicc.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">options</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sarracenia/flowcb/accept/rename4jicc.html#Rename4Jicc.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sarracenia.flowcb.accept.rename4jicc.Rename4Jicc.__init__" title="Link to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

</section>
<section id="module-sarracenia.flowcb.accept.renamedmf">
<span id="sarracenia-flowcb-accept-renamedmf"></span><h2><a class="toc-backref" href="#id14" role="doc-backlink">sarracenia.flowcb.accept.renamedmf</a><a class="headerlink" href="#module-sarracenia.flowcb.accept.renamedmf" title="Link to this heading"></a></h2>
<dl class="simple">
<dt>Plugin renamedmf.py:</dt><dd><p>This is an  example of the usage of after_accept script
to rename the product when it is downloaded
It adds a ‘:datetime’ to the name of the product
unlikely to be useful to others, except as example.</p>
</dd>
</dl>
<p class="rubric">Example</p>
<p>takes px name     : CACN00_CWAO_081900__WZS_14623:pxatx:CWAO:CA:5:Direct:20081008190602
add datetimestamp : CACN00_CWAO_081900__WZS_14623:pxatx:CWAO:CA:5:Direct:20081008190602:20081008190612</p>
<dl class="simple">
<dt>Usage:</dt><dd><p>flowcb sarracenia.flowcb.accept.renamedmf.RenameDMF</p>
</dd>
</dl>
<dl class="py class">
<dt class="sig sig-object py" id="sarracenia.flowcb.accept.renamedmf.RenameDMF">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sarracenia.flowcb.accept.renamedmf.</span></span><span class="sig-name descname"><span class="pre">RenameDMF</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">options</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sarracenia/flowcb/accept/renamedmf.html#RenameDMF"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sarracenia.flowcb.accept.renamedmf.RenameDMF" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#sarracenia.flowcb.FlowCB" title="sarracenia.flowcb.FlowCB"><code class="xref py py-class docutils literal notranslate"><span class="pre">FlowCB</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="sarracenia.flowcb.accept.renamedmf.RenameDMF.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">options</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sarracenia/flowcb/accept/renamedmf.html#RenameDMF.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sarracenia.flowcb.accept.renamedmf.RenameDMF.__init__" title="Link to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

</section>
<section id="module-sarracenia.flowcb.accept.renamewhatfn">
<span id="sarracenia-flowcb-accept-renamewhatfn"></span><h2><a class="toc-backref" href="#id15" role="doc-backlink">sarracenia.flowcb.accept.renamewhatfn</a><a class="headerlink" href="#module-sarracenia.flowcb.accept.renamewhatfn" title="Link to this heading"></a></h2>
<dl>
<dt>Plugin renamewhatfn.py:</dt><dd><p>This plugin is no longer needed.  Sundew compoatibility was added to Sarracenia,
so now can get the same effect by using the <em>filename</em> option which works like it
does in Sundew:</p>
<p>filename WHATFN</p>
<p>what it was used for:
This renamer strips everything from the first colon in the file name to the end.
This does the same thing as a ‘WHATFN’ config on a sundew sender.</p>
</dd>
</dl>
<p class="rubric">Example</p>
<p>takes px name     : /apps/dms/dms-metadata-updater/data/international_surface/import/mdicp4d:pull-international-metadata:CMC:DICTIONARY:4:ASCII:20160223124648
rename for        : /apps/dms/dms-metadata-updater/data/international_surface/import/mdicp4d</p>
<dl class="simple">
<dt>Usage:</dt><dd><p>flowcb sarracenia.flowcb.accept.renamewhatfn.RenameWhatFn</p>
</dd>
</dl>
<dl class="py class">
<dt class="sig sig-object py" id="sarracenia.flowcb.accept.renamewhatfn.RenameWhatFn">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sarracenia.flowcb.accept.renamewhatfn.</span></span><span class="sig-name descname"><span class="pre">RenameWhatFn</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">options</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sarracenia/flowcb/accept/renamewhatfn.html#RenameWhatFn"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sarracenia.flowcb.accept.renamewhatfn.RenameWhatFn" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#sarracenia.flowcb.FlowCB" title="sarracenia.flowcb.FlowCB"><code class="xref py py-class docutils literal notranslate"><span class="pre">FlowCB</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="sarracenia.flowcb.accept.renamewhatfn.RenameWhatFn.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">options</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sarracenia/flowcb/accept/renamewhatfn.html#RenameWhatFn.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sarracenia.flowcb.accept.renamewhatfn.RenameWhatFn.__init__" title="Link to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

</section>
<section id="module-sarracenia.flowcb.accept.save">
<span id="sarracenia-flowcb-accept-save"></span><h2><a class="toc-backref" href="#id16" role="doc-backlink">sarracenia.flowcb.accept.save</a><a class="headerlink" href="#module-sarracenia.flowcb.accept.save" title="Link to this heading"></a></h2>
<dl>
<dt>Plugin save.py:</dt><dd><p>Converts a consuming component into one that writes the queue into a file.
If there is some sort of problem with a component, then add callback save and restart.</p>
<p>The messages will accumulate in a save file in ~/.cache/&lt;component&gt;/&lt;config&gt;/ ??&lt;instance&gt;.save
When the situation is returned to normal (you want the component to process the data as normal):
* remove the callback save
* note the queue this configuration is using to read (should be in the log on startup.)
* run an sr_shovel with -restore_to_queue and the queue name.</p>
</dd>
<dt>Options:</dt><dd><p>save.py takes ‘msgSaveFile’ as an argument.
“_9999.sav” will be added to msgSaveFile, where the 9999 represents the instance number.
As instances run in parallel, rather than sychronizing access, just writes to one file per instance.</p>
</dd>
<dt>Usage:</dt><dd><p>callback accept.save
msgSaveFile x</p>
</dd>
</dl>
<dl class="py class">
<dt class="sig sig-object py" id="sarracenia.flowcb.accept.save.Save">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sarracenia.flowcb.accept.save.</span></span><span class="sig-name descname"><span class="pre">Save</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">options</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sarracenia/flowcb/accept/save.html#Save"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sarracenia.flowcb.accept.save.Save" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#sarracenia.flowcb.FlowCB" title="sarracenia.flowcb.FlowCB"><code class="xref py py-class docutils literal notranslate"><span class="pre">FlowCB</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="sarracenia.flowcb.accept.save.Save.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">options</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sarracenia/flowcb/accept/save.html#Save.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sarracenia.flowcb.accept.save.Save.__init__" title="Link to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

</section>
<section id="module-sarracenia.flowcb.accept.speedo">
<span id="sarracenia-flowcb-accept-speedo"></span><h2><a class="toc-backref" href="#id17" role="doc-backlink">sarracenia.flowcb.accept.speedo</a><a class="headerlink" href="#module-sarracenia.flowcb.accept.speedo" title="Link to this heading"></a></h2>
<dl class="simple">
<dt>Plugin speedo.py:</dt><dd><p>Gives a <em>speedometer</em> reading on the messages going through an exchange.
as this is an after_accept
Accumulate the number of messages and the bytes they represent over a period of time.</p>
</dd>
<dt>Options:</dt><dd><p>msgSpeedoInterval -&gt; how often the speedometer is updated. (default: 5)
msg_speedo_maxlag  -&gt; if the message flow indicates that messages are ‘late’, emit warnings. (default 60)</p>
</dd>
<dt>Usage:</dt><dd><p>callback accept.speedo
msgSpeedoInterval x
msg_speedo_maxlag y</p>
</dd>
</dl>
<dl class="py class">
<dt class="sig sig-object py" id="sarracenia.flowcb.accept.speedo.Speedo">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sarracenia.flowcb.accept.speedo.</span></span><span class="sig-name descname"><span class="pre">Speedo</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">options</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sarracenia/flowcb/accept/speedo.html#Speedo"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sarracenia.flowcb.accept.speedo.Speedo" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#sarracenia.flowcb.FlowCB" title="sarracenia.flowcb.FlowCB"><code class="xref py py-class docutils literal notranslate"><span class="pre">FlowCB</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="sarracenia.flowcb.accept.speedo.Speedo.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">options</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sarracenia/flowcb/accept/speedo.html#Speedo.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sarracenia.flowcb.accept.speedo.Speedo.__init__" title="Link to this definition"></a></dt>
<dd><p>set defaults for options.  can be overridden in config file.</p>
</dd></dl>

</dd></dl>

</section>
<section id="module-sarracenia.flowcb.accept.sundewpxroute">
<span id="sarracenia-flowcb-accept-sundewpxroute"></span><h2><a class="toc-backref" href="#id18" role="doc-backlink">sarracenia.flowcb.accept.sundewpxroute</a><a class="headerlink" href="#module-sarracenia.flowcb.accept.sundewpxroute" title="Link to this heading"></a></h2>
<dl class="simple">
<dt>Plugin sundewpxroute.py:</dt><dd><p>Implement message filtering based on a routing table from MetPX-Sundew.
Make it easier to feed clients exactly the same products with sarracenia,
that they are used to with sundew.</p>
</dd>
<dt>Usage:</dt><dd><p>the pxrouting option must be set in the configuration before the plugin
is configured, like so:
* pxRouting /local/home/peter/src/pdspx/routing/etc/pxRouting.conf
* pxClient  navcan-amis
flowcb sarracenia.flowcb.accept.sundewpxroute.SundewPxRoute</p>
</dd>
</dl>
<dl class="py class">
<dt class="sig sig-object py" id="sarracenia.flowcb.accept.sundewpxroute.SundewPxRoute">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sarracenia.flowcb.accept.sundewpxroute.</span></span><span class="sig-name descname"><span class="pre">SundewPxRoute</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">options</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sarracenia/flowcb/accept/sundewpxroute.html#SundewPxRoute"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sarracenia.flowcb.accept.sundewpxroute.SundewPxRoute" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#sarracenia.flowcb.FlowCB" title="sarracenia.flowcb.FlowCB"><code class="xref py py-class docutils literal notranslate"><span class="pre">FlowCB</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="sarracenia.flowcb.accept.sundewpxroute.SundewPxRoute.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">options</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sarracenia/flowcb/accept/sundewpxroute.html#SundewPxRoute.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sarracenia.flowcb.accept.sundewpxroute.SundewPxRoute.__init__" title="Link to this definition"></a></dt>
<dd><p>For World Meteorological Organization message oriented routing.
Read the configured metpx-sundew routing table, and figure out which
Abbreviated Header Lines (AHL’s) are configured to be sent to ‘target’
being careful to account for membership in clientAliases.</p>
<p>init sets ‘ahls_to_route’ according to the contents of pxrouting</p>
</dd></dl>

</dd></dl>

</section>
<section id="module-sarracenia.flowcb.accept.testretry">
<span id="sarracenia-flowcb-accept-testretry"></span><h2><a class="toc-backref" href="#id19" role="doc-backlink">sarracenia.flowcb.accept.testretry</a><a class="headerlink" href="#module-sarracenia.flowcb.accept.testretry" title="Link to this heading"></a></h2>
<dl class="simple">
<dt>Plugin testretry.py:</dt><dd><p>This changes the message randomly so that it will cause
a download or send an error.
When a message is being retried, it is randomly fixed</p>
</dd>
<dt>Usage:</dt><dd><p>flowcb sarracenia.flowcb.accept.testretry.TestRetry</p>
</dd>
</dl>
<dl class="py class">
<dt class="sig sig-object py" id="sarracenia.flowcb.accept.testretry.TestRetry">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sarracenia.flowcb.accept.testretry.</span></span><span class="sig-name descname"><span class="pre">TestRetry</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">options</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sarracenia/flowcb/accept/testretry.html#TestRetry"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sarracenia.flowcb.accept.testretry.TestRetry" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#sarracenia.flowcb.FlowCB" title="sarracenia.flowcb.FlowCB"><code class="xref py py-class docutils literal notranslate"><span class="pre">FlowCB</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="sarracenia.flowcb.accept.testretry.TestRetry.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">options</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sarracenia/flowcb/accept/testretry.html#TestRetry.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sarracenia.flowcb.accept.testretry.TestRetry.__init__" title="Link to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

</section>
<section id="module-sarracenia.flowcb.accept.toclusters">
<span id="sarracenia-flowcb-accept-toclusters"></span><h2><a class="toc-backref" href="#id20" role="doc-backlink">sarracenia.flowcb.accept.toclusters</a><a class="headerlink" href="#module-sarracenia.flowcb.accept.toclusters" title="Link to this heading"></a></h2>
<dl class="simple">
<dt>Plugin toclusters.py:</dt><dd><p>Implements inter-pump routing by filtering destinations.
This is placed on a sarra process copying data between pumps.
Whenever it gets a message, it looks at the destination and processing
only continues if it is beleived that that message is a valid destination for the local pump.</p>
</dd>
<dt>Options:</dt><dd><dl class="simple">
<dt>The local pump will select messages destined for the DD or DDI clusters, and reject those for DDSR, which isn’t in the list.</dt><dd><ul class="simple">
<li><p>msgToClusters DDI</p></li>
<li><p>msgToClusters DD</p></li>
</ul>
</dd>
</dl>
</dd>
<dt>Usage:</dt><dd><p>flowcb sarracenia.flowcb.accept.toclusters.ToClusters
msgToClusters x
msgToClusters y
…</p>
</dd>
</dl>
<dl class="py class">
<dt class="sig sig-object py" id="sarracenia.flowcb.accept.toclusters.ToClusters">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sarracenia.flowcb.accept.toclusters.</span></span><span class="sig-name descname"><span class="pre">ToClusters</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">options</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sarracenia/flowcb/accept/toclusters.html#ToClusters"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sarracenia.flowcb.accept.toclusters.ToClusters" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#sarracenia.flowcb.FlowCB" title="sarracenia.flowcb.FlowCB"><code class="xref py py-class docutils literal notranslate"><span class="pre">FlowCB</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="sarracenia.flowcb.accept.toclusters.ToClusters.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">options</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sarracenia/flowcb/accept/toclusters.html#ToClusters.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sarracenia.flowcb.accept.toclusters.ToClusters.__init__" title="Link to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

</section>
<section id="sarracenia-flowcb-accept-tohttp">
<h2><a class="toc-backref" href="#id21" role="doc-backlink">sarracenia.flowcb.accept.tohttp</a><a class="headerlink" href="#sarracenia-flowcb-accept-tohttp" title="Link to this heading"></a></h2>
</section>
<section id="sarracenia-flowcb-accept-tolocal">
<h2><a class="toc-backref" href="#id22" role="doc-backlink">sarracenia.flowcb.accept.tolocal</a><a class="headerlink" href="#sarracenia-flowcb-accept-tolocal" title="Link to this heading"></a></h2>
</section>
<section id="module-sarracenia.flowcb.accept.tolocalfile">
<span id="sarracenia-flowcb-accept-tolocalfile"></span><h2><a class="toc-backref" href="#id23" role="doc-backlink">sarracenia.flowcb.accept.tolocalfile</a><a class="headerlink" href="#module-sarracenia.flowcb.accept.tolocalfile" title="Link to this heading"></a></h2>
<dl>
<dt>Plugin tolocalfile.py:</dt><dd><p>This is a helper script to work with converters (filters) and senders.</p>
<p>What a data pump advertises, it will usually use Web URL, but if one is
on a server where the files are available, it is more efficient to access
them as local files, and so this plugin turn the message’s notice Web URL
into a File URL (<a class="reference external" href="file:/d1/d2/.../fn">file:/d1/d2/…/fn</a>)</p>
</dd>
<dt>Normal Usage:</dt><dd><p>A Web URL in an amqp message is hold in the following values:
message[‘baseUrl’] (ex.: <a class="reference external" href="http://localhost">http://localhost</a>)  and
message[‘relPath’] (ex.: /&lt;data&gt;/&lt;src&gt;/d3/…/fn)</p>
<p>We will save these values before their modification :
message[‘saved_baseUrl’] = message[‘baseUrl’]
message[‘saved_relPath’] = message[‘relPath’]</p>
<p>We will then turn them into an absolute File Url: (Note if a baseDir was set it prefix the relPath)
message[‘baseUrl’] = ‘file:’
message[‘relPath’] = [baseDir] + message[‘relPath’]</p>
</dd>
</dl>
<p class="rubric">Example</p>
<p>baseDir /var/www/html</p>
<p>message pubtime=20171003131233.494 baseUrl=http://localhost relPath=/20171003/CMOE/productx.gif</p>
<p>flowcb sarracenia.flowcb.accept.tolocalfile.ToLocalFile</p>
<p>will receive this::
* message[‘baseUrl’]  is  ‘<a class="reference external" href="http://localhost">http://localhost</a>’
* message[‘relPath’]  is  ‘/20171003/CMOE/GIF/productx.gif’</p>
<ul class="simple">
<li><p>will copy/save these values</p></li>
<li><p>message[‘saved_baseUrl’] = message[‘baseUrl’]</p></li>
<li><p>message[‘saved_relPath’] = message[‘relPath’]</p></li>
<li><p>turn the original values into a File URL</p></li>
<li><p>message[‘baseUrl’] = ‘file:’</p></li>
<li><p>if parent[‘baseDir’] :
*  message[‘relPath’] = parent[‘baseDir’] + ‘/’ + message[‘relPath’]
*  message[‘relPath’] = message[‘relPath’].replace(‘//’,’/’)</p></li>
</ul>
<p>A sequence of after_accept plugins can perform various changes to the messages and/or
to the product…  so here lets pretend we have an after_accept plugin that converts
gif to png  and prepares the proper message for it</p>
<p>flowcb sarracenia.flowcb.accept.giftopng.GifToPng
After the tolocalfile this script could perform something like:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># build the absolute path of the png product</span>
<span class="n">new_path</span> <span class="o">=</span> <span class="n">message</span><span class="p">[</span><span class="s1">&#39;relPath&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;GIF&#39;</span><span class="p">,</span><span class="s1">&#39;PNG&#39;</span><span class="p">)</span>
<span class="n">new_path</span><span class="p">[</span><span class="o">-</span><span class="mi">4</span><span class="p">:]</span> <span class="o">=</span> <span class="s1">&#39;.png&#39;</span>

<span class="c1"># proceed to the conversion gif2png</span>
<span class="n">ok</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gif2png</span><span class="p">(</span><span class="n">gifpath</span><span class="o">=</span><span class="n">message</span><span class="o">.</span><span class="n">relPath</span><span class="p">,</span><span class="n">pngpath</span><span class="o">=</span><span class="n">new_path</span><span class="p">)</span>
</pre></div>
</div>
<p>change the message to announce the new png product:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">if</span> <span class="n">ok</span> <span class="p">:</span>
    <span class="n">message</span><span class="p">[</span><span class="s1">&#39;baseUrl&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">message</span><span class="p">[</span><span class="s1">&#39;saved_baseUrl&#39;</span><span class="p">]</span>
<span class="n">message</span><span class="p">[</span><span class="s1">&#39;relPath&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">new_path</span>
<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">o</span><span class="o">.</span><span class="n">baseDir</span> <span class="p">:</span>
    <span class="n">message</span><span class="p">[</span><span class="s1">&#39;relPath&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">new_path</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">o</span><span class="o">.</span><span class="n">baseDir</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="k">else</span> <span class="p">:</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="o">...</span>
<span class="c1"># we are ok... proceed with this png file</span>
</pre></div>
</div>
<dl class="simple">
<dt>Usage:</dt><dd><p>flowcb sarracenia.flowcb.accept.tolocalfile.ToLocalFile</p>
</dd>
</dl>
<dl class="py class">
<dt class="sig sig-object py" id="sarracenia.flowcb.accept.tolocalfile.ToLocalFile">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sarracenia.flowcb.accept.tolocalfile.</span></span><span class="sig-name descname"><span class="pre">ToLocalFile</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">options</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sarracenia/flowcb/accept/tolocalfile.html#ToLocalFile"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sarracenia.flowcb.accept.tolocalfile.ToLocalFile" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#sarracenia.flowcb.FlowCB" title="sarracenia.flowcb.FlowCB"><code class="xref py py-class docutils literal notranslate"><span class="pre">FlowCB</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="sarracenia.flowcb.accept.tolocalfile.ToLocalFile.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">options</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sarracenia/flowcb/accept/tolocalfile.html#ToLocalFile.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sarracenia.flowcb.accept.tolocalfile.ToLocalFile.__init__" title="Link to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

</section>
<section id="module-sarracenia.flowcb.accept.wmotypesuffix">
<span id="sarracenia-flowcb-accept-wmotypesuffix"></span><h2><a class="toc-backref" href="#id24" role="doc-backlink">sarracenia.flowcb.accept.wmotypesuffix</a><a class="headerlink" href="#module-sarracenia.flowcb.accept.wmotypesuffix" title="Link to this heading"></a></h2>
<dl>
<dt>Plugin wmotypesuffix.py:</dt><dd><p>Given the WMO-386 TT designator of a WMO file, file type suffix to the file name.
Web browsers and modern operating systems may do <em>the right thing</em> if files have a recognizable suffix.</p>
<p><a class="reference external" href="http://www.wmo.int/pages/prog/www/ois/Operational_Information/Publications/WMO_386/AHLsymbols/TableA.html">http://www.wmo.int/pages/prog/www/ois/Operational_Information/Publications/WMO_386/AHLsymbols/TableA.html</a></p>
<p>Status: proof of concept demonstrator… missing many TT’s. please add!
Tested with UNIDATA feeds, discrepancies:
TableA says L is Aviation XML, but UNIDATA Feed, it is all GRIB.
XW - should be CAP, but is GRIB.
IX used by Americans for HDF, unsure if that is kosher/halal/blessed, but it is in the UNIDATA feed.</p>
<p>IU/IS/IB are BUFR
other type designators welcome… for example, GRIB isn’t identified yet.
default to .txt.</p>
</dd>
<dt>Usage:</dt><dd><p>flowcb sarracenia.flowcb.accept.wmotypesuffix.WmoTypeSuffix</p>
</dd>
</dl>
<dl class="py class">
<dt class="sig sig-object py" id="sarracenia.flowcb.accept.wmotypesuffix.WmoTypeSuffix">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sarracenia.flowcb.accept.wmotypesuffix.</span></span><span class="sig-name descname"><span class="pre">WmoTypeSuffix</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">options</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sarracenia/flowcb/accept/wmotypesuffix.html#WmoTypeSuffix"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sarracenia.flowcb.accept.wmotypesuffix.WmoTypeSuffix" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#sarracenia.flowcb.FlowCB" title="sarracenia.flowcb.FlowCB"><code class="xref py py-class docutils literal notranslate"><span class="pre">FlowCB</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="sarracenia.flowcb.accept.wmotypesuffix.WmoTypeSuffix.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">options</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sarracenia/flowcb/accept/wmotypesuffix.html#WmoTypeSuffix.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sarracenia.flowcb.accept.wmotypesuffix.WmoTypeSuffix.__init__" title="Link to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

</section>
<section id="module-sarracenia.flowcb.clamav">
<span id="sarracenia-flowcb-clamav"></span><h2><a class="toc-backref" href="#id25" role="doc-backlink">sarracenia.flowcb.clamav</a><a class="headerlink" href="#module-sarracenia.flowcb.clamav" title="Link to this heading"></a></h2>
<p>A sample on_part plugin to perform virus scanning, using the ClamAV engine.</p>
<p>requires a clamd binding package to be installed. On debian derived systems:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sudo</span> <span class="n">apt</span><span class="o">-</span><span class="n">get</span> <span class="n">install</span> <span class="n">python3</span><span class="o">-</span><span class="n">pyclamd</span>
</pre></div>
</div>
<p>on others:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pip3</span> <span class="n">install</span> <span class="n">pyclamd</span>
</pre></div>
</div>
<p>author: Peter Silva</p>
<dl class="py class">
<dt class="sig sig-object py" id="sarracenia.flowcb.clamav.Clamav">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sarracenia.flowcb.clamav.</span></span><span class="sig-name descname"><span class="pre">Clamav</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">options</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sarracenia/flowcb/clamav.html#Clamav"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sarracenia.flowcb.clamav.Clamav" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#sarracenia.flowcb.FlowCB" title="sarracenia.flowcb.FlowCB"><code class="xref py py-class docutils literal notranslate"><span class="pre">FlowCB</span></code></a></p>
<p>Invoke ClamAV anti-virus scanning on files as they pass through a data pump.
when it is invoked depends on the component it is used from.</p>
<p>from a sender, post, or poll, the scan should stop processing prior
to the transfer.</p>
<p>for other components, subsscribers that download, it needs to take place
after downloading.</p>
<dl class="py method">
<dt class="sig sig-object py" id="sarracenia.flowcb.clamav.Clamav.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">options</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="../_modules/sarracenia/flowcb/clamav.html#Clamav.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sarracenia.flowcb.clamav.Clamav.__init__" title="Link to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

</section>
<section id="module-sarracenia.flowcb.destfn.sample">
<span id="sarracenia-flowcb-destfn-sample"></span><h2><a class="toc-backref" href="#id26" role="doc-backlink">sarracenia.flowcb.destfn.sample</a><a class="headerlink" href="#module-sarracenia.flowcb.destfn.sample" title="Link to this heading"></a></h2>
<p>a destfn plugin script is used by senders or subscribers to do complex file naming.
this is an API demonstrator that prefixes the name delivered with ‘renamed_’:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">filename</span> <span class="n">DESTFNSCRIPT</span><span class="o">=</span><span class="n">sarracenia</span><span class="o">.</span><span class="n">flowcb</span><span class="o">.</span><span class="n">destfn</span><span class="o">.</span><span class="n">sample</span><span class="o">.</span><span class="n">Sample</span>
</pre></div>
</div>
<p>An alternative method of invocation is to apply it selectively:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">accept</span> <span class="n">k</span><span class="o">*</span> <span class="n">DESTFNSCRIPT</span><span class="o">=</span><span class="n">sarracenia</span><span class="o">.</span><span class="n">flowcb</span><span class="o">.</span><span class="n">destfn</span><span class="o">.</span><span class="n">sample</span><span class="o">.</span><span class="n">Sample</span>
</pre></div>
</div>
<p>As with other flowcb plugins, the import will be done using normal
python import mechanism equivalent to:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">sarracenia.flowcb.destfn.sample</span>
</pre></div>
</div>
<p>and then in that class file, there is a Sample class, the sample class
contains the destfn method, or entry_point.</p>
<p>The destfn routine consults the fields in the given message, and based on them,
return a new file name for the file to have after transfer (download or send.)</p>
<p>the routines have access to the settings via options provided to init,
accessed, by convention, as self.o.</p>
<p>The routine can also modify fields create new ones in the message.</p>
<p>the destfn routine returns the new name of the file.</p>
<dl class="py class">
<dt class="sig sig-object py" id="sarracenia.flowcb.destfn.sample.Sample">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sarracenia.flowcb.destfn.sample.</span></span><span class="sig-name descname"><span class="pre">Sample</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">options</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">class_logger</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sarracenia/flowcb/destfn/sample.html#Sample"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sarracenia.flowcb.destfn.sample.Sample" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#sarracenia.flowcb.FlowCB" title="sarracenia.flowcb.FlowCB"><code class="xref py py-class docutils literal notranslate"><span class="pre">FlowCB</span></code></a></p>
</dd></dl>

</section>
<section id="module-sarracenia.flowcb.filter">
<span id="sarracenia-flowcb-filter"></span><h2><a class="toc-backref" href="#id27" role="doc-backlink">sarracenia.flowcb.filter</a><a class="headerlink" href="#module-sarracenia.flowcb.filter" title="Link to this heading"></a></h2>
<p>a module that is focused on transforming data should be called a filter.
Filter plugins intended for after_accept(self, worklist) entry_point.</p>
<p>At that point:
Messages have been gathered, then passed through the accept and reject pattern matches.
One of the first callbacks is the nodupe, so that duplicate suppression may cause additional
rejections.</p>
</section>
<section id="module-sarracenia.flowcb.filter.deleteflowfiles">
<span id="sarracenia-flowcb-filter-deleteflowfiles"></span><h2><a class="toc-backref" href="#id28" role="doc-backlink">sarracenia.flowcb.filter.deleteflowfiles</a><a class="headerlink" href="#module-sarracenia.flowcb.filter.deleteflowfiles" title="Link to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="sarracenia.flowcb.filter.deleteflowfiles.DeleteFlowFiles">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sarracenia.flowcb.filter.deleteflowfiles.</span></span><span class="sig-name descname"><span class="pre">DeleteFlowFiles</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">options</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">class_logger</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sarracenia/flowcb/filter/deleteflowfiles.html#DeleteFlowFiles"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sarracenia.flowcb.filter.deleteflowfiles.DeleteFlowFiles" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#sarracenia.flowcb.FlowCB" title="sarracenia.flowcb.FlowCB"><code class="xref py py-class docutils literal notranslate"><span class="pre">FlowCB</span></code></a></p>
<p>This is a custom callback class for the sr_insects flow tests.
delete files for messages in two directories.</p>
</dd></dl>

</section>
<section id="module-sarracenia.flowcb.filter.fdelay">
<span id="sarracenia-flowcb-filter-fdelay"></span><h2><a class="toc-backref" href="#id29" role="doc-backlink">sarracenia.flowcb.filter.fdelay</a><a class="headerlink" href="#module-sarracenia.flowcb.filter.fdelay" title="Link to this heading"></a></h2>
<p>This plugin delays processing of messages by <em>message_delay</em> seconds</p>
<p>sarracenia.flowcb.msg.fdelay 30
import sarracenia.flowcb.filter.fdelay.Fdelay</p>
<p>or more simply:</p>
<p>fdelay 30
callback filter.fdelay</p>
<p>every message will be at least 30 seconds old before it is forwarded by this plugin.
in the meantime, the message is placed on the retry queue by marking it as failed.</p>
<dl class="py class">
<dt class="sig sig-object py" id="sarracenia.flowcb.filter.fdelay.Fdelay">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sarracenia.flowcb.filter.fdelay.</span></span><span class="sig-name descname"><span class="pre">Fdelay</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">options</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sarracenia/flowcb/filter/fdelay.html#Fdelay"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sarracenia.flowcb.filter.fdelay.Fdelay" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#sarracenia.flowcb.FlowCB" title="sarracenia.flowcb.FlowCB"><code class="xref py py-class docutils literal notranslate"><span class="pre">FlowCB</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="sarracenia.flowcb.filter.fdelay.Fdelay.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">options</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sarracenia/flowcb/filter/fdelay.html#Fdelay.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sarracenia.flowcb.filter.fdelay.Fdelay.__init__" title="Link to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

</section>
<section id="module-sarracenia.flowcb.filter.pclean_f90">
<span id="sarracenia-flowcb-filter-pclean-f90"></span><h2><a class="toc-backref" href="#id30" role="doc-backlink">sarracenia.flowcb.filter.pclean_f90</a><a class="headerlink" href="#module-sarracenia.flowcb.filter.pclean_f90" title="Link to this heading"></a></h2>
<p>msg_pclean_f90 module: file propagation test for Sarracenia components (in flow test)
<a class="reference external" href="https://github.com/MetPX/sr_insects/">https://github.com/MetPX/sr_insects/</a></p>
<dl class="py class">
<dt class="sig sig-object py" id="sarracenia.flowcb.filter.pclean_f90.PClean_F90">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sarracenia.flowcb.filter.pclean_f90.</span></span><span class="sig-name descname"><span class="pre">PClean_F90</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">options</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sarracenia/flowcb/filter/pclean_f90.html#PClean_F90"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sarracenia.flowcb.filter.pclean_f90.PClean_F90" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#sarracenia.flowcb.pclean.PClean" title="sarracenia.flowcb.pclean.PClean"><code class="xref py py-class docutils literal notranslate"><span class="pre">PClean</span></code></a></p>
<blockquote>
<div><p>functionality within the flow_tests of the sr_insects project.
This plugin class receive a msg from xflow_public and check propagation of the underlying file</p>
<ul class="simple">
<li><p>it checks if the propagation was ok</p></li>
<li><p>it randomly set a new test file with a different type in the watch dir (f31 amqp)</p></li>
<li><p>it posts the product to be treated by f92</p></li>
<li><p>when the msg for the extension file comes back, recheck the propagation</p></li>
</ul>
</div></blockquote>
<p>When a product is not fully propagated, the error is reported and the test is considered as a
failure. It also checks if the file differs from original</p>
</dd></dl>

</section>
<section id="module-sarracenia.flowcb.filter.pclean_f92">
<span id="sarracenia-flowcb-filter-pclean-f92"></span><h2><a class="toc-backref" href="#id31" role="doc-backlink">sarracenia.flowcb.filter.pclean_f92</a><a class="headerlink" href="#module-sarracenia.flowcb.filter.pclean_f92" title="Link to this heading"></a></h2>
<p>msg_pclean_f90 module: second file propagation test for Sarracenia components (in flow test)</p>
<dl class="py class">
<dt class="sig sig-object py" id="sarracenia.flowcb.filter.pclean_f92.PClean_F92">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sarracenia.flowcb.filter.pclean_f92.</span></span><span class="sig-name descname"><span class="pre">PClean_F92</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">options</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sarracenia/flowcb/filter/pclean_f92.html#PClean_F92"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sarracenia.flowcb.filter.pclean_f92.PClean_F92" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#sarracenia.flowcb.pclean.PClean" title="sarracenia.flowcb.pclean.PClean"><code class="xref py py-class docutils literal notranslate"><span class="pre">PClean</span></code></a></p>
<p>This plugin that manage the removal of every file</p>
<ul class="simple">
<li><p>it fails if one removal failed</p></li>
</ul>
</dd></dl>

</section>
<section id="module-sarracenia.flowcb.filter.wmo2msc">
<span id="sarracenia-flowcb-filter-wmo2msc"></span><h2><a class="toc-backref" href="#id32" role="doc-backlink">sarracenia.flowcb.filter.wmo2msc</a><a class="headerlink" href="#module-sarracenia.flowcb.filter.wmo2msc" title="Link to this heading"></a></h2>
<p>wmo2msc.py is an on_message plugin script to convert WMO bulletins on local disk
to MSC internal format in an alternate tree.  It is analogous to Sundew’s ‘bulletin-file’.
Meant to be called as an sr_shovel plugin.</p>
<p>It prints an output line:</p>
<p>wmo2msc: &lt;input_file&gt; -&gt; &lt;output_file&gt; (&lt;detected format&gt;)</p>
<p>usage:</p>
<p>Use the directory setting to know the root of tree where files are placed.
FIXME: well, likely what you really what is something like:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">date</span><span class="o">&gt;/&lt;</span><span class="n">source</span><span class="o">&gt;/</span><span class="n">dir1</span><span class="o">/</span><span class="n">dir2</span><span class="o">/</span><span class="n">dir3</span>

<span class="o">&lt;</span><span class="n">date</span><span class="o">&gt;/&lt;</span><span class="n">source</span><span class="o">&gt;/</span><span class="n">dir1</span><span class="o">/</span><span class="n">dir2</span><span class="o">/</span><span class="n">newdir4</span><span class="o">/...</span>

<span class="o">--</span> <span class="n">so</span> <span class="n">Directory</span> <span class="n">doesn</span><span class="s1">&#39;t cut it.</span>
</pre></div>
</div>
<p>In a sr_shovel configuration:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">directory</span> <span class="o">/....</span>
<span class="n">callback</span> <span class="nb">filter</span><span class="o">.</span><span class="n">wmo2msc</span>
</pre></div>
</div>
<p>Parameters:</p>
<ul>
<li><p>filter_wmo2msc_replace_dir  old,new</p></li>
<li><p>filter_wmo2msc_uniquify hash|time|anything else
- whether to add a string in addition to the AHL to make the filename unique.
- hash - means apply a hash, so that the additional string is content based.
- if time, add a suffix _YYYYMMDDHHMMSS_99999 which ensures file name uniqueness.
- otherwise, no suffix will be added.
- default: hash</p></li>
<li><p>filter_wmo2msc_convert on|off
if on, then traditional conversion to MSC-BULLETINS is done as per TANDEM/APPS &amp; MetPX Sundew
this involves n as termination character, and other charater substitutions.</p></li>
<li><p>filter_wmo2msc_tree  on|off
if tree is off, files are just placed in destination directory.
if tree is on, then the file is placed in a subdirectory tree, based on
the WMO 386 AHL:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">TTAAii</span> <span class="n">CCCC</span> <span class="n">YYGGgg</span>  <span class="p">(</span> <span class="n">example</span><span class="p">:</span> <span class="n">SACN37</span> <span class="n">CWAO</span> <span class="mi">300104</span> <span class="p">)</span>

<span class="n">TT</span> <span class="o">=</span> <span class="n">SA</span> <span class="o">-</span> <span class="n">surface</span> <span class="n">observation</span><span class="o">.</span>
<span class="n">AA</span> <span class="o">=</span> <span class="n">CN</span> <span class="o">-</span> <span class="n">Canada</span> <span class="p">(</span> <span class="n">but</span> <span class="n">the</span> <span class="n">AA</span> <span class="n">depends</span> <span class="n">on</span> <span class="n">TT</span> <span class="n">value</span><span class="p">,</span> <span class="ow">in</span> <span class="n">many</span> <span class="n">cases</span> <span class="ow">not</span> <span class="n">a</span> <span class="n">national</span> <span class="n">code</span><span class="o">.</span> <span class="p">)</span>
<span class="n">ii</span> <span class="o">=</span> <span class="mi">37</span> <span class="o">-</span> <span class="n">a</span> <span class="n">number</span><span class="o">..</span> <span class="n">there</span> <span class="n">are</span> <span class="n">various</span> <span class="n">conventions</span><span class="p">,</span> <span class="n">they</span> <span class="n">are</span> <span class="n">picked</span> <span class="n">to</span> <span class="n">avoid</span> <span class="n">duplication</span><span class="o">.</span>
</pre></div>
</div>
<p>The first line of the file is expected to contain an AHL. and when we build a tree
from it, we build it as follows:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">TT</span><span class="o">/</span><span class="n">CCCC</span><span class="o">/</span><span class="n">GG</span><span class="o">/</span><span class="n">TTAAii_CCCC_YYGGgg_</span><span class="o">&lt;</span><span class="n">uniquify</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>assuming tree=on, uniquify=hash:</p>
<blockquote>
<div><p>SA/CWAO/01/SACN37_CWAO_300104_1c699da91817cc4a84ab19ee4abe4e22</p>
</div></blockquote>
</li>
</ul>
<dl class="simple">
<dt>NOTE: Look at the end of the file for SUPPLEMENTARY INFORMATION</dt><dd><p>including hints about debugging.</p>
</dd>
</dl>
<dl class="py class">
<dt class="sig sig-object py" id="sarracenia.flowcb.filter.wmo2msc.Wmo2msc">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sarracenia.flowcb.filter.wmo2msc.</span></span><span class="sig-name descname"><span class="pre">Wmo2msc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">options</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sarracenia/flowcb/filter/wmo2msc.html#Wmo2msc"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sarracenia.flowcb.filter.wmo2msc.Wmo2msc" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#sarracenia.flowcb.FlowCB" title="sarracenia.flowcb.FlowCB"><code class="xref py py-class docutils literal notranslate"><span class="pre">FlowCB</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="sarracenia.flowcb.filter.wmo2msc.Wmo2msc.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">options</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sarracenia/flowcb/filter/wmo2msc.html#Wmo2msc.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sarracenia.flowcb.filter.wmo2msc.Wmo2msc.__init__" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sarracenia.flowcb.filter.wmo2msc.Wmo2msc.doSpecificProcessing">
<span class="sig-name descname"><span class="pre">doSpecificProcessing</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sarracenia/flowcb/filter/wmo2msc.html#Wmo2msc.doSpecificProcessing"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sarracenia.flowcb.filter.wmo2msc.Wmo2msc.doSpecificProcessing" title="Link to this definition"></a></dt>
<dd><p>Modify bulletins received from Washington via the WMO socket protocol.
started as a direct copy from sundew of routine with same name in bulletinManagerWmo.py</p>
<ul class="simple">
<li><p>encode/decode, and binary stuff came because of python3</p></li>
</ul>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sarracenia.flowcb.filter.wmo2msc.Wmo2msc.replaceChar">
<span class="sig-name descname"><span class="pre">replaceChar</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">oldchar</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">newchar</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sarracenia/flowcb/filter/wmo2msc.html#Wmo2msc.replaceChar"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sarracenia.flowcb.filter.wmo2msc.Wmo2msc.replaceChar" title="Link to this definition"></a></dt>
<dd><p>replace all occurrences of oldchar by newchar in the the message byte stream.
started as a direct copy from sundew of routine with same name in bulletin.py
- the storage model is a bit different, we store the entire message as one bytearray.
- sundew stored it as a series of lines, so replaceChar implementation changed.</p>
</dd></dl>

</dd></dl>

</section>
<section id="module-sarracenia.flowcb.gather">
<span id="sarracenia-flowcb-gather"></span><h2><a class="toc-backref" href="#id33" role="doc-backlink">sarracenia.flowcb.gather</a><a class="headerlink" href="#module-sarracenia.flowcb.gather" title="Link to this heading"></a></h2>
<dl class="py data">
<dt class="sig sig-object py" id="sarracenia.flowcb.gather.logger">
<span class="sig-prename descclassname"><span class="pre">sarracenia.flowcb.gather.</span></span><span class="sig-name descname"><span class="pre">logger</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">&lt;Logger</span> <span class="pre">sarracenia.flowcb.gather</span> <span class="pre">(WARNING)&gt;</span></em><a class="headerlink" href="#sarracenia.flowcb.gather.logger" title="Link to this definition"></a></dt>
<dd><p>This file was originally a place holder… thought this was not needed, then there was a stack trace.
and setup.py gets leaves the directory out if not present.</p>
<p>then started finding this convenient for common routines.</p>
</dd></dl>

</section>
<section id="module-sarracenia.flowcb.gather.file">
<span id="sarracenia-flowcb-gather-file"></span><h2><a class="toc-backref" href="#id34" role="doc-backlink">sarracenia.flowcb.gather.file</a><a class="headerlink" href="#module-sarracenia.flowcb.gather.file" title="Link to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="sarracenia.flowcb.gather.file.File">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sarracenia.flowcb.gather.file.</span></span><span class="sig-name descname"><span class="pre">File</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">options</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sarracenia/flowcb/gather/file.html#File"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sarracenia.flowcb.gather.file.File" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#sarracenia.flowcb.FlowCB" title="sarracenia.flowcb.FlowCB"><code class="xref py py-class docutils literal notranslate"><span class="pre">FlowCB</span></code></a></p>
<p>read the file system, create messages for the files you find.</p>
<p>this is taken from v2’s sr_post.py</p>
<p>FIXME FIXME FIXME
FIXME: the sr_post version would post files on the fly as it was traversing trees.
so it was incremental and had little overhead. This one is does the whole recursion
in one gather.</p>
<p>It will fail horribly for large trees. Need to re-formulate to replace recursion with interation.
perhaps a good time to use python iterators.</p>
<p>also should likely switch from listdir to scandir</p>
<dl class="py method">
<dt class="sig sig-object py" id="sarracenia.flowcb.gather.file.File.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">options</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sarracenia/flowcb/gather/file.html#File.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sarracenia.flowcb.gather.file.File.__init__" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sarracenia.flowcb.gather.file.File.gather">
<span class="sig-name descname"><span class="pre">gather</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">messageCountMax</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sarracenia/flowcb/gather/file.html#File.gather"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sarracenia.flowcb.gather.file.File.gather" title="Link to this definition"></a></dt>
<dd><p>from sr_post.py/run</p>
<p>FIXME: really bad performance with large trees: It scans an entire tree
before emitting any messages. Need to re-factor with iterator style so produce
result in batch sized chunks incrementally.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sarracenia.flowcb.gather.file.File.post1file">
<span class="sig-name descname"><span class="pre">post1file</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lstat</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">is_directory</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">list</span></span></span><a class="reference internal" href="../_modules/sarracenia/flowcb/gather/file.html#File.post1file"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sarracenia.flowcb.gather.file.File.post1file" title="Link to this definition"></a></dt>
<dd><p>create the notification message for a single file, based on the lstat metadata.</p>
<p>when lstat is present it is used to decide whether the file is an ordinary file, a link
or a directory, and the appropriate message is built and returned.</p>
<p>if the lstat metadata is None, then that signifies a “remove” message to be created.
In the remove case, without the lstat, one needs the is_directory flag to decide whether
it is an ordinary file remove, or a directory remove.   is_directory is not used other
than for the remove case.</p>
<p>The return value is a list that usually contains a single message.  It is a list to allow
for if options are combined such that a symbolic link and the realpath it posts to may
involve multiple messages for a single file. Similarly in the multi-block transfer case.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sarracenia.flowcb.gather.file.File.process_event">
<span class="sig-name descname"><span class="pre">process_event</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">event</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">src</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dst</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sarracenia/flowcb/gather/file.html#File.process_event"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sarracenia.flowcb.gather.file.File.process_event" title="Link to this definition"></a></dt>
<dd><p>return a tuple: pop? + list of messages.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sarracenia.flowcb.gather.file.File.walk">
<span class="sig-name descname"><span class="pre">walk</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">src</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sarracenia/flowcb/gather/file.html#File.walk"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sarracenia.flowcb.gather.file.File.walk" title="Link to this definition"></a></dt>
<dd><p>walk directory tree returning 1 message for each file in it.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sarracenia.flowcb.gather.file.File.walk_priming">
<span class="sig-name descname"><span class="pre">walk_priming</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">p</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sarracenia/flowcb/gather/file.html#File.walk_priming"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sarracenia.flowcb.gather.file.File.walk_priming" title="Link to this definition"></a></dt>
<dd><p>Find all the subdirectories of the given path, start watches on them.
deal with symbolically linked directories correctly</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="sarracenia.flowcb.gather.file.SimpleEventHandler">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sarracenia.flowcb.gather.file.</span></span><span class="sig-name descname"><span class="pre">SimpleEventHandler</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">parent</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sarracenia/flowcb/gather/file.html#SimpleEventHandler"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sarracenia.flowcb.gather.file.SimpleEventHandler" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">PatternMatchingEventHandler</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="sarracenia.flowcb.gather.file.SimpleEventHandler.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">parent</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sarracenia/flowcb/gather/file.html#SimpleEventHandler.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sarracenia.flowcb.gather.file.SimpleEventHandler.__init__" title="Link to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

</section>
<section id="module-sarracenia.flowcb.gather.message">
<span id="sarracenia-flowcb-gather-message"></span><h2><a class="toc-backref" href="#id35" role="doc-backlink">sarracenia.flowcb.gather.message</a><a class="headerlink" href="#module-sarracenia.flowcb.gather.message" title="Link to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="sarracenia.flowcb.gather.message.Message">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sarracenia.flowcb.gather.message.</span></span><span class="sig-name descname"><span class="pre">Message</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">options</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sarracenia/flowcb/gather/message.html#Message"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sarracenia.flowcb.gather.message.Message" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#sarracenia.flowcb.FlowCB" title="sarracenia.flowcb.FlowCB"><code class="xref py py-class docutils literal notranslate"><span class="pre">FlowCB</span></code></a></p>
<p>gather messages from a sarracenia.moth message queuing protocol source.</p>
<dl class="py method">
<dt class="sig sig-object py" id="sarracenia.flowcb.gather.message.Message.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">options</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="../_modules/sarracenia/flowcb/gather/message.html#Message.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sarracenia.flowcb.gather.message.Message.__init__" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sarracenia.flowcb.gather.message.Message.gather">
<span class="sig-name descname"><span class="pre">gather</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">messageCountMax</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">list</span></span></span><a class="reference internal" href="../_modules/sarracenia/flowcb/gather/message.html#Message.gather"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sarracenia.flowcb.gather.message.Message.gather" title="Link to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>a list of messages obtained from this source.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>True … you can gather from other sources. and</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-sarracenia.flowcb.housekeeping">
<span id="sarracenia-flowcb-housekeeping"></span><h2><a class="toc-backref" href="#id36" role="doc-backlink">sarracenia.flowcb.housekeeping</a><a class="headerlink" href="#module-sarracenia.flowcb.housekeeping" title="Link to this heading"></a></h2>
<p>plugins intended for on_message entry_point.</p>
<p>(when messages are received.)</p>
</section>
<section id="module-sarracenia.flowcb.housekeeping.resources">
<span id="sarracenia-flowcb-housekeeping-resources"></span><h2><a class="toc-backref" href="#id37" role="doc-backlink">sarracenia.flowcb.housekeeping.resources</a><a class="headerlink" href="#module-sarracenia.flowcb.housekeeping.resources" title="Link to this heading"></a></h2>
<p>Default on_housekeeping handler that:
- Logs Memory and CPU usage.
- Restarts components to deal with memory leaks.</p>
<p>If <cite>MemoryMax</cite> is not in the config, it is automatically calculated with the following procedure:</p>
<ol class="arabic simple">
<li><p>The plugin processes the first <cite>MemoryBaseLineFile</cite> items to reach a steady state.
- Subscribers process messages-in
- Posting programs process messages-posted</p></li>
<li><p>Set <cite>MemoryMax</cite> threshold to <cite>MemoryMultiplier</cite> * (memory usage at time steady state)</p></li>
</ol>
<p>If memory use ever exceeds the <cite>MemoryMax</cite> threshold, then the plugin triggers a restart, reducing memory consumption.</p>
<p>Parameters:</p>
<dl class="simple">
<dt>MemoryMax<span class="classifier">size (default: none)</span></dt><dd><p>Hard coded maximum for tolerable memory consumption.
Must be suffixed with k/m/g for Kilo/Mega/Giga byte values.
If not set then the following options will have an effect:</p>
</dd>
<dt>MemoryBaseLineFile<span class="classifier">int, optional (default: 100)</span></dt><dd><p>How many files to process before measuring to establish the baseline memory usage.
(how many files are expected to process before a steady state is reached)</p>
</dd>
<dt>MemoryMultiplier<span class="classifier">int, optional (default: 3)</span></dt><dd><p>How many times past the steady state memory footprint you want to allow the component to grow before restarting.
It could be normal for memory usage to grow, especially if plugins store data in memory.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Nothing, restarts components if memory usage is outside of configured thresholds.</p>
</dd>
</dl>
<dl class="py class">
<dt class="sig sig-object py" id="sarracenia.flowcb.housekeeping.resources.Resources">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sarracenia.flowcb.housekeeping.resources.</span></span><span class="sig-name descname"><span class="pre">Resources</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">options</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sarracenia/flowcb/housekeeping/resources.html#Resources"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sarracenia.flowcb.housekeeping.resources.Resources" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#sarracenia.flowcb.FlowCB" title="sarracenia.flowcb.FlowCB"><code class="xref py py-class docutils literal notranslate"><span class="pre">FlowCB</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="sarracenia.flowcb.housekeeping.resources.Resources.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">options</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sarracenia/flowcb/housekeeping/resources.html#Resources.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sarracenia.flowcb.housekeeping.resources.Resources.__init__" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sarracenia.flowcb.housekeeping.resources.Resources.restart">
<span class="sig-name descname"><span class="pre">restart</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sarracenia/flowcb/housekeeping/resources.html#Resources.restart"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sarracenia.flowcb.housekeeping.resources.Resources.restart" title="Link to this definition"></a></dt>
<dd><p>Do an in-place restart of the current process (keeps pid).
Gets a new memory stack/heap, keeps all file descriptors but replaces the buffers.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="sarracenia.flowcb.housekeeping.resources.Resources.threshold">
<span class="sig-name descname"><span class="pre">threshold</span></span><a class="headerlink" href="#sarracenia.flowcb.housekeeping.resources.Resources.threshold" title="Link to this definition"></a></dt>
<dd><p>Per-process maximum memory footprint that is considered too large, forcing a process restart.</p>
</dd></dl>

</dd></dl>

</section>
<section id="module-sarracenia.flowcb.log">
<span id="sarracenia-flowcb-log"></span><h2><a class="toc-backref" href="#id38" role="doc-backlink">sarracenia.flowcb.log</a><a class="headerlink" href="#module-sarracenia.flowcb.log" title="Link to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="sarracenia.flowcb.log.Log">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sarracenia.flowcb.log.</span></span><span class="sig-name descname"><span class="pre">Log</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">options</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sarracenia/flowcb/log.html#Log"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sarracenia.flowcb.log.Log" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#sarracenia.flowcb.FlowCB" title="sarracenia.flowcb.FlowCB"><code class="xref py py-class docutils literal notranslate"><span class="pre">FlowCB</span></code></a></p>
<p>The logging flow callback class.
logs message at the indicated time. Controlled by:</p>
<p>logEvents - which entry points to emit log messages at.</p>
<p>logMessageDump - print literal messages when printing log messages.</p>
<p>every housekeeping interval, prints:</p>
<ul class="simple">
<li><p>how many messages were received, rejected, %accepted.</p></li>
<li><p>number of files transferred, their size, and rate in files/s and bytes/s</p></li>
<li><p>lag: some information about how old the messages are when processed</p></li>
</ul>
<dl class="py method">
<dt class="sig sig-object py" id="sarracenia.flowcb.log.Log.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">options</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sarracenia/flowcb/log.html#Log.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sarracenia.flowcb.log.Log.__init__" title="Link to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

</section>
<section id="module-sarracenia.flowcb.mdelaylatest">
<span id="sarracenia-flowcb-mdelaylatest"></span><h2><a class="toc-backref" href="#id39" role="doc-backlink">sarracenia.flowcb.mdelaylatest</a><a class="headerlink" href="#module-sarracenia.flowcb.mdelaylatest" title="Link to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="sarracenia.flowcb.mdelaylatest.MDelayLatest">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sarracenia.flowcb.mdelaylatest.</span></span><span class="sig-name descname"><span class="pre">MDelayLatest</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">options</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sarracenia/flowcb/mdelaylatest.html#MDelayLatest"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sarracenia.flowcb.mdelaylatest.MDelayLatest" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#sarracenia.flowcb.FlowCB" title="sarracenia.flowcb.FlowCB"><code class="xref py py-class docutils literal notranslate"><span class="pre">FlowCB</span></code></a></p>
<p>This plugin delays processing of messages by <em>message_delay</em> seconds
If multiple versions of a file are published within the interval, only the latest one
will be published.</p>
<p>mdelay 30
flowcb sarracenia.flowcb.mdelaylatest.MDelayLatest</p>
<p>every message will be at least 30 seconds old before it is forwarded by this plugin.
In the meantime, the message is placed on the retry queue by marking it as failed.</p>
<dl class="py method">
<dt class="sig sig-object py" id="sarracenia.flowcb.mdelaylatest.MDelayLatest.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">options</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sarracenia/flowcb/mdelaylatest.html#MDelayLatest.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sarracenia.flowcb.mdelaylatest.MDelayLatest.__init__" title="Link to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

</section>
<section id="module-sarracenia.flowcb.nodupe">
<span id="sarracenia-flowcb-nodupe"></span><h2><a class="toc-backref" href="#id40" role="doc-backlink">sarracenia.flowcb.nodupe</a><a class="headerlink" href="#module-sarracenia.flowcb.nodupe" title="Link to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="sarracenia.flowcb.nodupe.NoDupe">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sarracenia.flowcb.nodupe.</span></span><span class="sig-name descname"><span class="pre">NoDupe</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">options</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">class_logger</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sarracenia/flowcb/nodupe.html#NoDupe"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sarracenia.flowcb.nodupe.NoDupe" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#sarracenia.flowcb.FlowCB" title="sarracenia.flowcb.FlowCB"><code class="xref py py-class docutils literal notranslate"><span class="pre">FlowCB</span></code></a></p>
<p>duplicate suppression family of modules.</p>
<p>invoked with:</p>
<p>callback sarracenia.flowcb.nodupe.disk</p>
<p>or:
callback sarracenia.flowcb.nodupe.redis</p>
<p>with default being loaded depdending on the presence of a</p>
<p>nodupe_driver “redis”</p>
<p>setting (defaults to disk.)</p>
</dd></dl>

</section>
<section id="module-sarracenia.flowcb.nodupe.data">
<span id="sarracenia-flowcb-nodupe-data"></span><h2><a class="toc-backref" href="#id41" role="doc-backlink">sarracenia.flowcb.nodupe.data</a><a class="headerlink" href="#module-sarracenia.flowcb.nodupe.data" title="Link to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="sarracenia.flowcb.nodupe.data.Data">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sarracenia.flowcb.nodupe.data.</span></span><span class="sig-name descname"><span class="pre">Data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">options</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">class_logger</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sarracenia/flowcb/nodupe/data.html#Data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sarracenia.flowcb.nodupe.data.Data" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#sarracenia.flowcb.FlowCB" title="sarracenia.flowcb.FlowCB"><code class="xref py py-class docutils literal notranslate"><span class="pre">FlowCB</span></code></a></p>
<p>duplicate suppression based on data alone. Overrides the path used for lookups
in the cache so that all files have the same name, and so if the checksum
is the same, regardless of file name, it is considered a duplicate.</p>
</dd></dl>

</section>
<section id="module-sarracenia.flowcb.nodupe.name">
<span id="sarracenia-flowcb-nodupe-name"></span><h2><a class="toc-backref" href="#id42" role="doc-backlink">sarracenia.flowcb.nodupe.name</a><a class="headerlink" href="#module-sarracenia.flowcb.nodupe.name" title="Link to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="sarracenia.flowcb.nodupe.name.Name">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sarracenia.flowcb.nodupe.name.</span></span><span class="sig-name descname"><span class="pre">Name</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">options</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">class_logger</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sarracenia/flowcb/nodupe/name.html#Name"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sarracenia.flowcb.nodupe.name.Name" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#sarracenia.flowcb.FlowCB" title="sarracenia.flowcb.FlowCB"><code class="xref py py-class docutils literal notranslate"><span class="pre">FlowCB</span></code></a></p>
<p>Override the the comparison so that files with the same name,
regardless of what directory they are in, are considered the same.
This is useful when receiving data from two different sources (two different trees)
and winnowing between them.</p>
</dd></dl>

</section>
<section id="module-sarracenia.flowcb.retry">
<span id="sarracenia-flowcb-retry"></span><h2><a class="toc-backref" href="#id43" role="doc-backlink">sarracenia.flowcb.retry</a><a class="headerlink" href="#module-sarracenia.flowcb.retry" title="Link to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="sarracenia.flowcb.retry.Retry">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sarracenia.flowcb.retry.</span></span><span class="sig-name descname"><span class="pre">Retry</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">options</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sarracenia/flowcb/retry.html#Retry"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sarracenia.flowcb.retry.Retry" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#sarracenia.flowcb.FlowCB" title="sarracenia.flowcb.FlowCB"><code class="xref py py-class docutils literal notranslate"><span class="pre">FlowCB</span></code></a></p>
<p>overall goal:</p>
<ul class="simple">
<li><p>When file transfers fail, write the messages to a queue to be retried later.
There is also a second retry queue for failed posts.</p></li>
</ul>
<p>how it works:</p>
<ul class="simple">
<li><p>the after_accept checks how many incoming messages we received.
If there is a full batch to process, don’t try to retry any.</p></li>
<li><p>if there is room, then fill in the batch with some retry requests.</p></li>
<li><p>when after_work is called, the worklist.failed list of messages
is the files where the transfer failed. write those messages to
a retry queue.</p></li>
<li><p>the DiskQueue or RedisQueue classes are used to store the retries, and it handles
expiry on each housekeeping event.</p></li>
</ul>
<dl class="py method">
<dt class="sig sig-object py" id="sarracenia.flowcb.retry.Retry.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">options</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="../_modules/sarracenia/flowcb/retry.html#Retry.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sarracenia.flowcb.retry.Retry.__init__" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sarracenia.flowcb.retry.Retry.after_accept">
<span class="sig-name descname"><span class="pre">after_accept</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">worklist</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="../_modules/sarracenia/flowcb/retry.html#Retry.after_accept"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sarracenia.flowcb.retry.Retry.after_accept" title="Link to this definition"></a></dt>
<dd><p>If there are only a few new messages, get some from the download retry queue and put them into
<cite>worklist.incoming</cite>.</p>
<p>Do this in the after_accept() entry point if retry_refilter is False.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sarracenia.flowcb.retry.Retry.after_post">
<span class="sig-name descname"><span class="pre">after_post</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">worklist</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="../_modules/sarracenia/flowcb/retry.html#Retry.after_post"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sarracenia.flowcb.retry.Retry.after_post" title="Link to this definition"></a></dt>
<dd><p>Messages in <cite>worklist.failed</cite> should be put in the post retry queue.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sarracenia.flowcb.retry.Retry.after_work">
<span class="sig-name descname"><span class="pre">after_work</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">worklist</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="../_modules/sarracenia/flowcb/retry.html#Retry.after_work"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sarracenia.flowcb.retry.Retry.after_work" title="Link to this definition"></a></dt>
<dd><p>Messages in <cite>worklist.failed</cite> should be put in the download retry queue. If there are only a few new
messages, get some from the post retry queue and put them into <cite>worklist.ok</cite>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sarracenia.flowcb.retry.Retry.gather">
<span class="sig-name descname"><span class="pre">gather</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">qty</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="../_modules/sarracenia/flowcb/retry.html#Retry.gather"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sarracenia.flowcb.retry.Retry.gather" title="Link to this definition"></a></dt>
<dd><p>If there are only a few new messages, get some from the download retry queue and put them into
<cite>worklist.incoming</cite>.</p>
<p>Do this in the gather() entry point if retry_refilter is True.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sarracenia.flowcb.retry.Retry.metricsReport">
<span class="sig-name descname"><span class="pre">metricsReport</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">dict</span></span></span><a class="reference internal" href="../_modules/sarracenia/flowcb/retry.html#Retry.metricsReport"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sarracenia.flowcb.retry.Retry.metricsReport" title="Link to this definition"></a></dt>
<dd><p>Returns the number of messages in the download_retry and post_retry queues.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>containing metrics: <code class="docutils literal notranslate"><span class="pre">{'msgs_in_download_retry':</span> <span class="pre">(int),</span> <span class="pre">'msgs_in_post_retry':</span> <span class="pre">(int)}</span></code></p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>dict</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-sarracenia.flowcb.pclean">
<span id="sarracenia-flowcb-pclean"></span><h2><a class="toc-backref" href="#id44" role="doc-backlink">sarracenia.flowcb.pclean</a><a class="headerlink" href="#module-sarracenia.flowcb.pclean" title="Link to this heading"></a></h2>
<p>msg_pclean module: base module for propagation tests and cleanup for Sarracenia components (in flow test)
Used by <a class="reference external" href="https://github.com/MetPX/sr_insects">https://github.com/MetPX/sr_insects</a> test suite for CI/CD.</p>
<dl class="py class">
<dt class="sig sig-object py" id="sarracenia.flowcb.pclean.PClean">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sarracenia.flowcb.pclean.</span></span><span class="sig-name descname"><span class="pre">PClean</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">options</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sarracenia/flowcb/pclean.html#PClean"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sarracenia.flowcb.pclean.PClean" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#sarracenia.flowcb.FlowCB" title="sarracenia.flowcb.FlowCB"><code class="xref py py-class docutils literal notranslate"><span class="pre">FlowCB</span></code></a></p>
<p>Base plugin class that is used in shovel pclean_f9x:</p>
<blockquote>
<div><ul class="simple">
<li><p>it checks if the propagation was ok.</p></li>
<li><p>it randomly set a test in the watch f40.conf for propagation</p></li>
<li><p>it posts the product again (more test in shovel clean_f91) which is propagated too</p></li>
<li><p>it remove the original product</p></li>
</ul>
</div></blockquote>
<p>It also uses a file delay to tolerate a maximum lag for the test</p>
<p>The posted message contains a tag in the header for the test performed which is the extension used for the test</p>
<dl class="py method">
<dt class="sig sig-object py" id="sarracenia.flowcb.pclean.PClean.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">options</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sarracenia/flowcb/pclean.html#PClean.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sarracenia.flowcb.pclean.PClean.__init__" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sarracenia.flowcb.pclean.PClean.build_path_dict">
<span class="sig-name descname"><span class="pre">build_path_dict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fxx_dirs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">relpath</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ext</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sarracenia/flowcb/pclean.html#PClean.build_path_dict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sarracenia.flowcb.pclean.PClean.build_path_dict" title="Link to this definition"></a></dt>
<dd><p>This build paths necessary to pclean tests</p>
<p>It is a subset of all flow test path based on fxx download directory provided.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>root</strong> – usually the sarra dev doc root directory</p></li>
<li><p><strong>fxx_dirs</strong> – a list of the flow test directory needed</p></li>
<li><p><strong>relpath</strong> – the relative path of the file (starting with the date) without the forward slash</p></li>
<li><p><strong>ext</strong> – the extension from the extension test (optional)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>a dictionnary of all paths built</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sarracenia.flowcb.pclean.PClean.get_extension">
<span class="sig-name descname"><span class="pre">get_extension</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">relpath</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sarracenia/flowcb/pclean.html#PClean.get_extension"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sarracenia.flowcb.pclean.PClean.get_extension" title="Link to this definition"></a></dt>
<dd><p>Check whether the extension is in the header</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>msg</strong> – the msg used for the test</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>the value corresponding to the extension key in the msg header</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-sarracenia.flowcb.sample">
<span id="sarracenia-flowcb-sample"></span><h2><a class="toc-backref" href="#id45" role="doc-backlink">sarracenia.flowcb.sample</a><a class="headerlink" href="#module-sarracenia.flowcb.sample" title="Link to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="sarracenia.flowcb.sample.Sample">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sarracenia.flowcb.sample.</span></span><span class="sig-name descname"><span class="pre">Sample</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">options</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sarracenia/flowcb/sample.html#Sample"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sarracenia.flowcb.sample.Sample" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#sarracenia.flowcb.FlowCB" title="sarracenia.flowcb.FlowCB"><code class="xref py py-class docutils literal notranslate"><span class="pre">FlowCB</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="sarracenia.flowcb.sample.Sample.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">options</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sarracenia/flowcb/sample.html#Sample.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sarracenia.flowcb.sample.Sample.__init__" title="Link to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

</section>
<section id="module-sarracenia.flowcb.scheduled">
<span id="sarracenia-flowcb-scheduled"></span><h2><a class="toc-backref" href="#id46" role="doc-backlink">sarracenia.flowcb.scheduled</a><a class="headerlink" href="#module-sarracenia.flowcb.scheduled" title="Link to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="sarracenia.flowcb.scheduled.Scheduled">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sarracenia.flowcb.scheduled.</span></span><span class="sig-name descname"><span class="pre">Scheduled</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">options</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logger=&lt;Logger</span> <span class="pre">sarracenia.flowcb.scheduled</span> <span class="pre">(WARNING)&gt;</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sarracenia/flowcb/scheduled.html#Scheduled"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sarracenia.flowcb.scheduled.Scheduled" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#sarracenia.flowcb.FlowCB" title="sarracenia.flowcb.FlowCB"><code class="xref py py-class docutils literal notranslate"><span class="pre">FlowCB</span></code></a></p>
<p>Scheduled flow callback plugin arranges to post url’s
at scheduled times.</p>
<p>usage:</p>
<p>In the configuration file, need:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">callback</span> <span class="n">scheduled</span>
</pre></div>
</div>
<p>and the schedule can be a specified as:</p>
<ul class="simple">
<li><p>scheduled_interval 1m   (once a minute) a duration</p></li>
<li><p>scheduled_hour  4,9    at 4Z and 9Z every day.</p></li>
<li><p>scheduled_minute 33,45  within scheduled hours which minutes.</p></li>
</ul>
<p>Scheduled_interval takes precedence over the others, making it
easier to specify an interval for testing/debugging purposes.</p>
<p>use in code (for subclassing):</p>
<p>from sarracenia.scheduled import Scheduled</p>
<dl class="simple">
<dt>class hoho(Scheduled):</dt><dd><p>replace the gather() routine…
keep the top lines “until time to run”
replace whatever is below.
will only run when it should.</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="sarracenia.flowcb.scheduled.Scheduled.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">options</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logger=&lt;Logger</span> <span class="pre">sarracenia.flowcb.scheduled</span> <span class="pre">(WARNING)&gt;</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sarracenia/flowcb/scheduled.html#Scheduled.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sarracenia.flowcb.scheduled.Scheduled.__init__" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sarracenia.flowcb.scheduled.Scheduled.update_appointments">
<span class="sig-name descname"><span class="pre">update_appointments</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">when</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sarracenia/flowcb/scheduled.html#Scheduled.update_appointments"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sarracenia.flowcb.scheduled.Scheduled.update_appointments" title="Link to this definition"></a></dt>
<dd><p># make a flat list from values where comma separated on a single or multiple lines.</p>
<p>set self.appointments to a list of when something needs to be run during the current day.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sarracenia.flowcb.scheduled.Scheduled.wait_seconds">
<span class="sig-name descname"><span class="pre">wait_seconds</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sleepfor</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sarracenia/flowcb/scheduled.html#Scheduled.wait_seconds"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sarracenia.flowcb.scheduled.Scheduled.wait_seconds" title="Link to this definition"></a></dt>
<dd><p>sleep for the given number of seconds, like time.sleep() but broken into
shorter naps to be able to honour stop_requested, or when housekeeping is needed.</p>
</dd></dl>

</dd></dl>

</section>
<section id="sarracenia-flowcb-script">
<h2><a class="toc-backref" href="#id47" role="doc-backlink">sarracenia.flowcb.script</a><a class="headerlink" href="#sarracenia-flowcb-script" title="Link to this heading"></a></h2>
</section>
<section id="module-sarracenia.flowcb.shiftdir2baseurl">
<span id="sarracenia-flowcb-shiftdir2baseurl"></span><h2><a class="toc-backref" href="#id48" role="doc-backlink">sarracenia.flowcb.shiftdir2baseurl</a><a class="headerlink" href="#module-sarracenia.flowcb.shiftdir2baseurl" title="Link to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="sarracenia.flowcb.shiftdir2baseurl.ShiftDir2baseUrl">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sarracenia.flowcb.shiftdir2baseurl.</span></span><span class="sig-name descname"><span class="pre">ShiftDir2baseUrl</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">options</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sarracenia/flowcb/shiftdir2baseurl.html#ShiftDir2baseUrl"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sarracenia.flowcb.shiftdir2baseurl.ShiftDir2baseUrl" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#sarracenia.flowcb.FlowCB" title="sarracenia.flowcb.FlowCB"><code class="xref py py-class docutils literal notranslate"><span class="pre">FlowCB</span></code></a></p>
<p>modify message to shift directories from relPath to baseUrl:</p>
<dl class="simple">
<dt>given the setting shiftDir2baseUrl == 2 and given message with</dt><dd><p>baseDir=https://a  relPath=b/c/d/e subtopic=b/c/d –&gt;  baseDir=https://a/b/c  relPath=d/e  subtopic=d</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="sarracenia.flowcb.shiftdir2baseurl.ShiftDir2baseUrl.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">options</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sarracenia/flowcb/shiftdir2baseurl.html#ShiftDir2baseUrl.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sarracenia.flowcb.shiftdir2baseurl.ShiftDir2baseUrl.__init__" title="Link to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

</section>
<section id="module-sarracenia.flowcb.poll">
<span id="sarracenia-flowcb-poll"></span><h2><a class="toc-backref" href="#id49" role="doc-backlink">sarracenia.flowcb.poll</a><a class="headerlink" href="#module-sarracenia.flowcb.poll" title="Link to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="sarracenia.flowcb.poll.Poll">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sarracenia.flowcb.poll.</span></span><span class="sig-name descname"><span class="pre">Poll</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">options</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">class_logger=&lt;Logger</span> <span class="pre">sarracenia.flowcb.poll</span> <span class="pre">(WARNING)&gt;</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sarracenia/flowcb/poll.html#Poll"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sarracenia.flowcb.poll.Poll" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#sarracenia.flowcb.FlowCB" title="sarracenia.flowcb.FlowCB"><code class="xref py py-class docutils literal notranslate"><span class="pre">FlowCB</span></code></a></p>
<p>The Poll flow callback class implements the main logic for polling remote resources.
the <em>poll</em> routine returns a list of messages for new files to be filtered.</p>
<p>when instantiated with options, the options honoured include:</p>
<ul class="simple">
<li><p>pollUrl - the URL of the server to be polled.</p></li>
<li><p>post_baseURL - parameter for messages to be returned. Also used to look
up credentials to help subscribers with retrieval.</p></li>
<li><p>masks - These are the directories at the pollUrl to poll.
derived from the accept/reject clauses, but filtering should happen later.
entire directories are listed at this point.</p></li>
<li><p>timezone - interpret listings from an FTP server as being in the given timezone
(as per <a class="reference external" href="pypi.org/project/pytz">pytz</a></p></li>
<li><p>chmod - used to identify the minimum permissions to accept for a file to
be included in a polling result.</p></li>
<li><p>identity_method - parameter for how to build identity checksum for messages.
as these are usually remote files, the default is typically “cod” (calculate on download)</p></li>
<li><p>rename - parameter used to to put in messages built to specify the rename field contents.</p></li>
<li><p>options are passed to sarracenia.Transfer classes for their use as well.</p></li>
</ul>
<p>Poll uses sarracenia.transfer (ftp, sftp, https, etc… )classes to
requests lists of files using those protocols using built-in logic.</p>
<p>Internally, Poll normalizes the listings received by placing them into paramiko.SFTPAttributes
metadata records (similar to stat records) and builds a Sarracenia.Message from them.
The <em>poll</em> routine does one pass of this, returning a list of Sarracenia.Messages.</p>
<p>To customize:</p>
<ul class="simple">
<li><p>one can add new sarracenia.transfer protocols, each implementing the <em>ls</em> entry point
to be compatible with this polling routine, ideally the entry point would return a
list of paramiko.SFTPAttributes for each file in a directory listing.
This can be used to implement polling of structured remote resources such as S3 or webdav.</p></li>
<li><p>one can deal with different formats of HTTP pages by overriding the handle_data entry point,
as done in <a class="reference external" href="nasa_mls_nrt.py">nasa_mls_nrt.py</a> plugin</p></li>
<li><p>for traditional file servers, the listing format should be decypherable with the built-in processing.</p></li>
<li><p>sftp file servers provide paramiko.SFTPAttributes naturally which are timezone agnostic.</p></li>
<li><p>for some FTP servers, one may need to specify the <em>timezone</em> option to override the UTC default.</p></li>
<li><p>If there are problems with date or line formats, one can sub-class poll, and override only the on_line
routine to deal with that.</p></li>
</ul>
<dl class="py method">
<dt class="sig sig-object py" id="sarracenia.flowcb.poll.Poll.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">options</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">class_logger=&lt;Logger</span> <span class="pre">sarracenia.flowcb.poll</span> <span class="pre">(WARNING)&gt;</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sarracenia/flowcb/poll.html#Poll.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sarracenia.flowcb.poll.Poll.__init__" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sarracenia.flowcb.poll.Poll.handle_data">
<span class="sig-name descname"><span class="pre">handle_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sarracenia/flowcb/poll.html#Poll.handle_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sarracenia.flowcb.poll.Poll.handle_data" title="Link to this definition"></a></dt>
<dd><p>routine called from html.parser to deal with a single line.
if the line is about a file, then create a new entry for it
with a metadata available from SFTPAttributes.</p>
<p>example lines:</p>
<blockquote>
<div><dl class="simple">
<dt>from hpfx.collab.science.gc.ca:</dt><dd><p>20230113T00Z_MSC_REPS_HGT_ISBL-0850_RLatLon0.09x0.09_PT000H.grib2   2023-01-13 03:49  5.2M</p>
</dd>
<dt>from <a class="reference external" href="https://data.cosmic.ucar.edu/suominet/nrt/ncConus/y2023/">https://data.cosmic.ucar.edu/suominet/nrt/ncConus/y2023/</a></dt><dd><p>CsuPWVh_2023.011.22.00.0060_nc                     11-Jan-2023 23:58     47K</p>
</dd>
</dl>
</div></blockquote>
<p>this can be overridden by subclassing to deal with new web sites.</p>
<p>Other web servers put their file indices in a tabular format,  where there is a number
of cells per row:
&lt;tr&gt;&lt;td&gt;&lt;/td&gt;&lt;td href=filename&gt;filename&lt;/td&gt;&lt;td&gt;yyyy-mm-dd hh:mm&lt;/td&gt;&lt;td&gt;size&lt;/td&gt;
This handle_data supports both formats…
the tabular format is provided by a vanilla apache2 on a debian derived system.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sarracenia.flowcb.poll.Poll.on_html_page">
<span class="sig-name descname"><span class="pre">on_html_page</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">dict</span></span></span><a class="reference internal" href="../_modules/sarracenia/flowcb/poll.html#Poll.on_html_page"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sarracenia.flowcb.poll.Poll.on_html_page" title="Link to this definition"></a></dt>
<dd><p>called once per directory or page of HTML, invokes html.parser, returns
a dictionary of file entries.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sarracenia.flowcb.poll.Poll.on_line">
<span class="sig-name descname"><span class="pre">on_line</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">line</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">SFTPAttributes</span></span></span><a class="reference internal" href="../_modules/sarracenia/flowcb/poll.html#Poll.on_line"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sarracenia.flowcb.poll.Poll.on_line" title="Link to this definition"></a></dt>
<dd><p>default line processing, converts a file listing into an SFTPAttributes.
does nothing if input is already an SFTPAttributes item, returning it unchanged.
verifies that file is accessible (based on self.o.permDefault pattern to establish minimum permissions.)</p>
</dd></dl>

</dd></dl>

</section>
<section id="module-sarracenia.flowcb.poll.airnow">
<span id="sarracenia-flowcb-poll-airnow"></span><h2><a class="toc-backref" href="#id50" role="doc-backlink">sarracenia.flowcb.poll.airnow</a><a class="headerlink" href="#module-sarracenia.flowcb.poll.airnow" title="Link to this heading"></a></h2>
<p>Posts updated files of airnowtech.
Compatible with Python 3.5+.</p>
<dl>
<dt>usage:</dt><dd><p>in an sr3 poll configuration file:</p>
<p>pollUrl <a class="reference external" href="http://files.airnowtech.org/?prefix=airnow/today/">http://files.airnowtech.org/?prefix=airnow/today/</a></p>
<p>callback airnow</p>
</dd>
<dt>STATUS: unknown… need some authentication, or perhaps the method has changed.</dt><dd><p>does not seem to work out of the box.</p>
</dd>
</dl>
<dl class="py class">
<dt class="sig sig-object py" id="sarracenia.flowcb.poll.airnow.Airnow">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sarracenia.flowcb.poll.airnow.</span></span><span class="sig-name descname"><span class="pre">Airnow</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">options</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">class_logger</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sarracenia/flowcb/poll/airnow.html#Airnow"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sarracenia.flowcb.poll.airnow.Airnow" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#sarracenia.flowcb.FlowCB" title="sarracenia.flowcb.FlowCB"><code class="xref py py-class docutils literal notranslate"><span class="pre">FlowCB</span></code></a></p>
</dd></dl>

</section>
<section id="module-sarracenia.flowcb.poll.mail">
<span id="sarracenia-flowcb-poll-mail"></span><h2><a class="toc-backref" href="#id51" role="doc-backlink">sarracenia.flowcb.poll.mail</a><a class="headerlink" href="#module-sarracenia.flowcb.poll.mail" title="Link to this heading"></a></h2>
<p>Posts any new emails from an email server, connected to using
the specified protocol, either pop3 or imap. The imaplib/poplib
implementations in Python use the most secure SSL settings by
default: PROTOCOL_TLS, OP_NO_SSLv2, and OP_NO_SSLv3.
Compatible with Python 2.7+.</p>
<p>A sample do_poll option for sr_poll.
connects to an email server with the provided
credentials and posts all new messages by their msg ID.</p>
<dl>
<dt>usage:</dt><dd><p>in an sr_poll configuration file:</p>
<p>pollUrl [imap|imaps|pop|pops]://[user[:password]&#64;]host[:port]/</p>
<p>IMAP over SSL uses 993, POP3 over SSL uses 995
IMAP unsecured uses 143, POP3 unsecured uses 110</p>
<p>Full credentials must be in credentials.conf.
If port is not specified it’ll default to the ones above based on protocol/ssl setting.</p>
</dd>
</dl>
<p>This posts what messages are available. A separate component is needed to
download the message, which would need:</p>
<blockquote>
<div><p>callback download.mail_ingest</p>
</div></blockquote>
<p>to process these posts.</p>
<dl class="py class">
<dt class="sig sig-object py" id="sarracenia.flowcb.poll.mail.Mail">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sarracenia.flowcb.poll.mail.</span></span><span class="sig-name descname"><span class="pre">Mail</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">options</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sarracenia/flowcb/poll/mail.html#Mail"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sarracenia.flowcb.poll.mail.Mail" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#sarracenia.flowcb.poll.Poll" title="sarracenia.flowcb.poll.Poll"><code class="xref py py-class docutils literal notranslate"><span class="pre">Poll</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="sarracenia.flowcb.poll.mail.Mail.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">options</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sarracenia/flowcb/poll/mail.html#Mail.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sarracenia.flowcb.poll.mail.Mail.__init__" title="Link to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

</section>
<section id="module-sarracenia.flowcb.poll.nasa_mls_nrt">
<span id="sarracenia-flowcb-poll-nasa-mls-nrt"></span><h2><a class="toc-backref" href="#id52" role="doc-backlink">sarracenia.flowcb.poll.nasa_mls_nrt</a><a class="headerlink" href="#module-sarracenia.flowcb.poll.nasa_mls_nrt" title="Link to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="sarracenia.flowcb.poll.nasa_mls_nrt.Nasa_mls_nrt">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sarracenia.flowcb.poll.nasa_mls_nrt.</span></span><span class="sig-name descname"><span class="pre">Nasa_mls_nrt</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">options</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">class_logger=&lt;Logger</span> <span class="pre">sarracenia.flowcb.poll</span> <span class="pre">(WARNING)&gt;</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sarracenia/flowcb/poll/nasa_mls_nrt.html#Nasa_mls_nrt"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sarracenia.flowcb.poll.nasa_mls_nrt.Nasa_mls_nrt" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#sarracenia.flowcb.poll.Poll" title="sarracenia.flowcb.poll.Poll"><code class="xref py py-class docutils literal notranslate"><span class="pre">Poll</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="sarracenia.flowcb.poll.nasa_mls_nrt.Nasa_mls_nrt.handle_data">
<span class="sig-name descname"><span class="pre">handle_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sarracenia/flowcb/poll/nasa_mls_nrt.html#Nasa_mls_nrt.handle_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sarracenia.flowcb.poll.nasa_mls_nrt.Nasa_mls_nrt.handle_data" title="Link to this definition"></a></dt>
<dd><p>decode some HTML into an SFTPAttributes record for a file.</p>
</dd></dl>

</dd></dl>

</section>
<section id="sarracenia-flowcb-poll-nexrad">
<h2><a class="toc-backref" href="#id53" role="doc-backlink">sarracenia.flowcb.poll.nexrad</a><a class="headerlink" href="#sarracenia-flowcb-poll-nexrad" title="Link to this heading"></a></h2>
</section>
<section id="module-sarracenia.flowcb.poll.noaa_hydrometric">
<span id="sarracenia-flowcb-poll-noaa-hydrometric"></span><h2><a class="toc-backref" href="#id54" role="doc-backlink">sarracenia.flowcb.poll.noaa_hydrometric</a><a class="headerlink" href="#module-sarracenia.flowcb.poll.noaa_hydrometric" title="Link to this heading"></a></h2>
<p>Posts updated files of NOAA water level/temperature hydrometric data. Station site IDs provided
in the poll_noaa_stn_file. Compatible with Python 3.5+.</p>
<p>usage:
sample url: <a class="reference external" href="https://tidesandcurrents.noaa.gov/api/datagetter?range=1&amp;station=9450460&amp;product=water_temperature&amp;units=metric&amp;time_zone=gmt&amp;application=web_services&amp;format=csv">https://tidesandcurrents.noaa.gov/api/datagetter?range=1&amp;station=9450460&amp;product=water_temperature&amp;units=metric&amp;time_zone=gmt&amp;application=web_services&amp;format=csv</a></p>
<p>in an sr_poll configuration file:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>pollUrl http://tidesandcurrents.noaa.gov/api
retrievePathPattern /datagetter?range=1&amp;station={0:}&amp;product={1:}&amp;units=metric&amp;time_zone=gmt&amp;application=web_services&amp;format=csv

poll_noaa_stn_file [path/to/stn/file]
callback noaa_hydrometric
</pre></div>
</div>
<p>sample station file:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">7</span><span class="o">|</span><span class="mi">70678</span><span class="o">|</span><span class="mi">9751639</span><span class="o">|</span><span class="n">Charlotte</span> <span class="n">Amalie</span><span class="o">|</span><span class="n">US</span><span class="o">|</span><span class="n">VI</span><span class="o">|-</span><span class="mf">4.0</span>
<span class="mi">7</span><span class="o">|</span><span class="mi">70614</span><span class="o">|</span><span class="mi">9440083</span><span class="o">|</span><span class="n">Vancouver</span><span class="o">|</span><span class="n">US</span><span class="o">|</span><span class="n">WA</span><span class="o">|-</span><span class="mf">8.0</span>
</pre></div>
</div>
<p>The poll:
If poll_noaa_stn_file isn’t set, it’ll grab an up-to-date version of all station site code data from the
NOAA website. The station list file is in the following format:
SourceID | SiteID | SiteCode | SiteName | CountryID | StateID | UTCOffset
Each station on its own line.
Posts the file on the exchange if the request returns a valid URL.</p>
<p>in v2, one needed a matching downloader plugin, but in sr3 we can leverage the retrievePath feature
so that normalk downloader works, so only the poll one needed.</p>
<dl class="py class">
<dt class="sig sig-object py" id="sarracenia.flowcb.poll.noaa_hydrometric.Noaa_hydrometric">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sarracenia.flowcb.poll.noaa_hydrometric.</span></span><span class="sig-name descname"><span class="pre">Noaa_hydrometric</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">options</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sarracenia/flowcb/poll/noaa_hydrometric.html#Noaa_hydrometric"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sarracenia.flowcb.poll.noaa_hydrometric.Noaa_hydrometric" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#sarracenia.flowcb.FlowCB" title="sarracenia.flowcb.FlowCB"><code class="xref py py-class docutils literal notranslate"><span class="pre">FlowCB</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="sarracenia.flowcb.poll.noaa_hydrometric.Noaa_hydrometric.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">options</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sarracenia/flowcb/poll/noaa_hydrometric.html#Noaa_hydrometric.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sarracenia.flowcb.poll.noaa_hydrometric.Noaa_hydrometric.__init__" title="Link to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

</section>
<section id="sarracenia-flowcb-poll-usgs">
<h2><a class="toc-backref" href="#id55" role="doc-backlink">sarracenia.flowcb.poll.usgs</a><a class="headerlink" href="#sarracenia-flowcb-poll-usgs" title="Link to this heading"></a></h2>
</section>
<section id="module-sarracenia.flowcb.post">
<span id="sarracenia-flowcb-post"></span><h2><a class="toc-backref" href="#id56" role="doc-backlink">sarracenia.flowcb.post</a><a class="headerlink" href="#module-sarracenia.flowcb.post" title="Link to this heading"></a></h2>
<p>Place holder… thought this was not needed, then there was a stack trace.</p>
</section>
<section id="module-sarracenia.flowcb.send.email">
<span id="sarracenia-flowcb-send-email"></span><h2><a class="toc-backref" href="#id57" role="doc-backlink">sarracenia.flowcb.send.email</a><a class="headerlink" href="#module-sarracenia.flowcb.send.email" title="Link to this heading"></a></h2>
<p>sarracenia.flowcb.send.email.Email is an sr3 sender plugin. Once a file is
posted, the plugin matches the topic(what the filename begins with) to the
file name and sends the appropriate emails.</p>
<dl>
<dt>Usage:</dt><dd><ol class="arabic">
<li><p>Need the following variables in an sr_sender config defined: file_email_to, file_email_relay
Optionally, you can also provide a sender name/email as file_email_form:</p>
<blockquote>
<div><p>file_email_to AACN27 <a class="reference external" href="mailto:muhammad&#46;taseer&#37;&#52;&#48;canada&#46;ca">muhammad<span>&#46;</span>taseer<span>&#64;</span>canada<span>&#46;</span>ca</a>, <a class="reference external" href="mailto:test&#37;&#52;&#48;test&#46;com">test<span>&#64;</span>test<span>&#46;</span>com</a>
file_email_relay email.relay.server.ca
file_email_from <a class="reference external" href="mailto:santa&#37;&#52;&#48;canada&#46;ca">santa<span>&#64;</span>canada<span>&#46;</span>ca</a></p>
</div></blockquote>
</li>
<li><p>In the config file, include the following line:</p>
<blockquote>
<div><p>callback send.email</p>
</div></blockquote>
</li>
<li><p>sr_sender foreground emails.conf</p></li>
</ol>
</dd>
</dl>
<p>Original Author: Wahaj Taseer - June, 2019</p>
<dl class="py class">
<dt class="sig sig-object py" id="sarracenia.flowcb.send.email.Email">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sarracenia.flowcb.send.email.</span></span><span class="sig-name descname"><span class="pre">Email</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">options</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sarracenia/flowcb/send/email.html#Email"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sarracenia.flowcb.send.email.Email" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#sarracenia.flowcb.FlowCB" title="sarracenia.flowcb.FlowCB"><code class="xref py py-class docutils literal notranslate"><span class="pre">FlowCB</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="sarracenia.flowcb.send.email.Email.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">options</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sarracenia/flowcb/send/email.html#Email.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sarracenia.flowcb.send.email.Email.__init__" title="Link to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

</section>
<section id="module-sarracenia.flowcb.post.message">
<span id="sarracenia-flowcb-post-message"></span><h2><a class="toc-backref" href="#id58" role="doc-backlink">sarracenia.flowcb.post.message</a><a class="headerlink" href="#module-sarracenia.flowcb.post.message" title="Link to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="sarracenia.flowcb.post.message.Message">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sarracenia.flowcb.post.message.</span></span><span class="sig-name descname"><span class="pre">Message</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">options</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sarracenia/flowcb/post/message.html#Message"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sarracenia.flowcb.post.message.Message" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#sarracenia.flowcb.FlowCB" title="sarracenia.flowcb.FlowCB"><code class="xref py py-class docutils literal notranslate"><span class="pre">FlowCB</span></code></a></p>
<p>post messages to sarracenia.moth message queuing protocol destination.</p>
<dl class="py method">
<dt class="sig sig-object py" id="sarracenia.flowcb.post.message.Message.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">options</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sarracenia/flowcb/post/message.html#Message.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sarracenia.flowcb.post.message.Message.__init__" title="Link to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

</section>
<section id="module-sarracenia.flowcb.send">
<span id="sarracenia-flowcb-send"></span><h2><a class="toc-backref" href="#id59" role="doc-backlink">sarracenia.flowcb.send</a><a class="headerlink" href="#module-sarracenia.flowcb.send" title="Link to this heading"></a></h2>
<p>plugins intended for on_message entry_point.</p>
<p>(when messages are received.)</p>
</section>
<section id="sarracenia-flowcb-wistree">
<h2><a class="toc-backref" href="#id60" role="doc-backlink">sarracenia.flowcb.wistree</a><a class="headerlink" href="#sarracenia-flowcb-wistree" title="Link to this heading"></a></h2>
</section>
<section id="module-sarracenia.flowcb.work">
<span id="sarracenia-flowcb-work"></span><h2><a class="toc-backref" href="#id61" role="doc-backlink">sarracenia.flowcb.work</a><a class="headerlink" href="#module-sarracenia.flowcb.work" title="Link to this heading"></a></h2>
<p>plugins that use primarily the after_work entry point, normally
executed after the file transfer (either send or get) has completed.</p>
<p>usually such plugins will contain a loop:</p>
<dl class="simple">
<dt>for msg in worklist.ok</dt><dd><p>do_something.</p>
</dd>
</dl>
<p>to operate on all the files transferrred or processed successfully.</p>
</section>
<section id="module-sarracenia.flowcb.work.age">
<span id="sarracenia-flowcb-work-age"></span><h2><a class="toc-backref" href="#id62" role="doc-backlink">sarracenia.flowcb.work.age</a><a class="headerlink" href="#module-sarracenia.flowcb.work.age" title="Link to this heading"></a></h2>
<p>print the age of files written (compare current time to mtime of message.)
usage:</p>
<p>flowcb work.age</p>
<dl class="py class">
<dt class="sig sig-object py" id="sarracenia.flowcb.work.age.Age">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sarracenia.flowcb.work.age.</span></span><span class="sig-name descname"><span class="pre">Age</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">options</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">class_logger</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sarracenia/flowcb/work/age.html#Age"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sarracenia.flowcb.work.age.Age" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#sarracenia.flowcb.FlowCB" title="sarracenia.flowcb.FlowCB"><code class="xref py py-class docutils literal notranslate"><span class="pre">FlowCB</span></code></a></p>
</dd></dl>

</section>
<section id="module-sarracenia.flowcb.work.rxpipe">
<span id="sarracenia-flowcb-work-rxpipe"></span><h2><a class="toc-backref" href="#id63" role="doc-backlink">sarracenia.flowcb.work.rxpipe</a><a class="headerlink" href="#module-sarracenia.flowcb.work.rxpipe" title="Link to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="sarracenia.flowcb.work.rxpipe.Rxpipe">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sarracenia.flowcb.work.rxpipe.</span></span><span class="sig-name descname"><span class="pre">Rxpipe</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">options</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sarracenia/flowcb/work/rxpipe.html#Rxpipe"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sarracenia.flowcb.work.rxpipe.Rxpipe" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#sarracenia.flowcb.FlowCB" title="sarracenia.flowcb.FlowCB"><code class="xref py py-class docutils literal notranslate"><span class="pre">FlowCB</span></code></a></p>
<p>After each file is transferred, write it’s name to a named_pipe.</p>
<dl class="simple">
<dt>parameter:</dt><dd><p>rxpipe_name  – the path for the named pipe to write the file names to.</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="sarracenia.flowcb.work.rxpipe.Rxpipe.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">options</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sarracenia/flowcb/work/rxpipe.html#Rxpipe.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sarracenia.flowcb.work.rxpipe.Rxpipe.__init__" title="Link to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

</section>
<section id="module-sarracenia.flowcb.v2wrapper">
<span id="sarracenia-flowcb-v2wrapper"></span><h2><a class="toc-backref" href="#id64" role="doc-backlink">sarracenia.flowcb.v2wrapper</a><a class="headerlink" href="#module-sarracenia.flowcb.v2wrapper" title="Link to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="sarracenia.flowcb.v2wrapper.V2Wrapper">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sarracenia.flowcb.v2wrapper.</span></span><span class="sig-name descname"><span class="pre">V2Wrapper</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">o</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sarracenia/flowcb/v2wrapper.html#V2Wrapper"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sarracenia.flowcb.v2wrapper.V2Wrapper" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#sarracenia.flowcb.FlowCB" title="sarracenia.flowcb.FlowCB"><code class="xref py py-class docutils literal notranslate"><span class="pre">FlowCB</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="sarracenia.flowcb.v2wrapper.V2Wrapper.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">o</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sarracenia/flowcb/v2wrapper.html#V2Wrapper.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sarracenia.flowcb.v2wrapper.V2Wrapper.__init__" title="Link to this definition"></a></dt>
<dd><p>A wrapper class to run v02 plugins.
us run_entry(entry_point,module)</p>
<p>entry_point is a string like ‘on_message’,  and module being the one to add.</p>
<dl class="simple">
<dt>weird v2 stuff:</dt><dd><p>when calling init, self is a config/subscriber…
when calling on_message, self is a message…
that is kind of blown away for each message…
parent is the config/subscriber in both cases.
so v2 state variables are always stored in parent.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sarracenia.flowcb.v2wrapper.V2Wrapper.on_time">
<span class="sig-name descname"><span class="pre">on_time</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">time</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sarracenia/flowcb/v2wrapper.html#V2Wrapper.on_time"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sarracenia.flowcb.v2wrapper.V2Wrapper.on_time" title="Link to this definition"></a></dt>
<dd><p>run plugins for a given entry point.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sarracenia.flowcb.v2wrapper.V2Wrapper.run_entry">
<span class="sig-name descname"><span class="pre">run_entry</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ep</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sarracenia/flowcb/v2wrapper.html#V2Wrapper.run_entry"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sarracenia.flowcb.v2wrapper.V2Wrapper.run_entry" title="Link to this definition"></a></dt>
<dd><p>run plugins for a given entry point.</p>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sarracenia.flowcb.v2wrapper.sumstrFromMessage">
<span class="sig-prename descclassname"><span class="pre">sarracenia.flowcb.v2wrapper.</span></span><span class="sig-name descname"><span class="pre">sumstrFromMessage</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">msg</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">str</span></span></span><a class="reference internal" href="../_modules/sarracenia/flowcb/v2wrapper.html#sumstrFromMessage"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sarracenia.flowcb.v2wrapper.sumstrFromMessage" title="Link to this definition"></a></dt>
<dd><p>accepts a v3 message as argument msg. returns the corresponding sum string for a v2 ‘sum’ header.</p>
</dd></dl>

</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="sr_post.7.html" class="btn btn-neutral float-left" title="SR_post" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="code.html" class="btn btn-neutral float-right" title="Code Reference" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2022, Shared Services Canada, Government of Canada, GPLv2.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>