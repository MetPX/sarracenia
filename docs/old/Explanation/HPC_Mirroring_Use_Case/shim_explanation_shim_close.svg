<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.0//EN" "http://www.w3.org/TR/2001/PR-SVG-20010719/DTD/svg10.dtd">
<svg width="19cm" height="14cm" viewBox="66 379 378 277" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
  <defs/>
  <g id="Background"/>
  <g id="Application">
    <rect style="fill: #ffffff; fill-opacity: 1; stroke-opacity: 1; stroke-width: 2; stroke: #000000" x="129.754" y="550.142" width="136.472" height="16.9706" rx="0" ry="0"/>
    <rect style="fill: #ffffff; fill-opacity: 1; stroke-opacity: 1; stroke-width: 2; stroke: #000000" x="68.9429" y="385.74" width="167.584" height="62.579" rx="0" ry="0"/>
    <text font-size="12.7998" style="fill: #000000; fill-opacity: 1; stroke: none;text-anchor:start;font-family:sans-serif;font-style:normal;font-weight:normal" x="152.735" y="417.029">
      <tspan x="152.735" y="417.029"></tspan>
    </text>
    <text font-size="12.7998" style="fill: #000000; fill-opacity: 1; stroke: none;text-anchor:start;font-family:sans-serif;font-style:normal;font-weight:normal" x="116.319" y="419.151">
      <tspan x="116.319" y="419.151">Application</tspan>
    </text>
    <text font-size="12.7998" style="fill: #000000; fill-opacity: 1; stroke: none;text-anchor:start;font-family:sans-serif;font-style:normal;font-weight:normal" x="201.525" y="608.691">
      <tspan x="201.525" y="608.691"></tspan>
    </text>
    <text font-size="12.7998" style="fill: #000000; fill-opacity: 1; stroke: none;text-anchor:start;font-family:sans-serif;font-style:normal;font-weight:normal" x="174.655" y="563.577">
      <tspan x="174.655" y="563.577">libssl.so</tspan>
    </text>
    <rect style="fill: #ffffff; fill-opacity: 1; stroke-opacity: 1; stroke-width: 2; stroke: #000000" x="130.638" y="572.345" width="136.472" height="16.9706" rx="0" ry="0"/>
    <text font-size="12.7998" style="fill: #000000; fill-opacity: 1; stroke: none;text-anchor:start;font-family:sans-serif;font-style:normal;font-weight:normal" x="175.539" y="585.78">
      <tspan x="175.539" y="585.78">libc.so</tspan>
    </text>
    <rect style="fill: #ffffff; fill-opacity: 1; stroke-opacity: 1; stroke-width: 2; stroke: #000000" x="129.754" y="595.963" width="136.472" height="16.9706" rx="0" ry="0"/>
    <text font-size="12.7998" style="fill: #000000; fill-opacity: 1; stroke: none;text-anchor:start;font-family:sans-serif;font-style:normal;font-weight:normal" x="174.655" y="609.398">
      <tspan x="174.655" y="609.398">libm.so</tspan>
    </text>
    <text font-size="12.7998" style="fill: #000000; fill-opacity: 1; stroke: none;text-anchor:start;font-family:sans-serif;font-style:normal;font-weight:normal" x="191.272" y="606.357">
      <tspan x="191.272" y="606.357"></tspan>
    </text>
    <rect style="fill: #ffffff; fill-opacity: 1; stroke-opacity: 1; stroke-width: 2; stroke: #000000" x="130.921" y="620.641" width="136.472" height="16.9706" rx="0" ry="0"/>
    <text font-size="12.7998" style="fill: #000000; fill-opacity: 1; stroke: none;text-anchor:start;font-family:sans-serif;font-style:normal;font-weight:normal" x="170.519" y="634.076">
      <tspan x="170.519" y="634.076">kernel api</tspan>
    </text>
    <text font-size="12.7998" style="fill: #000000; fill-opacity: 1; stroke: none;text-anchor:start;font-family:sans-serif;font-style:normal;font-weight:normal" x="185.969" y="627.924">
      <tspan x="185.969" y="627.924"></tspan>
    </text>
  </g>
  <g id="so_path">
    <g>
      <path style="fill: none; stroke-opacity: 1; stroke-width: 2; stroke: #000000" d="M 127.633,558.627 A 11.3637,11.3637 0 1 0 127.081,581.347"/>
      <polygon style="fill: #000000; fill-opacity: 1; stroke-opacity: 1; stroke-width: 2; stroke: #000000" fill-rule="evenodd" points="128.504,581.498 126.893,583.049 127.072,581.945 126.296,581.14 "/>
    </g>
    <text font-size="12.7998" style="fill: #000000; fill-opacity: 1; stroke: none;text-anchor:start;font-family:sans-serif;font-style:normal;font-weight:normal" x="66.2206" y="652.602">
      <tspan x="66.2206" y="652.602">The real close(2)is here.</tspan>
    </text>
    <g>
      <path style="fill: none; stroke-opacity: 1; stroke-width: 2; stroke: #000000" d="M 126.325,581.891 A 11.5051,11.5051 0 0 0 126.19,603.96"/>
      <polygon style="fill: #000000; fill-opacity: 1; stroke-opacity: 1; stroke-width: 2; stroke: #000000" fill-rule="evenodd" points="127.519,604.494 125.54,605.536 126.019,604.526 125.498,603.536 "/>
    </g>
    <g>
      <path style="fill: none; stroke-opacity: 1; stroke-width: 2; stroke: #000000" d="M 126.784,605.862 A 11.818,11.818 0 0 0 127.32,629.298"/>
      <polygon style="fill: #000000; fill-opacity: 1; stroke-opacity: 1; stroke-width: 2; stroke: #000000" fill-rule="evenodd" points="128.73,629.572 126.97,630.951 127.26,629.872 126.57,628.992 "/>
    </g>
  </g>
  <g id="Shim_preload">
    <rect style="fill: #ffffff; fill-opacity: 1; stroke-opacity: 1; stroke-width: 2; stroke: #000000" x="276.656" y="475.118" width="136.472" height="16.9706" rx="0" ry="0"/>
    <text font-size="12.7998" style="fill: #000000; fill-opacity: 1; stroke: none;text-anchor:start;font-family:sans-serif;font-style:normal;font-weight:normal" x="299.99" y="488.2">
      <tspan x="299.99" y="488.2">libsrshim.so</tspan>
    </text>
    <text font-size="12.7998" style="fill: #000000; fill-opacity: 1; stroke: none;text-anchor:start;font-family:sans-serif;font-style:normal;font-weight:normal" x="302.995" y="446.197">
      <tspan x="302.995" y="446.197"></tspan>
    </text>
    <text font-size="12.7998" style="fill: #000000; fill-opacity: 1; stroke: none;text-anchor:start;font-family:sans-serif;font-style:normal;font-weight:normal" x="260.569" y="391.397">
      <tspan x="260.569" y="391.397">LD_PRELOAD="libsrshim.so"</tspan>
    </text>
    <text font-size="12.7998" style="fill: #000000; fill-opacity: 1; stroke: none;text-anchor:start;font-family:sans-serif;font-style:normal;font-weight:normal" x="315.723" y="484.028">
      <tspan x="315.723" y="484.028"></tspan>
    </text>
    <text font-size="12.7998" style="fill: #000000; fill-opacity: 1; stroke: none;text-anchor:start;font-family:sans-serif;font-style:normal;font-weight:normal" x="341.886" y="564.284">
      <tspan x="341.886" y="564.284"></tspan>
    </text>
    <g>
      <path style="fill: none; stroke-opacity: 1; stroke-width: 2; stroke: #000000" d="M 247.487,424.631 A 53.2367,53.2367 0 0 1 303.223,460.535"/>
      <polygon style="fill: #000000; fill-opacity: 1; stroke-opacity: 1; stroke-width: 2; stroke: #000000" fill-rule="evenodd" points="305.146,467.673 298.749,458.503 304.059,460.252 308.644,457.054 "/>
    </g>
    <text font-size="12.7998" style="fill: #000000; fill-opacity: 1; stroke: none;text-anchor:start;font-family:sans-serif;font-style:normal;font-weight:normal" x="256.68" y="414.024">
      <tspan x="256.68" y="414.024">close(2)</tspan>
    </text>
    <g>
      <path style="fill: none; stroke-opacity: 1; stroke-width: 2; stroke: #000000" d="M 270.468,510.191 A 51.6673,51.6673 0 0 0 199.61,535.368"/>
      <polygon style="fill: #000000; fill-opacity: 1; stroke-opacity: 1; stroke-width: 2; stroke: #000000" fill-rule="evenodd" points="197.081,542.307 194.473,531.435 198.778,535.002 204.214,533.697 "/>
    </g>
    <text font-size="12.7998" style="fill: #000000; fill-opacity: 1; stroke: none;text-anchor:start;font-family:sans-serif;font-style:normal;font-weight:normal" x="283.903" y="505.594">
      <tspan x="283.903" y="505.594">"fake" close(2)</tspan>
      <tspan x="283.903" y="521.594">calls real one, then post</tspan>
    </text>
    <g>
      <path style="fill: none; stroke-opacity: 1; stroke-width: 2; stroke: #183dd5" d="M 293.555,527.798 A 61.4719,61.4719 0 0 0 342.566,592.804"/>
      <polygon style="fill: #183dd5; fill-opacity: 1; stroke-opacity: 1; stroke-width: 2; stroke: #183dd5" fill-rule="evenodd" points="349.905,593.884 339.695,598.44 342.413,593.555 340.135,588.45 "/>
    </g>
    <text font-size="12.7998" style="fill: #000000; fill-opacity: 1; stroke: none;text-anchor:start;font-family:sans-serif;font-style:normal;font-weight:normal" x="339.765" y="614.489">
      <tspan x="339.765" y="614.489">AMQP message</tspan>
      <tspan x="339.765" y="630.489">posted to </tspan>
      <tspan x="339.765" y="646.489">rabbitmq broker</tspan>
    </text>
  </g>
</svg>
