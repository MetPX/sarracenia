<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Releasing MetPX-Sarracenia &mdash; Sarracenia 3.00.54rc1 documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=19f00094" />

  
    <link rel="shortcut icon" href="../_static/sarra_horror_culture_favicon.png"/>
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../_static/jquery.js?v=5d32c60e"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="../_static/documentation_options.js?v=99fb584f"></script>
        <script src="../_static/doctools.js?v=9a2dae69"></script>
        <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="SR3_TITLE" href="man_page_template.html" />
    <link rel="prev" title="Documentation Standards" href="Documentation.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            Sarracenia
              <img src="../_static/sarra_horror_culture_w200.png" class="logo" alt="Logo"/>
          </a>
              <div class="version">
                3.00.54rc1
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../Explanation/Overview.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Tutorials/index.html">Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../How2Guides/index.html">HOWTOS</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Explanation/index.html">Explanation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Reference/index.html">Reference</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Contributing</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="AMQPprimer.html">AMQP - Primer for Sarracenia</a></li>
<li class="toctree-l2"><a class="reference internal" href="Development.html">MetPX-Sarracenia Developer’s Guide</a></li>
<li class="toctree-l2"><a class="reference internal" href="Documentation.html">Documentation Standards</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Releasing MetPX-Sarracenia</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#pre-release-overview">Pre-Release Overview</a></li>
<li class="toctree-l3"><a class="reference internal" href="#stable-release-process">Stable Release Process</a></li>
<li class="toctree-l3"><a class="reference internal" href="#details">Details</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#quality-assurance">Quality Assurance</a></li>
<li class="toctree-l4"><a class="reference internal" href="#versioning-scheme">Versioning Scheme</a></li>
<li class="toctree-l4"><a class="reference internal" href="#set-the-version">Set the Version</a></li>
<li class="toctree-l4"><a class="reference internal" href="#git-branches-for-pre-release">Git Branches for Pre-release</a></li>
<li class="toctree-l4"><a class="reference internal" href="#build-python3-6-compatbile-branch">Build Python3.6 Compatbile Branch</a></li>
<li class="toctree-l4"><a class="reference internal" href="#pypi">PyPi</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#launchpad">Launchpad</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#repositories-recipes">Repositories &amp; Recipes</a></li>
<li class="toctree-l4"><a class="reference internal" href="#automated-build">Automated Build</a></li>
<li class="toctree-l4"><a class="reference internal" href="#daily-builds">Daily Builds</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#building-a-windows-installer">Building a Windows Installer</a></li>
<li class="toctree-l3"><a class="reference internal" href="#github">github</a></li>
<li class="toctree-l3"><a class="reference internal" href="#troubleshooting">Troubleshooting</a></li>
<li class="toctree-l3"><a class="reference internal" href="#ubuntu-18">ubuntu 18</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="man_page_template.html">SR3_TITLE</a></li>
<li class="toctree-l2"><a class="reference internal" href="mqtt_issues.html">MQTT Implementation Notes</a></li>
<li class="toctree-l2"><a class="reference internal" href="v03.html">Version 3 Refactor</a></li>
<li class="toctree-l2"><a class="reference internal" href="on_part_assembly.html">File Re-assembling</a></li>
<li class="toctree-l2"><a class="reference internal" href="Evolution.html">Design Changes since Original (2015)</a></li>
<li class="toctree-l2"><a class="reference internal" href="BasicIdea.html">Original (2015) Basic Idea</a></li>
<li class="toctree-l2"><a class="reference internal" href="Design.html">Original (2015) Design</a></li>
<li class="toctree-l2"><a class="reference internal" href="deltas.html">Discussion of File Modification Propagation</a></li>
<li class="toctree-l2"><a class="reference internal" href="Philosophy/index.html">Philosophy</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../api-documentation.html">API Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fr/index.html">En français</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Sarracenia</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="index.html">Contributing</a></li>
      <li class="breadcrumb-item active">Releasing MetPX-Sarracenia</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/Contribution/Release.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="releasing-metpx-sarracenia">
<h1>Releasing MetPX-Sarracenia<a class="headerlink" href="#releasing-metpx-sarracenia" title="Link to this heading"></a></h1>
<dl class="field-list simple">
<dt class="field-odd">version<span class="colon">:</span></dt>
<dd class="field-odd"><p>3.00.54rc1</p>
</dd>
<dt class="field-even">date<span class="colon">:</span></dt>
<dd class="field-even"><p>Jun 17, 2024</p>
</dd>
</dl>
<section id="pre-release-overview">
<h2>Pre-Release Overview<a class="headerlink" href="#pre-release-overview" title="Link to this heading"></a></h2>
<p>MetPX-Sarracenia is distributed in a few different ways, and each has it’s own build process.
Packaged releases are always preferable to one off builds, because they are reproducible.</p>
<p>To publish a pre-release one needs to:</p>
<ul class="simple">
<li><p>starting with the development branch (for sr3) or v2_dev (for v2.)</p></li>
<li><p>run QA process on all operating systems looking for regressions on older 3.6-based ones.</p>
<ul>
<li><p>github runs flow tests for ubuntu 20.04 and 22.04, review those results.</p></li>
<li><p>github runs unit tests (only work on newer python versions.), review those results.</p></li>
<li><p>find ubuntu 18.04 server. build local package, run flow tests.</p></li>
<li><p>find redhat 8 server.  build package: <em>python3 setup.py bdist_rpm</em>, run flow tests</p></li>
<li><p>find redhat 9 server,  build package: <em>python3 -m build –no-isolation</em>. run flow tests</p></li>
</ul>
</li>
<li><p>review debian/changelog and update it based on all merges to the branch since previous release.</p></li>
<li><p>Set the pre-release tag.</p></li>
<li><p>commit the above.</p></li>
<li><p>pypi.org</p>
<ul>
<li><p>to ensure compatiblity with python3.6, update a python3.6 branch (for redhat 8 and/or ubuntu 18.)</p></li>
<li><p>use the python3.6 branch to release to pypi (because upward compatibility works, but not downward.)</p></li>
<li><p>upload the pre-release so that installation with pip succeeds.</p></li>
</ul>
</li>
<li><p>launchpad.org:</p>
<ul>
<li><dl class="simple">
<dt>ensure the two branches are ready on github.</dt><dd><ul>
<li><p>pre-release branch ready.</p></li>
<li><p>pre-release_py36 branch ready.</p></li>
</ul>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>update git repository (Import now): <a class="reference external" href="https://code.launchpad.net/~ssc-hpc-chp-spc/metpx-sarracenia/+git/trunk">https://code.launchpad.net/~ssc-hpc-chp-spc/metpx-sarracenia/+git/trunk</a></dt><dd><ul>
<li><p>do: <strong>Import Now</strong></p></li>
</ul>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>run the recipe for old OS (18.04, 20.04) <a class="reference external" href="https://code.launchpad.net/~ssc-hpc-chp-spc/+recipe/metpx-sr3-pre-release-old">https://code.launchpad.net/~ssc-hpc-chp-spc/+recipe/metpx-sr3-pre-release-old</a></dt><dd><ul>
<li><p>do: <strong>Request Build</strong> (on Focal and Bionic )</p></li>
</ul>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>run the recipe for new OS (22.04, 24.04) <a class="reference external" href="https://code.launchpad.net/~ssc-hpc-chp-spc/+recipe/metpx-sr3-pre-release">https://code.launchpad.net/~ssc-hpc-chp-spc/+recipe/metpx-sr3-pre-release</a></dt><dd><ul>
<li><p>do: <strong>Request Build</strong> (on Jammy and Noble at least)</p></li>
</ul>
</dd>
</dl>
</li>
</ul>
</li>
<li><p>build redhat packages.</p>
<ul>
<li><p>find redhat 8 server.  build package: python3 setup.py bdist_rpm</p></li>
<li><p>find redhat 9 server,  build package: python3 -m build –no-isolation</p></li>
</ul>
</li>
<li><p>on github: Draft a release.</p>
<ul>
<li><p>create release notes as prompted.</p></li>
<li><p>copy the installation instructions from a previous release (for mostly ubuntu.)</p></li>
<li><p>attach:
- wheel built on python3.6 on ubuntu 18 (the uploaded to pypi.org)
- windows binary.
- redhat 8 and 9 rpms labelled as such.</p></li>
</ul>
</li>
<li><p>encourage testing of pre-release, wait some time for blockers, if any.</p></li>
</ul>
</section>
<section id="stable-release-process">
<h2>Stable Release Process<a class="headerlink" href="#stable-release-process" title="Link to this heading"></a></h2>
<p>A Stable version is just a pre-release version that has been
re-tagged as stable after some period of waiting for issues
to arise. Since all the testing was done for the pre-release,
the stable release does not require any explicit testing.</p>
<ul>
<li><p>merge from pre-release to stable:</p>
<p>git checkout stable
git merge pre-release
# there will be conflicts here for debian/changelog and sarracenia/_version.py
# for changelog:
#   - merge all the rcX changelogs into a single stable one.
#   - ensure the version at the top is correct and tagged ‘unstable’
#   - edit the signature at the bottom for reflect who you are, and current date.
# for sarracenia/_version.py
#   - fix it so it shows the correct stable version.
git tag -a v3.xx.yy -m “v3.xx.yy”
git push origin v3.xx.yy</p>
</li>
<li><p>merge from pre-release_py36 to stable_py36:</p>
<p>git checkout stable_py36
git merge pre-release_py36
# same editing required as above.
git tag -a o3.xx.yy -m “o3.xx.yy”
git push origin v3.xx.yy</p>
</li>
<li><p>go on Launchpad,</p>
<blockquote>
<div><ul class="simple">
<li><p>stable branch ready.</p></li>
<li><p>stable_py36 branch ready.</p></li>
<li><p><a class="reference external" href="https://code.launchpad.net/~ssc-hpc-chp-spc/metpx-sarracenia/+git/trunk">https://code.launchpad.net/~ssc-hpc-chp-spc/metpx-sarracenia/+git/trunk</a></p></li>
<li><p>do: <strong>Import Now</strong></p></li>
<li><p><a class="reference external" href="https://code.launchpad.net/~ssc-hpc-chp-spc/+recipe/metpx-sr3-old">https://code.launchpad.net/~ssc-hpc-chp-spc/+recipe/metpx-sr3-old</a></p></li>
<li><p>do: <strong>Request Build</strong> (on Focal and Bionic )</p></li>
<li><p><a class="reference external" href="https://code.launchpad.net/~ssc-hpc-chp-spc/+recipe/metpx-sr3">https://code.launchpad.net/~ssc-hpc-chp-spc/+recipe/metpx-sr3</a></p></li>
<li><p>do: <strong>Request Build</strong> (on Jammy and Noble at least)</p></li>
</ul>
</div></blockquote>
</li>
<li><p>go on ubuntu 18.04, build bdist_wheel:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">git</span> <span class="n">checkout</span> <span class="n">stable_py36</span>
<span class="n">python3</span> <span class="n">setup</span><span class="o">.</span><span class="n">py</span> <span class="n">bdist_wheel</span>
</pre></div>
</div>
</li>
</ul>
<p>note that <em>pip3 install wheel</em> is needed, because the one from
ubuntu 18 is not compatible with the current pypi.org.</p>
<ul>
<li><p>go on redhat 8, build rpm:</p>
<p>git checkout stable_py36
python3 setup.py bdist_rpm</p>
</li>
<li><p>go on redhat 9, build rpm:</p>
<p>git checkout stable_py36
rpmbuild –build-in-place -bb metpx-sr3.spec</p>
</li>
<li><p>On github.com, create release.</p>
<ul class="simple">
<li><p>copy/paste install procedure from a previous release, adjust</p></li>
<li><p>attach wheel build on ubuntu 18.</p></li>
<li><p>attach redhat 8 rpm</p></li>
<li><p>attach redhat 9 rpm</p></li>
<li><p>attach windows exe</p></li>
</ul>
</li>
</ul>
</section>
<section id="details">
<h2>Details<a class="headerlink" href="#details" title="Link to this heading"></a></h2>
<section id="quality-assurance">
<h3>Quality Assurance<a class="headerlink" href="#quality-assurance" title="Link to this heading"></a></h3>
<p>The Quality Assurance (QA) process, occurs mainly on the development branch.
prior to accepting a release, and barring known exceptions,</p>
<ul class="simple">
<li><p>QA tests automatically triggerred by pushes to the development branch should all pass.
(All related github actions.)
tests: static, no_mirror, flakey_broker, restart_server, dynamic_flow are included in “flow.yml”</p></li>
<li><p>build an ubuntu 18.04 vm and run the flow tests there to ensure that it works.
(installation method: cloning from development on github.)
tests: static, no_mirror, flakey_broker, restart_server, dynamic_flow</p></li>
<li><p>build a redhat 8 vm and run the flow test there to ensure that it works.
(installation method: cloning from development on github.)
tests: static, no_mirror, flakey_broker, restart_server, dynamic_flow</p></li>
<li><p>build a redhat 9 vm and run the flow test there to ensure that it works.</p></li>
<li><p>build a windows executable… test?</p></li>
</ul>
<p>For extensive discussion see:  <a class="reference external" href="https://github.com/MetPX/sarracenia/issues/139">https://github.com/MetPX/sarracenia/issues/139</a></p>
<p>Once the above are done, the pre-release process can proceed.</p>
</section>
<section id="versioning-scheme">
<h3>Versioning Scheme<a class="headerlink" href="#versioning-scheme" title="Link to this heading"></a></h3>
<p>Each release will be versioned as <code class="docutils literal notranslate"><span class="pre">&lt;version&gt;.&lt;YY&gt;.&lt;MM&gt;</span> <span class="pre">&lt;segment&gt;</span></code></p>
<p>It is difficult to reconcile debian and python versioning conventions.
We use rcX for pre-releases which work in both contexts.</p>
<p>Where:</p>
<ul class="simple">
<li><p><strong>Version</strong> is the application version. Currently, 2 and 3 exist.</p></li>
<li><p><strong>YY</strong> is the last two digits of the year of the initial release in the series.</p></li>
<li><p><strong>MM</strong> is a TWO digit month number i.e. for April: 04.</p></li>
<li><p><strong>segment</strong> is what would be used within a series.
from pep0440:
X.YrcN  # Release Candidate
X.Y     # Final release
X.ypN   #ack! patched release.</p></li>
</ul>
<p>Currently, 3.00 is still stabilizing, so the year/month convention is not being applied.
Releases are currently  3.00.iircj
where:</p>
<blockquote>
<div><ul class="simple">
<li><p>ii – incremental number of pre-releases of 3.00</p></li>
<li><p>j – beta increment.</p></li>
</ul>
</div></blockquote>
<p>The first alpha release of v2 from January 2016 would be versioned
as <code class="docutils literal notranslate"><span class="pre">metpx-sarracenia-2.16.01a01</span></code>. A sample v3 is v3.00.52rc2. At some point 3.00
will be complete &amp; solid enough that the we will resume the year/month convention.</p>
<p>Final versions have no suffix and are considered stable and supported.
Stable should receive bug-fixes if necessary from time to time.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If you change default settings for exchanges / queues  as
part of a new version, keep in mind that all components have to use
the same settings or the bind will fail, and they will not be able
to connect. If a new version declares different queue or exchange
settings, then the simplest means of upgrading (preserving data) is to
drain the queues prior to upgrading, for example by
setting, the access to the resource will not be granted by the server.
(??? perhaps there is a way to get access to a resource as is… no declare)
(??? should be investigated)</p>
<p>Changing the default requires the removal and recreation of the resource.
This has a major impact on processes…</p>
</div>
</section>
<section id="set-the-version">
<h3>Set the Version<a class="headerlink" href="#set-the-version" title="Link to this heading"></a></h3>
<p>This is done to <em>start</em> development on a version. It should be done on development
after every release.</p>
<ul class="simple">
<li><p>git checkout development</p></li>
<li><p>Edit <code class="docutils literal notranslate"><span class="pre">sarracenia/_version.py</span></code> manually and set the version number.</p></li>
<li><p>Edit CHANGES.rst to add a section for the version.</p></li>
<li><p>run dch to start the changelog for the current version.
* change <em>unstable</em> to <em>UNRELEASED</em> (maybe done automatically by dch.)</p></li>
<li><p>git commit -a</p></li>
<li><p>git push</p></li>
</ul>
</section>
<section id="git-branches-for-pre-release">
<h3>Git Branches for Pre-release<a class="headerlink" href="#git-branches-for-pre-release" title="Link to this heading"></a></h3>
<p>Prior to releasing, ensure that all QA tests in the section above are passed.
When development for a version is complete. The following should occur:</p>
<p>A tag should be created to identify the end of the cycle:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">git</span> <span class="n">checkout</span> <span class="n">development</span>
<span class="n">git</span> <span class="n">tag</span> <span class="o">-</span><span class="n">a</span> <span class="n">v3</span><span class="mf">.16.01</span><span class="n">rc1</span> <span class="o">-</span><span class="n">m</span> <span class="s2">&quot;release 3.16.01rc1&quot;</span>
<span class="n">git</span> <span class="n">push</span>
<span class="n">git</span> <span class="n">push</span> <span class="n">origin</span> <span class="n">v3</span><span class="mf">.16.01</span><span class="n">rc1</span>
</pre></div>
</div>
<p>Once the tag is in the development branch, promote it to stable:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">git</span> <span class="n">checkout</span> <span class="n">pre</span><span class="o">-</span><span class="n">release</span>
<span class="n">git</span> <span class="n">merge</span> <span class="n">development</span>
<span class="n">git</span> <span class="n">push</span>
</pre></div>
</div>
<p>Once stable is updated on github, the docker images will be automatically upgraded, but
we then need to update the various distribution methods: <a class="reference internal" href="#pypi">PyPI</a>, and <a class="reference internal" href="#launchpad">Launchpad</a></p>
<p>Once package generation is complete, one should <a class="reference internal" href="#set-the-version">Set the Version</a>
in development to the next logical increment to ensure no further development
occurs that is identified as the released version.</p>
</section>
<section id="build-python3-6-compatbile-branch">
<h3>Build Python3.6 Compatbile Branch<a class="headerlink" href="#build-python3-6-compatbile-branch" title="Link to this heading"></a></h3>
<p>Canonical, the company behind Ubuntu, provides Launchpad as a means of enabling third parties to build
packages for their operating system releases. It turns out that the newer OS versions have dependencies
that are not available on the old ones. So the development branch is configured to build on newer
releases, but an a separate branch must be created when creating releases for ubuntu bionic (18.04) and
focal (20.04.) The same branch can be used to build on redhat 8 (another distro that uses python 3.6)</p>
<p>Post python 3.7.?, the installatiion method changes from the obsolete setup.py to use pyproject.toml,
and the <em>hatch</em> python tools. Prior to that version, hatchling is not supported, so setup.py must be used.
However the presence of pyproject.toml fools the setup.py into thinking it can install it.  To
get a correct installation one must:</p>
<ul class="simple">
<li><p>remove pyproject.toml (because setup.py gets confused.)</p></li>
<li><p>remove “pybuild-plugin-prproject” dep from debuan</p></li>
</ul>
<p>in detail:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># on ubuntu 18.04 or redhat 8 (or some other release with python 3.6 )</span>

<span class="n">git</span> <span class="n">checkout</span> <span class="n">pre</span><span class="o">-</span><span class="n">release</span>
<span class="n">git</span> <span class="n">branch</span> <span class="o">-</span><span class="n">D</span> <span class="n">pre</span><span class="o">-</span><span class="n">release_py36</span>
<span class="n">git</span> <span class="n">branch</span> <span class="n">stable_py36</span>
<span class="n">git</span> <span class="n">checkout</span> <span class="n">stable_py36</span>
<span class="n">vi</span> <span class="n">debian</span><span class="o">/</span><span class="n">control</span>
<span class="c1"># remove pybuild-plugin-pyproject from the &quot;Build-Depends&quot;</span>
<span class="n">git</span> <span class="n">rm</span> <span class="n">pyproject</span><span class="o">.</span><span class="n">toml</span>
<span class="c1"># remove the new-style installer to force use of setup.py</span>
<span class="n">git</span> <span class="n">commit</span> <span class="o">-</span><span class="n">a</span> <span class="o">-</span><span class="n">m</span> <span class="s2">&quot;adjust for older os&quot;</span>
</pre></div>
</div>
<p>There might be a “–force” required at some point. Perhaps something along the lines of:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">git</span> <span class="n">push</span> <span class="n">origin</span> <span class="n">stable_py36</span> <span class="o">--</span><span class="n">force</span>
</pre></div>
</div>
<p>Then proceed with Launchpad instructions.</p>
</section>
<section id="pypi">
<h3>PyPi<a class="headerlink" href="#pypi" title="Link to this heading"></a></h3>
<p>Because python packages are upward compatible, but not downward, build them on ubuntu 18.04
(oldest supported python &amp; OS version.) in order for pip installs to work on the widest number
of systems.</p>
<p>for local installation on a computer with a python 3.6 for testing and development:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">python3</span> <span class="n">setup</span><span class="o">.</span><span class="n">py</span> <span class="n">bdist_wheel</span>
</pre></div>
</div>
<p>or… on newer systems, using build instead:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">python3</span> <span class="o">-</span><span class="n">m</span> <span class="n">build</span> <span class="o">--</span><span class="n">no</span><span class="o">-</span><span class="n">isolation</span>
</pre></div>
</div>
<p>Pypi does not distinguish between older and newer python releases. There is only one package
version for all supported versions. When uploading from a new OS, the versions in use on the
OS are inferred to be the minimum, and so installation on older operating systems may be blocked
by generated dependencies on overly modern versions.</p>
<p>So when uploading to pypi, always do so from the oldest operating system where it needs to work.
upward compatibility is more likely than downward.</p>
<p>Pypi Credentials go in ~/.pypirc.  Sample Content:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">pypi</span><span class="p">]</span>
<span class="n">username</span><span class="p">:</span> <span class="n">SupercomputingGCCA</span>
<span class="n">password</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">get</span> <span class="n">this</span> <span class="kn">from</span> <span class="nn">someone</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>Assuming pypi upload credentials are in place, uploading a new release used to be a one liner:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">python3</span> <span class="n">setup</span><span class="o">.</span><span class="n">py</span> <span class="n">bdist_wheel</span> <span class="n">upload</span>
</pre></div>
</div>
<p>on older systems, or on (python &gt;= 3.7) newer ones:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">twine</span> <span class="n">upload</span> <span class="n">dist</span><span class="o">/</span><span class="n">metpx_sarracenia</span><span class="o">-</span><span class="mf">2.22.6</span><span class="o">-</span><span class="n">py3</span><span class="o">-</span><span class="n">none</span><span class="o">-</span><span class="nb">any</span><span class="o">.</span><span class="n">whl</span> <span class="n">dist</span><span class="o">/</span><span class="n">metpx_sarracenia</span><span class="o">-</span><span class="mf">2.22.6</span><span class="o">.</span><span class="n">tar</span><span class="o">.</span><span class="n">gz</span>
</pre></div>
</div>
<p>Should always include source (the .tar.gz file)
Note that the CHANGES.rst file is in restructured text and is parsed by pypi.python.org
on upload.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>When uploading pre-release packages (alpha,beta, or RC) PYpi does not serve those to users by default.
For seamless upgrade, early testers need to do supply the <code class="docutils literal notranslate"><span class="pre">--pre</span></code> switch to pip:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pip3</span> <span class="n">install</span> <span class="o">--</span><span class="n">upgrade</span> <span class="o">--</span><span class="n">pre</span> <span class="n">metpx</span><span class="o">-</span><span class="n">sarracenia</span>
</pre></div>
</div>
<p>On occasion you may wish to install a specific version:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pip3</span> <span class="n">install</span> <span class="o">--</span><span class="n">upgrade</span> <span class="n">metpx</span><span class="o">-</span><span class="n">sarracenia</span><span class="o">==</span><span class="mf">2.16.03</span><span class="n">a9</span>
</pre></div>
</div>
<p>command line use of setup.py is deprecated.  Replaced by build and twine.</p>
</div>
</section>
</section>
<section id="launchpad">
<h2>Launchpad<a class="headerlink" href="#launchpad" title="Link to this heading"></a></h2>
<p>Generalities about using Launchpad for MetPX-Sarracenia.</p>
<section id="repositories-recipes">
<h3>Repositories &amp; Recipes<a class="headerlink" href="#repositories-recipes" title="Link to this heading"></a></h3>
<p>For Ubuntu operating systems, the launchpad.net site is the best way to provide packages that are fully integrated
( built against current patch levels of all dependencies (software components that Sarracenia relies
on to provide full functionality.)) Ideally, when running a server, a one should use one of the repositories,
and allow automated patching to upgrade them as needed.</p>
<p>Before every build of any package, it is important to update the git repo mirror on launchpad.</p>
<ul class="simple">
<li><p><a class="reference external" href="https://code.launchpad.net/~ssc-hpc-chp-spc/metpx-sarracenia/+git/trunk">https://code.launchpad.net/~ssc-hpc-chp-spc/metpx-sarracenia/+git/trunk</a></p></li>
<li><p>do: <strong>Import Now</strong></p></li>
</ul>
<p>Wait until this completes.</p>
<p>Repositories:</p>
<ul class="simple">
<li><p>Daily <a class="reference external" href="https://launchpad.net/~ssc-hpc-chp-spc/+archive/ubuntu/metpx-daily">https://launchpad.net/~ssc-hpc-chp-spc/+archive/ubuntu/metpx-daily</a> (living on dev… )
should, in principle, be always ok, but regressions happen, and not all testing is done prior to every
commit to dev branches.
Recipes:</p>
<ul>
<li><p>metpx-sr3-daily – automated daily build of sr3 packages happens from <em>development</em> branch.</p></li>
<li><p>metpx-sarracenia-daily – automated daily build of v2 packages happens from <em>v2_dev</em> branch</p></li>
</ul>
</li>
<li><p>Pre-Release <a class="reference external" href="https://launchpad.net/~ssc-hpc-chp-spc/+archive/ubuntu/metpx-pre-release">https://launchpad.net/~ssc-hpc-chp-spc/+archive/ubuntu/metpx-pre-release</a> (for newest features.)
from <em>development</em> branch. Developers manually trigger builds here when it seems appropriate (testing out
code that is ready for release.)</p>
<ul>
<li><p>metpx-sr3-pre-release – on demand build sr3 packages from pre-release branch.</p></li>
<li><p>metpx-sr3-pre-release-old – on demand build sr3 packages from <em>pre-release_py36</em> branch.</p></li>
<li><p>metpx-sarracenia-pre-release – on demand build sr3 packages from <em>v2_dev</em> branch.</p></li>
</ul>
</li>
<li><p>Release <a class="reference external" href="https://launchpad.net/~ssc-hpc-chp-spc/+archive/ubuntu/metpx">https://launchpad.net/~ssc-hpc-chp-spc/+archive/ubuntu/metpx</a> (for maximum stability)
from <em>v2_stable</em> branch.  After testing in systems subscribed to pre-releases, Developers
merge from v2_dev branch into v2_stable one, and manually trigger a build.</p>
<ul>
<li><p>metpx-sr3 – on demand build sr3 packages from <em>stable</em> branch.</p></li>
<li><p>metpx-sr3-old – on demand build sr3 packages from <em>stable_py36</em> branch.</p></li>
<li><p>metpx-sarracenia-release – on deman build v2 packages from <em>v2_stable</em> branch.</p></li>
</ul>
</li>
</ul>
<p>for more discussion see <a class="reference external" href="https://github.com/MetPX/sarracenia/issues/139">Which Version is stable</a></p>
</section>
<section id="automated-build">
<h3>Automated Build<a class="headerlink" href="#automated-build" title="Link to this heading"></a></h3>
<ul class="simple">
<li><p>Ensure the code mirror is updated by checking the <strong>Import details</strong> by checking <a class="reference external" href="https://code.launchpad.net/~ssc-hpc-chp-spc/metpx-sarracenia/+git/trunk">this page for sarracenia</a></p></li>
<li><p>if the code is out of date, do <strong>Import Now</strong> , and wait a few minutes while it is updated.</p></li>
<li><p>once the repository is upto date, proceed with the build request.</p></li>
<li><p>Go to the <a class="reference external" href="https://code.launchpad.net/~ssc-hpc-chp-spc/+recipe/sarracenia-release">sarracenia release</a> recipe</p></li>
<li><p>Go to the <a class="reference external" href="https://code.launchpad.net/~ssc-hpc-chp-spc/+recipe/metpx-sr3-release">sr3 release</a> recipe</p></li>
<li><p>Click on the <strong>Request build(s)</strong> button to create a new release</p></li>
<li><p>for Sarrac, follow the procedure <a class="reference external" href="https://github.com/MetPX/sarrac#release-process">here</a></p></li>
<li><p>The built packages will be available in the <a class="reference external" href="https://launchpad.net/~ssc-hpc-chp-spc/+archive/ubuntu/metpx">metpx ppa</a></p></li>
</ul>
</section>
<section id="daily-builds">
<h3>Daily Builds<a class="headerlink" href="#daily-builds" title="Link to this heading"></a></h3>
<p>Daily builds are configured
using <a class="reference external" href="https://code.launchpad.net/~ssc-hpc-chp-spc/+recipe/sarracenia-daily">this recipe for python</a>
and <a class="reference external" href="https://code.launchpad.net/~ssc-hpc-chp-spc/+recipe/metpx-sarrac-daily">this recipe for C</a> and
are run once per day when changes to the repository occur. These packages are stored in the <a class="reference external" href="https://launchpad.net/~ssc-hpc-chp-spc/+archive/ubuntu/metpx-daily">metpx-daily ppa</a>.
One can also <strong>Request build(s)</strong> on demand if desired.</p>
<section id="manual-process">
<h4>Manual Process<a class="headerlink" href="#manual-process" title="Link to this heading"></a></h4>
<p>The process for manually publishing packages to Launchpad ( <a class="reference external" href="https://launchpad.net/~ssc-hpc-chp-spc">https://launchpad.net/~ssc-hpc-chp-spc</a> )
involves a more complex set of steps, and so the convenient script <code class="docutils literal notranslate"><span class="pre">publish-to-launchpad.sh</span></code> will
be the easiest way to do that. Currently the only supported releases are <strong>trusty</strong> and <strong>xenial</strong>.
So the command used is:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">publish</span><span class="o">-</span><span class="n">to</span><span class="o">-</span><span class="n">launchpad</span><span class="o">.</span><span class="n">sh</span> <span class="n">sarra</span><span class="o">-</span><span class="n">v2</span><span class="mf">.15.12</span><span class="n">a1</span> <span class="n">trusty</span> <span class="n">xenial</span>
</pre></div>
</div>
<p>However, the steps below are a summary of what the script does:</p>
<ul>
<li><p>for each distribution (precise, trusty, etc) update <code class="docutils literal notranslate"><span class="pre">debian/changelog</span></code> to reflect the distribution</p></li>
<li><p>build the source package using:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">debuild</span> <span class="o">-</span><span class="n">S</span> <span class="o">-</span><span class="n">uc</span> <span class="o">-</span><span class="n">us</span>
</pre></div>
</div>
</li>
<li><p>sign the <code class="docutils literal notranslate"><span class="pre">.changes</span></code> and <code class="docutils literal notranslate"><span class="pre">.dsc</span></code> files:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">debsign</span> <span class="o">-</span><span class="n">k</span><span class="o">&lt;</span><span class="n">key</span> <span class="nb">id</span><span class="o">&gt;</span> <span class="o">&lt;.</span><span class="n">changes</span> <span class="n">file</span><span class="o">&gt;</span>
</pre></div>
</div>
</li>
<li><p>upload to launchpad:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">dput</span> <span class="n">ppa</span><span class="p">:</span><span class="n">ssc</span><span class="o">-</span><span class="n">hpc</span><span class="o">-</span><span class="n">chp</span><span class="o">-</span><span class="n">spc</span><span class="o">/</span><span class="n">metpx</span><span class="o">-&lt;</span><span class="n">dist</span><span class="o">&gt;</span> <span class="o">&lt;.</span><span class="n">changes</span> <span class="n">file</span><span class="o">&gt;</span>
</pre></div>
</div>
</li>
</ul>
<p><strong>Note:</strong> The GPG keys associated with the launchpad account must be configured
in order to do the last two steps.</p>
</section>
<section id="backporting-a-dependency">
<h4>Backporting a Dependency<a class="headerlink" href="#backporting-a-dependency" title="Link to this heading"></a></h4>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">backportpackage</span> <span class="o">-</span><span class="n">k</span><span class="o">&lt;</span><span class="n">key</span> <span class="nb">id</span><span class="o">&gt;</span> <span class="o">-</span><span class="n">s</span> <span class="n">bionic</span> <span class="o">-</span><span class="n">d</span> <span class="n">xenial</span> <span class="o">-</span><span class="n">u</span> <span class="n">ppa</span><span class="p">:</span><span class="n">ssc</span><span class="o">-</span><span class="n">hpc</span><span class="o">-</span><span class="n">chp</span><span class="o">-</span><span class="n">spc</span><span class="o">/</span><span class="n">ubuntu</span><span class="o">/</span><span class="n">metpx</span><span class="o">-</span><span class="n">daily</span> <span class="n">librabbitmq</span>
</pre></div>
</div>
</section>
<section id="building-an-rpm">
<h4>Building an RPM<a class="headerlink" href="#building-an-rpm" title="Link to this heading"></a></h4>
<p>This process is currently a bit clumsy, but it can provide usable RPM packages.
Example of creating a multipass image for fedora to build with:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">fractal</span><span class="o">%</span> <span class="n">multipass</span> <span class="n">launch</span> <span class="o">-</span><span class="n">m</span> <span class="mi">8</span><span class="n">g</span> <span class="o">--</span><span class="n">name</span> <span class="n">fed34</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">mirror</span><span class="o">.</span><span class="n">csclub</span><span class="o">.</span><span class="n">uwaterloo</span><span class="o">.</span><span class="n">ca</span><span class="o">/</span><span class="n">fedora</span><span class="o">/</span><span class="n">linux</span><span class="o">/</span><span class="n">releases</span><span class="o">/</span><span class="mi">34</span><span class="o">/</span><span class="n">Cloud</span><span class="o">/</span><span class="n">x86_64</span><span class="o">/</span><span class="n">images</span><span class="o">/</span><span class="n">Fedora</span><span class="o">-</span><span class="n">Cloud</span><span class="o">-</span><span class="n">Base</span><span class="o">-</span><span class="mi">34</span><span class="o">-</span><span class="mf">1.2</span><span class="o">.</span><span class="n">x86_64</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">xz</span>
<span class="n">Launched</span><span class="p">:</span> <span class="n">fed34</span>
<span class="n">fractal</span><span class="o">%</span>
</pre></div>
</div>
<p>Based on <a class="reference external" href="https://www.redhat.com/sysadmin/create-rpm-package">https://www.redhat.com/sysadmin/create-rpm-package</a> …  install build-dependencies:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sudo</span> <span class="n">dnf</span> <span class="n">install</span> <span class="o">-</span><span class="n">y</span> <span class="n">rpmdevtools</span> <span class="n">rpmlint</span> <span class="n">git</span>
<span class="n">git</span> <span class="n">clone</span> <span class="o">-</span><span class="n">b</span> <span class="n">development</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">github</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">MetPX</span><span class="o">/</span><span class="n">sarracenia</span> <span class="n">sr3</span>
<span class="n">cd</span> <span class="n">sr3</span>
</pre></div>
</div>
<p>One can build a very limited sort of rpm package on an rpm based distro by
The names of the package for file magic data (to determin file types) has different names on
ubuntu vs. redhat.  The last three lines of <strong>dependencies</strong> in pyproject.toml are about
“python-magic”, but on redhat/fedora &gt;= 9, it needs to be “file-magic” instead:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># remove last three lines of dependencies in setup.py</span>

<span class="o">*</span> <span class="n">on</span> <span class="n">redhat</span> <span class="o">&lt;=</span><span class="mi">8</span><span class="p">:</span> <span class="n">vi</span> <span class="n">setup</span><span class="o">.</span><span class="n">py</span> <span class="p">;</span>  <span class="n">python3</span> <span class="n">setup</span><span class="o">.</span><span class="n">py</span> <span class="n">bdist_rpm</span>

<span class="c1"># might work, but might need some removals also.</span>
<span class="o">*</span> <span class="n">on</span> <span class="n">redhat</span> <span class="o">&gt;=</span><span class="mi">9</span><span class="p">:</span> <span class="n">vi</span> <span class="n">pyproject</span><span class="o">.</span><span class="n">toml</span><span class="p">;</span>  <span class="n">python3</span> <span class="o">-</span><span class="n">m</span> <span class="n">build</span>
</pre></div>
</div>
<p>“python-magic”, but on redhat, it needs to be “file-magic” instead:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">vi</span> <span class="n">pyproject</span><span class="o">.</span><span class="n">toml</span>
</pre></div>
</div>
<p>using the normal (for Redhat) rpmbuild tool:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">rpmbuild</span> <span class="o">--</span><span class="n">build</span><span class="o">-</span><span class="ow">in</span><span class="o">-</span><span class="n">place</span> <span class="o">-</span><span class="n">bb</span> <span class="n">metpx</span><span class="o">-</span><span class="n">sr3</span><span class="o">.</span><span class="n">spec</span>
</pre></div>
</div>
<p>When doing this on the redhat 8, edit the metpx-sr3.spec and potentially pyproject.toml
to remove the other dependencies because there are no OS packages for: paramiko,
watchdog, xattr, &amp; magic. Eventually, one will have removed enough that the rpm file
will be built.</p>
<p>One can check if the dependencies are there like so:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>[ubuntu@fed39 sr3]$ rpm -qR /home/ubuntu/rpmbuild/RPMS/noarch/metpx-sr3-3.00.47-0.fc39.noarch.rpm

/usr/bin/python3
python(abi) = 3.12
python3-appdirs
python3-humanfriendly
python3-humanize
python3-jsonpickle
python3-paramiko
python3-psutil
python3-xattr
python3.12dist(appdirs)
python3.12dist(humanfriendly)
python3.12dist(humanize)
python3.12dist(jsonpickle)
python3.12dist(paramiko)
python3.12dist(psutil) &gt;= 5.3
python3.12dist(watchdog)
python3.12dist(xattr)
rpmlib(CompressedFileNames) &lt;= 3.0.4-1
rpmlib(FileDigests) &lt;= 4.6.0-1
rpmlib(PartialHardlinkSets) &lt;= 4.0.4-1
rpmlib(PayloadFilesHavePrefix) &lt;= 4.0-1
rpmlib(PayloadIsZstd) &lt;= 5.4.18-1

[ubuntu@fed39 sr3]$
</pre></div>
</div>
<p>You can see all of the prefixed python3 dependencies required, as well as the recommended binary accellerator packages
are listed. Then if you install with dnf install, it will pull them all in.  Unfortunately, this method does not allow
the specification of version of the python dependencies which are stripped out. on Fedora 34, this is not a problem,
as all versions are new enough.  Such a package should install well.</p>
<p>After installation, one can supplement, installing missing dependencies using pip (or pip3.)
Can check how much sr3 is working using <em>sr3 features</em> and use pip to add more features
after the RPM is installed.</p>
</section>
</section>
</section>
<section id="building-a-windows-installer">
<h2>Building a Windows Installer<a class="headerlink" href="#building-a-windows-installer" title="Link to this heading"></a></h2>
<p>One can also build a Windows installer with that
<a class="reference external" href="https://github.com/MetPX/sarracenia/blob/stable/generate-win-installer.sh">script</a>.
It needs to be run from a Linux OS (preferably Ubuntu 18) in the root directory of Sarracenia’s git.
find the python version in use:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">fractal</span><span class="o">%</span> <span class="n">python</span> <span class="o">-</span><span class="n">V</span>
<span class="n">Python</span> <span class="mf">3.10.12</span>
<span class="n">fractal</span><span class="o">%</span>
</pre></div>
</div>
<p>So this is python 3.10.  Only a single minor version will have the embedded package needed
by pynsist to build the executable, so look at:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">www</span><span class="o">.</span><span class="n">python</span><span class="o">.</span><span class="n">org</span><span class="o">/</span><span class="n">downloads</span><span class="o">/</span><span class="n">windows</span><span class="o">/</span>
</pre></div>
</div>
<p>Then go look on python.org, for the “right” version (for 3.10, it is 3.10.11 )
Then, from the shell, run:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sudo</span> <span class="n">apt</span> <span class="n">install</span> <span class="n">nsis</span>
<span class="n">pip3</span> <span class="n">install</span> <span class="n">pynsist</span> <span class="n">wheel</span>
<span class="o">./</span><span class="n">generate</span><span class="o">-</span><span class="n">win</span><span class="o">-</span><span class="n">installer</span><span class="o">.</span><span class="n">sh</span> <span class="mf">3.10.11</span> <span class="mi">2</span><span class="o">&gt;&amp;</span><span class="mi">1</span> <span class="o">&gt;</span> <span class="n">log</span><span class="o">.</span><span class="n">txt</span>
</pre></div>
</div>
<p>The final package will be generated into build/nsis directory.</p>
</section>
<section id="github">
<h2>github<a class="headerlink" href="#github" title="Link to this heading"></a></h2>
<ul class="simple">
<li><p>Click on Releases</p></li>
<li><p>Click on tags, pick the tag for the new release vXX.yy.zzrcw</p></li>
<li><p>Click on Pre-Release tag at the bottom if appropriate.</p></li>
<li><p>Click on Generate Release notes… Review.</p></li>
<li><p>copy/paste of Installation bit at the end from a previous release.</p></li>
<li><p>Save as Draft.</p></li>
<li><p>build packages locally or download from other sources.
drag and drop into the release.</p></li>
<li><p>Publish.</p></li>
</ul>
<p>This will give us the ability to have old versions available.
launchpad.net doesn’t seem to keep old versions around.</p>
</section>
<section id="troubleshooting">
<h2>Troubleshooting<a class="headerlink" href="#troubleshooting" title="Link to this heading"></a></h2>
</section>
<section id="ubuntu-18">
<h2>ubuntu 18<a class="headerlink" href="#ubuntu-18" title="Link to this heading"></a></h2>
<p>trying to upload from ubuntu 18 vm:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>buntu@canny-tick:~/sr3$ twine upload dist/metpx_sr3-3.0.53rc2-py3-none-any.whl
/usr/lib/python3/dist-packages/requests/__init__.py:80: RequestsDependencyWarning: urllib3 (1.26.18) or chardet (3.0.4) doesn&#39;t match a supported version!
  RequestsDependencyWarning)
Uploading distributions to https://upload.pypi.org/legacy/
Uploading metpx_sr3-3.0.53rc2-py3-none-any.whl
100%|██████████████████████████████████████████████████████████████████████████████████████████████████| 408k/408k [00:00&lt;00:00, 120kB/s]
HTTPError: 400 Client Error: &#39;2.0&#39; is not a valid metadata version. See https://packaging.python.org/specifications/core-metadata for more information. for url: https://upload.pypi.org/legacy/
ubuntu@canny-tick:~/sr3$
</pre></div>
</div>
<p>I uploaded from redhat8 instead. used pip3 to install twine on redhat, and that was ok.  This could be a result
of running the system provided python3-twine on ubuntu.</p>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="Documentation.html" class="btn btn-neutral float-left" title="Documentation Standards" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="man_page_template.html" class="btn btn-neutral float-right" title="SR3_TITLE" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2022, Shared Services Canada, Government of Canada, GPLv2.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>